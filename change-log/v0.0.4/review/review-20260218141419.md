# çµ±åˆã‚³ãƒŸãƒƒãƒˆå‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ â€” myT-x é…ä¸‹å…¨å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

> **ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥æ™‚**: 2026-02-18 14:14  
> **å…ƒãƒ¬ãƒ“ãƒ¥ãƒ¼**: review-202602181359 + review-202602181404 + review-202602181407 ã‚’çµ±åˆãƒ»é‡è¤‡æ’é™¤  
> **å¯¾è±¡ã‚³ãƒŸãƒƒãƒˆ**: HEAD (æœªã‚³ãƒŸãƒƒãƒˆå·®åˆ†)  
> **å¤‰æ›´è¦æ¨¡**: 52 ãƒ•ã‚¡ã‚¤ãƒ« / +4,625 è¡Œ / -319 è¡Œ  
> **ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰‹æ³•**: 6 ä¸¦åˆ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ Ã— 2å›ãƒ¬ãƒ“ãƒ¥ãƒ¼ â†’ çµ±åˆç²¾æŸ»

---

## ç›®æ¬¡

1. [ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§](#1-ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§)
2. [æŒ‡æ‘˜ã‚µãƒãƒª](#2-æŒ‡æ‘˜ã‚µãƒãƒª)
3. [Critical â€” å³æ™‚ä¿®æ­£å¿…é ˆ](#3-critical--å³æ™‚ä¿®æ­£å¿…é ˆ)
4. [Important â€” ä¿®æ­£æ¨å¥¨](#4-important--ä¿®æ­£æ¨å¥¨)
5. [Suggestion â€” æ”¹å–„ææ¡ˆ](#5-suggestion--æ”¹å–„ææ¡ˆ)
6. [Positive â€” è‰¯ã„ç‚¹](#6-positive--è‰¯ã„ç‚¹)
7. [ã‚¿ã‚¹ã‚¯ä¸€è¦§ & ä¸¦åˆ—ä½œæ¥­å¯å¦è¡¨](#7-ã‚¿ã‚¹ã‚¯ä¸€è¦§--ä¸¦åˆ—ä½œæ¥­å¯å¦è¡¨)

---

## 1. ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### App Layer (Go) â€” 8ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´æ¦‚è¦ |
|---------|---------|
| `app_events.go` / `_test.go` | ã‚¤ãƒ™ãƒ³ãƒˆåå®šæ•°åŒ–ã€æ–°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç³»ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ  |
| `app_pane_api.go` / `_test.go` | `ApplyLayoutPreset` ã«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦IDè§£æ±ºè¿½åŠ  |
| `app_session_api.go` / `_test.go` | `RenameSession` ãƒªãƒ•ã‚¡ã‚¯ã‚¿ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•åŒ–ï¼‰ |
| `app_snapshot_delta.go` / `_test.go` | `ActiveWindowID` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ  |
| `app_snapshot_metrics.go` / `_test.go` | ãƒ¡ãƒˆãƒªã‚¯ã‚¹collectorå·®åˆ†è¿½åŠ  |
| `app_status.go` / `_test.go` | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹APIæ‹¡å¼µ |
| `app_window_api.go` / `_test.go` | æ–°è¦: Windowæ“ä½œAPIä¸€å¼ |
| `app_worktree_api.go` / `_test.go` | Worktree APIèª¿æ•´ |

### tmux-shim CLI â€” 5ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´æ¦‚è¦ |
|---------|---------|
| `cmd/tmux-shim/command_transform.go` | æ–°ã‚³ãƒãƒ³ãƒ‰å¤‰æ›ãƒ«ãƒ¼ãƒ«è¿½åŠ  |
| `cmd/tmux-shim/model_transform.go` | ãƒ¢ãƒ‡ãƒ«å¤‰æ›é–¢æ•°è¿½åŠ  |
| `cmd/tmux-shim/parse.go` | `set-environment` ãƒ‘ãƒ¼ã‚µè¿½åŠ  |
| `cmd/tmux-shim/spec.go` | 11 ã‚³ãƒãƒ³ãƒ‰specè¿½åŠ  |
| `cmd/tmux-shim/main_test.go` | çµ±åˆãƒ†ã‚¹ãƒˆæ‹¡å¼µ |

### internal/tmux â€” 15ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´æ¦‚è¦ |
|---------|---------|
| `internal/tmux/command_router.go` | æ–°ãƒãƒ³ãƒ‰ãƒ©ç™»éŒ² |
| `internal/tmux/command_router_handlers_pane.go` | kill-pane, resize-pane è¿½åŠ  |
| `internal/tmux/command_router_handlers_session.go` | attach-session, rename-session, set/show-environment è¿½åŠ  |
| `internal/tmux/command_router_handlers_window.go` | æ–°è¦: å…¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ© |
| `internal/tmux/format.go` / `_test.go` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç³»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ•°è¿½åŠ  |
| `internal/tmux/key_table.go` / `_test.go` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ“ä½œã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰è¿½åŠ  |
| `internal/tmux/session_manager.go` / `_test.go` | `Snapshot()` ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¯ãƒ­ãƒ¼ãƒ³åŒ– |
| `internal/tmux/session_manager_pane_io.go` | `ListPanesByWindowTarget` è¿½åŠ  |
| `internal/tmux/session_manager_pane_lifecycle.go` | kill-pane ãƒ­ã‚¸ãƒƒã‚¯ |
| `internal/tmux/session_manager_targets.go` / `_test.go` | `ResolveTarget` RLockâ†’LockåŒ– |
| `internal/tmux/session_manager_window.go` / `_test.go` | æ–°è¦: Window CRUDæ“ä½œ |

### Frontend (React/TypeScript) â€” 13ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´æ¦‚è¦ |
|---------|---------|
| `frontend/src/App.tsx` | ConfirmDialogè¿½åŠ  |
| `frontend/src/api.ts` | Windowç³»APIé–¢æ•°ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| `frontend/src/components/SessionView.tsx` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ãƒ–ãƒãƒ¼UIå…¨é¢è¿½åŠ  |
| `frontend/src/components/TerminalPane.tsx` | å¾®èª¿æ•´ |
| `frontend/src/components/SearchBar.tsx` | æ¤œç´¢ãƒãƒ¼è¿½åŠ  |
| `frontend/src/hooks/useBackendSync.ts` | ã‚¤ãƒ™ãƒ³ãƒˆã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ”¹å–„ |
| `frontend/src/hooks/usePrefixKeyMode.ts` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ“ä½œã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰è¿½åŠ  |
| `frontend/src/store/tmuxStore.ts` | `activeWindowId` ã‚¹ãƒˆã‚¢è¿½åŠ  |
| `frontend/src/styles/layout.css` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ãƒ–ãƒãƒ¼CSSè¿½åŠ  |
| `frontend/src/types/tmux.ts` | Windowå‹è¿½åŠ  |
| `frontend/wailsjs/...` | è‡ªå‹•ç”Ÿæˆãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ›´æ–° |

---

## 2. æŒ‡æ‘˜ã‚µãƒãƒª

| é‡è¦åº¦ | ä»¶æ•° | èª¬æ˜ |
|--------|------|------|
| ğŸ”´ Critical | 10 | å³æ™‚ä¿®æ­£å¿…é ˆï¼ˆå‹•ä½œä¸è‰¯ãƒ»ä»•æ§˜é•åãƒ»ãƒ‡ãƒ¼ã‚¿ç ´å£Šï¼‰ |
| ğŸŸ  Important | 42 | ä¿®æ­£æ¨å¥¨ï¼ˆæ½œåœ¨ãƒã‚°ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ä¸€è²«æ€§ï¼‰ |
| ğŸŸ¢ Suggestion | 57 | æ”¹å–„ææ¡ˆï¼ˆå¯èª­æ€§ãƒ»ä¿å®ˆæ€§ãƒ»ãƒ†ã‚¹ãƒˆï¼‰ |
| ğŸ”µ Positive | 26 | å„ªã‚ŒãŸå®Ÿè£…ãƒ»è¨­è¨ˆåˆ¤æ–­ |

---

## 3. Critical â€” å³æ™‚ä¿®æ­£å¿…é ˆ

### C-1: `models.ts` â€” `?? []` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‰Šé™¤ã«ã‚ˆã‚‹ TypeError ãƒªã‚¹ã‚¯

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/types/models.ts` : 60â€“74è¡Œä»˜è¿‘ |
| **å•é¡Œ** | `WorktreeConfig` ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã® `setup_scripts` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‹ã‚‰ `?? []` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‰Šé™¤ã€‚Go ã® nil slice â†’ JSON `null` ã®å ´åˆã€å¾Œç¶šã® `.map()` / `.forEach()` ã§ **TypeError** ãŒç™ºç”Ÿã™ã‚‹ |
| **ä¿®æ­£æ–¹é‡** | `this.setup_scripts = source["setup_scripts"] ?? [];` ã«æˆ»ã™ |

### C-2: `useBackendSync.ts` â€” UTF-8 BOM æ··å…¥ï¼ˆä»•æ§˜é•åï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/hooks/useBackendSync.ts` : ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ |
| **å•é¡Œ** | ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ã« UTF-8 BOM (`EF BB BF`) ãŒæ··å…¥ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»•æ§˜ã§ã¯ **å…¨ãƒ•ã‚¡ã‚¤ãƒ« UTF-8 BOMç„¡ã—** ãŒå¿…é ˆ |
| **ä¿®æ­£æ–¹é‡** | BOM ã‚’é™¤å»ã—ã¦ UTF-8 (BOMç„¡ã—) ã§å†ä¿å­˜ |

### C-3: `SessionView.tsx` â€” `commitWindowRename` stale closure ã«ã‚ˆã‚‹äºŒé‡å®Ÿè¡Œ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/SessionView.tsx` |
| **å•é¡Œ** | `commitWindowRename` ãŒ `useCallback` ã§å®šç¾©ã€‚Enter â†’ onBlur é€£ç¶šç™ºç«ã§ `renamingWindowId` ãŒ stale ã«ãªã‚Šã€`RenameWindow` API ãŒäºŒé‡å®Ÿè¡Œã•ã‚Œã‚‹ |
| **ä¿®æ­£æ–¹é‡** | `commitWindowRename` å†…éƒ¨ã§æ—©æœŸã« `setRenamingWindowId(null)` + null ã‚¬ãƒ¼ãƒ‰ã€‚ã¾ãŸã¯ `useRef` ã§ã‚¤ãƒ³ãƒ•ãƒ©ã‚¤ãƒˆãƒ•ãƒ©ã‚°ã‚’ç®¡ç† |

### C-4: `SessionView.tsx` â€” `registerRenameInput` æ¯ãƒ¬ãƒ³ãƒ€ãƒ¼å†ã‚¢ã‚¿ãƒƒãƒ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/SessionView.tsx` |
| **å•é¡Œ** | `renamingWindowId` å¤‰æ›´ã®ãŸã³ã«å…¨ã‚¿ãƒ–ã® ref ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå†ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã€‚ã‚¿ãƒ–æ•°ãŒå¤šã„å ´åˆã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å½±éŸ¿ |
| **ä¿®æ­£æ–¹é‡** | `RenameInput` ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ‡ã‚Šå‡ºã—ã€`autoFocus` prop ã‚’ä½¿ç”¨ |

### C-5: `append(req.Args, ...)` â€” ã‚¹ãƒ©ã‚¤ã‚¹èƒŒé¢é…åˆ—æ±šæŸ“ï¼ˆ2ç®‡æ‰€ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_session.go` L70ä»˜è¿‘, `command_router_handlers_window.go` L190ä»˜è¿‘ |
| **å•é¡Œ** | `handleNewSession` ã¨ `handleNewWindow` ã§ `req.Args` ã® backing array ã«ä½™å‰°å®¹é‡ãŒã‚ã‚‹å ´åˆã€`append` ãŒå…ƒã®é…åˆ—ã‚’ä¸Šæ›¸ãã™ã‚‹ã€‚`splitWindowResolved` ã§ã¯é˜²å¾¡çš„ã‚³ãƒ”ãƒ¼ãŒæ­£ã—ãå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŒã€ã“ã®2ç®‡æ‰€ã§ã¯æœªå¯¾å¿œ |
| **ä¿®æ­£æ–¹é‡** | `argsWithEnter := make([]string, len(req.Args)+1); copy(argsWithEnter, req.Args); argsWithEnter[len(req.Args)] = "Enter"` |

### C-6: `EventsOff(paneEvent)` â€” å…¨ãƒªã‚¹ãƒŠãƒ¼è§£é™¤ãƒªã‚¹ã‚¯

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/TerminalPane.tsx` L315ä»˜è¿‘ |
| **å•é¡Œ** | Wails ã® `EventsOff(eventName)` ã¯ãã®ã‚¤ãƒ™ãƒ³ãƒˆåã«ç™»éŒ²ã•ã‚ŒãŸ**ã™ã¹ã¦ã®ãƒªã‚¹ãƒŠãƒ¼**ã‚’è§£é™¤ã™ã‚‹ã€‚`useBackendSync.ts` ã§ã¯ `EventsOn` ã®æˆ»ã‚Šå€¤ï¼ˆcancelé–¢æ•°ï¼‰ã‚’ä¿å­˜ã—ã¦å€‹åˆ¥ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦ã„ã‚‹ãŒã€TerminalPane ã§ã¯æ—§ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã¾ã¾ |
| **ä¿®æ­£æ–¹é‡** | `EventsOn` ã®æˆ»ã‚Šå€¤ã‚’ä¿å­˜ã—ã€cleanup æ™‚ã«ãã‚Œã‚’å‘¼ã¶æ–¹å¼ã«çµ±ä¸€ |

### C-7: `format_test.go` â€” ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒæ¥µã‚ã¦ä¸è¶³

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/format_test.go` å…¨ä½“ï¼ˆç´„65è¡Œï¼‰ |
| **å•é¡Œ** | ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå±•é–‹ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¡¨ç¤ºã«ç›´çµï¼‰ã«å¯¾ã—ã€ãƒ†ã‚¹ãƒˆãŒ1ã‚±ãƒ¼ã‚¹ã®ã¿ã€‚æœªãƒ†ã‚¹ãƒˆ: `#{unknown_var}`, `session_name`, `window_id`, `window_name`, `pane_active`, è¤‡æ•° `#{}` ã‚’å«ã‚€æ–‡å­—åˆ—, ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—, ç©ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ |
| **ä¿®æ­£æ–¹é‡** | ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã§å…¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ•°ãƒ»ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚’ç¶²ç¾… |

### C-8: `app_events_test.go` â€” ã‚¿ã‚¤ãƒŸãƒ³ã‚°ä¾å­˜ãƒ†ã‚¹ãƒˆï¼ˆCI flaky riskï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_events_test.go` `waitForCondition` ãƒ˜ãƒ«ãƒ‘ãƒ¼ |
| **å•é¡Œ** | 10msãƒãƒ¼ãƒªãƒ³ã‚°Ã—50å›ï¼ˆæœ€å¤§500msï¼‰ã§æ¡ä»¶å¾…ã¡ã€‚CIç’°å¢ƒã‚„é«˜è² è·æ™‚ã«flaky failureã®åŸå› ã«ãªã‚‹ |
| **ä¿®æ­£æ–¹é‡** | `chan struct{}` ã‚„ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå»¶é•·ï¼ˆ2ç§’ä»¥ä¸Šï¼‰ã§å®‰å®šåŒ– |

### C-9: `ResolveTarget` å†…éƒ¨ãƒã‚¤ãƒ³ã‚¿ã® TOCTOU â€” `handleSendKeys` nil deref ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/session_manager_targets.go`, `command_router_handlers_pane.go` |
| **å•é¡Œ** | `ResolveTarget` ã¯ãƒ­ãƒƒã‚¯å†…ã§ `*TmuxPane` ã®å†…éƒ¨ãƒã‚¤ãƒ³ã‚¿ã‚’ç›´æ¥è¿”ã™ã€‚ãƒ­ãƒƒã‚¯è§£æ”¾å¾Œã‚‚ãƒãƒ³ãƒ‰ãƒ©å†…ã§ä½¿ç”¨ã•ã‚Œç¶šã‘ã‚‹ï¼ˆ`target.ID`, `target.Terminal` ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ç­‰ï¼‰ã€‚`handleSendKeys` ã§ `target.Terminal.Write()` ã‚’å‘¼ã¶éš›ã€åˆ¥ã‚´ãƒ«ãƒ¼ãƒãƒ³ãŒ `KillPane` ã§ Terminal ã‚’ `nil` ã«è¨­å®šã™ã‚‹ã¨ **nil pointer dereference** ã§ panicã€‚`Terminal == nil` ãƒã‚§ãƒƒã‚¯ã¯ã‚ã‚‹ãŒã€ãƒã‚§ãƒƒã‚¯ã¨ Write ã®é–“ã«å‰²ã‚Šè¾¼ã¾ã‚Œã‚‹ TOCTOU å•é¡Œ |
| **å½±éŸ¿** | panic ã«ã‚ˆã‚‹ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆä½ç¢ºç‡ã ãŒé«˜å½±éŸ¿ï¼‰ |
| **ä¿®æ­£æ–¹é‡** | (a) ãƒ­ãƒƒã‚¯å†…ã§ Terminal å‚ç…§ã‚’å–å¾—ã—å³åº§ã«ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã§ä¿æŒã€(b) å€¤ã‚³ãƒ”ãƒ¼ã‚’è¿”ã™ã€(c) ãƒ­ãƒƒã‚¯ä¿æŒã—ãŸã¾ã¾ Write ã‚’å®Ÿè¡Œã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¿½åŠ  |
| **é–¢é€£** | I-4 (`ListPanesByWindowTarget` ãƒã‚¤ãƒ³ã‚¿ãƒªãƒ¼ã‚¯) ã¨åŒæ ¹å•é¡Œã€‚è¨­è¨ˆæ–¹é‡ã‚’çµ±ä¸€ã™ã¹ã |

### C-10: `searchAddonRef.current` null åŒ–ã«ã‚ˆã‚‹ãƒšã‚¤ãƒ³å†ãƒã‚¦ãƒ³ãƒˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/TerminalPane.tsx` |
| **å•é¡Œ** | `SearchBar` ã« `searchAddon={searchAddonRef.current}` ã‚’æ¸¡ã™ãŒã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ç‚¹ã® ref å€¤ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã€‚useEffect ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã§ `searchAddonRef.current = null`ã€‚ãƒšã‚¤ãƒ³å†ãƒã‚¦ãƒ³ãƒˆæ™‚ã« **disposed ãª addon ã¸ã®æ“ä½œ**ã§ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿã®å¯èƒ½æ€§ |
| **å½±éŸ¿** | æ¤œç´¢ä¸­ã®ãƒšã‚¤ãƒ³å†ãƒã‚¦ãƒ³ãƒˆã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ |
| **ä¿®æ­£æ–¹é‡** | (a) `SearchBar` å†…ã§ addon null ãƒã‚§ãƒƒã‚¯è¿½åŠ ã€(b) addon ã‚’ state ã§ç®¡ç†ã—å†ãƒã‚¦ãƒ³ãƒˆæ™‚ã«å†ç”Ÿæˆ |

---

## 4. Important â€” ä¿®æ­£æ¨å¥¨

### I-1: `ApplyLayoutPreset` ã® activeWindowID ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä¸å‚™

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_pane_api.go` : 195â€“219è¡Œä»˜è¿‘ |
| **å•é¡Œ** | `windowID < 0` ã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ã¦ã„ã‚‹ãŒã€æ­£ã®å€¤ã§ã‚‚å‰Šé™¤æ¸ˆã¿ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’æŒ‡ã™ã‚±ãƒ¼ã‚¹ãŒæœªå‡¦ç†ã€‚`resolveActiveWindowSnapshot` ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥ãŒä¸ä¸€è‡´ |
| **ä¿®æ­£æ–¹é‡** | å…±é€šãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«çµ±åˆ |

### I-2: `ApplyLayoutPreset` TOCTOU

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_pane_api.go` : 195â€“219è¡Œä»˜è¿‘ |
| **å•é¡Œ** | `GetSession()` ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‹ã‚‰å–å¾—ã—ãŸ `windowID` ã§å¾Œç¶š API ã‚’å‘¼ã¶ã¾ã§ã®é–“ã«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤ã®å¯èƒ½æ€§ |
| **ä¿®æ­£æ–¹é‡** | `ApplyLayoutPresetByWindowID` å†…éƒ¨ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å­˜åœ¨ãƒã‚§ãƒƒã‚¯ + ä¸åœ¨æ™‚ã‚¨ãƒ©ãƒ¼è¿”å´ |

### I-3: `ResolveTarget` RLockâ†’Lock å¤‰æ›´ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ‡¸å¿µ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/session_manager_targets.go` |
| **å•é¡Œ** | auto-repair å¯¾å¿œã§ `RLock` â†’ `Lock`ï¼ˆæ’ä»–ãƒ­ãƒƒã‚¯ï¼‰å¤‰æ›´ã€‚`send-keys` ç­‰ã®é«˜é »åº¦ã‚³ãƒãƒ³ãƒ‰ãŒæ’ä»–ãƒ­ãƒƒã‚¯å–å¾—ã¨ãªã‚Šã€ä¸¦è¡Œæ€§ãƒœãƒˆãƒ«ãƒãƒƒã‚¯åŒ–ã®ãƒªã‚¹ã‚¯ |
| **ä¿®æ­£æ–¹é‡** | (a) RLock â†’ ä¿®å¾©å¿…è¦æ™‚ã®ã¿ Lock æ˜‡æ ¼ï¼ˆdouble-check lockingï¼‰ã€ã¾ãŸã¯ (b) auto-repair ã‚’åˆ¥ã‚´ãƒ«ãƒ¼ãƒãƒ³ã«å§”è­² |

### I-4: `ListPanesByWindowTarget` å†…éƒ¨ãƒã‚¤ãƒ³ã‚¿ãƒªãƒ¼ã‚¯

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/session_manager_pane_io.go` / `command_router_handlers_pane.go` |
| **å•é¡Œ** | `[]*TmuxPane` ã®ãƒã‚¤ãƒ³ã‚¿ã‚’ Lock è§£æ”¾å¾Œã«è¿”å´ã€‚å‘¼ã³å‡ºã—å…ƒï¼ˆ`handleListPanes` ç­‰ï¼‰ãŒ Lock å¤–ã§ãƒã‚¤ãƒ³ã‚¿çµŒç”±ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’èª­ã¿æ›¸ãã™ã‚‹ã¨ **data race**ã€‚`Snapshot()` ã®ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¯ãƒ­ãƒ¼ãƒ³æ–¹é‡ã¨ä¸ä¸€è‡´ |
| **ä¿®æ­£æ–¹é‡** | å€¤ã‚³ãƒ”ãƒ¼ `[]TmuxPane` ã‚’è¿”ã™ã‹ã€ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’è¿”ã™ |

### I-5: `set-environment` ç©ºæ–‡å­—åˆ— VALUE éå¯¾å¿œ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/parse.go` |
| **å•é¡Œ** | `set-environment NAME VALUE` ã§ VALUE ãŒç©ºæ–‡å­—åˆ— (`""`) ã®å ´åˆã«æ­£ã—ãè¨­å®šã§ããªã„ã€‚å®Ÿ tmux ã§ã¯ `set-environment FOO ""` ãŒæœ‰åŠ¹ |
| **ä¿®æ­£æ–¹é‡** | ãƒ‘ãƒ¼ã‚µã«ã‚¯ã‚©ãƒ¼ãƒˆæ–‡å­—åˆ—ã®ãƒ‘ãƒ¼ã‚¹å¯¾å¿œã‚’è¿½åŠ  |

### I-6: `new-window` ã® shell / model transform ãƒ†ã‚¹ãƒˆæ¬ è½

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/main_test.go` |
| **å•é¡Œ** | `new-window` ã‚³ãƒãƒ³ãƒ‰ã® shell transform / model transform ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒå­˜åœ¨ã—ãªã„ã€‚ä»–ã‚³ãƒãƒ³ãƒ‰ï¼ˆ`split-window`, `send-keys` ç­‰ï¼‰ã«ã¯ãƒ†ã‚¹ãƒˆã‚ã‚Š |
| **ä¿®æ­£æ–¹é‡** | `new-window -n mywin` ç­‰ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã€‚E2E ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆã‚‚å«ã‚ã‚‹ |

### I-7: `resize-pane` spec ã®ä¸å‚™ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆä¸è¶³ + æ–¹å‘ãƒ•ãƒ©ã‚°æœªå®šç¾©ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/spec.go` |
| **å•é¡Œ** | (a) `-t` ãŒä¸è¦ã ãŒã‚³ãƒ¡ãƒ³ãƒˆèª¬æ˜ãŒç„¡ã„ã€‚(b) tmux ã® `resize-pane -U/-D/-L/-R` æ–¹å‘ãƒ•ãƒ©ã‚°ãŒæœªå®šç¾© |
| **ä¿®æ­£æ–¹é‡** | (a) ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã€(b) æ–¹å‘ãƒ•ãƒ©ã‚°ã‚’å¿…è¦æ™‚ã«è¿½åŠ  |

### I-8: `usePrefixKeyMode.ts` â€” `resolveActiveWindow` äºŒé‡å‘¼ã³å‡ºã—

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/hooks/usePrefixKeyMode.ts` |
| **å•é¡Œ** | åŒä¸€ãƒãƒ³ãƒ‰ãƒ©å†…ã§ `resolveActiveWindow` ãŒ2å›å‘¼ã°ã‚Œã¦ã„ã‚‹ |
| **ä¿®æ­£æ–¹é‡** | å¤‰æ•°ã«çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦å†åˆ©ç”¨ |

### I-9: `SessionView.tsx` â€” hooks å®£è¨€é †åºã®éæ¨™æº–

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/SessionView.tsx` |
| **å•é¡Œ** | `useState` â†’ `useCallback` â†’ `useState` ã¨ hooks å®£è¨€ãŒæ··åœ¨ |
| **ä¿®æ­£æ–¹é‡** | hooks ã‚’ç¨®é¡ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ï¼ˆuseStateç¾¤ â†’ useRefç¾¤ â†’ useCallbackç¾¤ â†’ useEffectç¾¤ï¼‰ |

### I-10: `ConfirmDialog` â€” ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼ˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒˆãƒ©ãƒƒãƒ—æœªå®Ÿè£…ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/App.tsx` (ConfirmDialog éƒ¨åˆ†) |
| **å•é¡Œ** | ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºæ™‚ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç§»å‹•ãªã—ã€‚Tab ã‚­ãƒ¼ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒç§»å‹•å¯èƒ½ |
| **ä¿®æ­£æ–¹é‡** | `autoFocus` ã‚’ Confirm/Cancel ãƒœã‚¿ãƒ³ã«è¨­å®šã€‚å¿…è¦ã«å¿œã˜ã¦ `focus-trap` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå°å…¥ |

### I-11: `activeWindowInSessionLocked` â€” Locked ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹å‘½åè¦ç´„

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/session_manager_window.go` / `format.go` |
| **å•é¡Œ** | `activeWindowInSessionLocked`ï¼ˆãƒ­ãƒƒã‚¯æ‰€æœ‰å‰æï¼‰ã¨ `activeWindowInSession`ï¼ˆãƒ­ãƒƒã‚¯ä¸è¦ç‰ˆï¼‰ãŒå…±å­˜ã€‚`format.go` ã§ã¯ç”Ÿãƒã‚¤ãƒ³ã‚¿çµŒç”±ã§ session ãŒæ¸¡ã•ã‚Œã‚‹ãŸã‚ã€ãƒ­ãƒƒã‚¯æˆ¦ç•¥ãŒä¸æ˜ç­ |
| **ä¿®æ­£æ–¹é‡** | å‘½åè¦ç´„ã‚’æ˜ç¢ºåŒ–ï¼ˆ`Locked` ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ä»˜ä¸ãƒ«ãƒ¼ãƒ«ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ï¼‰ã€ã¾ãŸã¯ãƒ­ãƒƒã‚¯ä¸è¦ç‰ˆã‚’éã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆåŒ– |

### I-12: `resolveWindowFromRequest` vs `resolveWindowIDFromRequest` â€” æˆ»ã‚Šå€¤åã®æ··åŒãƒªã‚¹ã‚¯

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_window.go` |
| **å•é¡Œ** | å‰è€…ã¯ `*TmuxWindow` ã‚’è¿”ã—ã€å¾Œè€…ã¯ `int` ã‚’è¿”ã™ã€‚åˆ©ç”¨ç®‡æ‰€ã§æ··åœ¨ã™ã‚‹ã¨å¤‰æ•°åå‰²ã‚Šå½“ã¦ãƒŸã‚¹ãŒèµ·ãã‚„ã™ã„ |
| **ä¿®æ­£æ–¹é‡** | ã‚³ãƒ¡ãƒ³ãƒˆã§æˆ»ã‚Šå€¤ã®é•ã„ã‚’æ˜è¨˜ |

### I-13: `#{window_index}` ãŒ stable ID ã‚’è¿”ã™ï¼ˆtmuxäº’æ›æ€§ä¹–é›¢ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/format.go` L111â€“L119 |
| **å•é¡Œ** | æœ¬å®¶tmuxã§ã¯0ãƒ™ãƒ¼ã‚¹ã®é †åºä½ç½®ã‚’è¿”ã™ãŒã€å½“å®Ÿè£…ã§ã¯stable IDã‚’è¿”ã™ã€‚`display-message` ã®çµæœã‚’ `list-panes -t session:N` ã«ä½¿ã†ã¨æ„å›³ã—ãªã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’å‚ç…§ã™ã‚‹å¯èƒ½æ€§ |
| **ä¿®æ­£æ–¹é‡** | (a) æ„å›³çš„è¨­è¨ˆãªã‚‰ã‚³ãƒ¡ãƒ³ãƒˆã§äº’æ›æ€§ã®ãšã‚Œã‚’æ˜è¨˜ã€(b) äº’æ›æ€§ãŒå¿…è¦ãªã‚‰ 0-based ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿”ã™ã‚ˆã†å¤‰æ›´ |

### I-14: ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒªã‚·ãƒ¼ã®ä¸€å…ƒç®¡ç†ä¸è¶³

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_events.go` L84â€“L108 |
| **å•é¡Œ** | `shouldEmitSnapshotForEvent` / `shouldBypassSnapshotDebounceForEvent` ãŒ2ã¤ã®ç‹¬ç«‹ switch æ–‡ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã€‚æ–°ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ æ™‚ã«ç‰‡æ–¹ã ã‘æ›´æ–°ã™ã‚‹æ¼ã‚Œãƒªã‚¹ã‚¯ãŒé«˜ã„ |
| **ä¿®æ­£æ–¹é‡** | ã‚¤ãƒ™ãƒ³ãƒˆâ†’å‹•ä½œã‚’ãƒãƒƒãƒ—åŒ–ã—ä¸€å…ƒç®¡ç†ï¼ˆæ§‹é€ ä½“ã§ trigger / bypass ã‚’å®šç¾©ï¼‰ |

### I-15: `removeWindowAtIndexLocked` ã§ Terminal ã‚’ nil ã«ã—ã¦ã„ãªã„

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/session_manager_pane_lifecycle.go` |
| **å•é¡Œ** | `killPaneLocked` ã¯ `pane.Terminal = nil` ã‚’ãƒ­ãƒƒã‚¯å†…ã§å®Ÿè¡Œã—ã¦ã‹ã‚‰ Close ã™ã‚‹ãŒã€`removeWindowAtIndexLocked` ã¯ `delete(m.panes, pane.ID)` ã®ã¿ã§ Terminal æœª nil åŒ– |
| **ä¿®æ­£æ–¹é‡** | `pane.Terminal = nil` ã‚’å®Ÿè¡Œã—ã€é€€é¿ã—ãŸ Terminal ã‚’å‘¼ã³å‡ºã—å…ƒã«è¿”ã™ãƒ‘ã‚¿ãƒ¼ãƒ³ã«çµ±ä¸€ |

### I-16: `handleNewSession` ã§ `-d` æŒ‡å®šæ™‚ã«ã‚¤ãƒ™ãƒ³ãƒˆæœªç™ºè¡Œ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_session.go` L84â€“L95 |
| **å•é¡Œ** | `-d`ï¼ˆdetachï¼‰ãƒ•ãƒ©ã‚°æ™‚ã€`tmux:session-created` ã‚¤ãƒ™ãƒ³ãƒˆãŒä¸€åˆ‡ç™ºè¡Œã•ã‚Œãªã„ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³è‡ªä½“ã¯ä½œæˆæ¸ˆã¿ã ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã®çŠ¶æ…‹ãŒéåŒæœŸã« |
| **ä¿®æ­£æ–¹é‡** | ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œã‚’ `-d` æ¡ä»¶å¤–ã«ç§»å‹• |

### I-17: `resolveDirectionalPane` ã® TOCTOU

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_pane.go` |
| **å•é¡Œ** | 3å›ç‹¬ç«‹ã«ãƒ­ãƒƒã‚¯ã‚’å–å¾—ã™ã‚‹ãŸã‚ã€å„ãƒ­ãƒƒã‚¯é–“ã§ãƒšã‚¤ãƒ³æ§‹é€ ãŒå¤‰åŒ–ã™ã‚‹å¯èƒ½æ€§ |
| **ä¿®æ­£æ–¹é‡** | `SessionManager` ã«å˜ä¸€ãƒ­ãƒƒã‚¯å†…ã§æ–¹å‘è§£æ±ºã‚’å®Œçµã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ  |

### I-18: `snapshotDeltaMu` â†’ `snapshotMu` ã®å…¥ã‚Œå­ãƒ­ãƒƒã‚¯é †åºãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸å‚™

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_snapshot_delta.go` L139â€“L170, `app.go` |
| **å•é¡Œ** | `snapshotDeltaMu` ä¿æŒä¸­ã« `snapshotMu` ã‚’å–å¾—ã€‚`app.go` ã®ãƒ­ãƒƒã‚¯é †åºã‚³ãƒ¡ãƒ³ãƒˆï¼ˆIndependent locksï¼‰ã«çŸ›ç›¾ã€‚ç¾æ™‚ç‚¹ã§ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ãƒªã‚¹ã‚¯ã¯ãªã„ãŒä¿å®ˆãƒªã‚¹ã‚¯ |
| **ä¿®æ­£æ–¹é‡** | `app.go` ã®ãƒ­ãƒƒã‚¯é †åºã‚³ãƒ¡ãƒ³ãƒˆã« `snapshotDeltaMu â†’ snapshotMu` ã®ãƒã‚¹ãƒˆé–¢ä¿‚ã‚’è¿½è¨˜ |

### I-19: `RenameSession` ã®ã‚¤ãƒ™ãƒ³ãƒˆè¨­è¨ˆæ•´åˆæ€§

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_session_api.go` L127â€“L132 |
| **å•é¡Œ** | `tmux:session-renamed` ã‚¤ãƒ™ãƒ³ãƒˆã‚’ `emitBackendEvent` ã§ç™ºè¡Œã™ã‚‹ãŒã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã§ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æœ‰ç„¡ãŒä¸æ˜ç¢º |
| **ä¿®æ­£æ–¹é‡** | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­ã‚’ç¢ºèªã€ã¾ãŸã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ã€ŒSnapshot deltaã§æ¤œçŸ¥ã™ã‚‹è¨­è¨ˆã€ã¨æ˜è¨˜ |

### I-20: ã€Œsend-keys bootstrapã€+ ã€Œç’°å¢ƒå¤‰æ•°ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®3é‡é‡è¤‡

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `command_router_handlers_session.go`, `command_router_handlers_pane.go`, `command_router_handlers_window.go` |
| **å•é¡Œ** | (a) Terminal nilãƒã‚§ãƒƒã‚¯ â†’ TranslateSendKeys â†’ Write ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒ3ç®‡æ‰€ã«é‡è¤‡ã€‚(b) `copyEnvMap` â†’ `mergePaneEnvDefaults` â†’ `addTmuxEnvironment` ã®3é€£å‘¼ã‚‚3ç®‡æ‰€ã§åå¾©ã€‚ä¿®æ­£æ™‚ã«å…¨ç®‡æ‰€ã®æ›´æ–°ãŒå¿…è¦ |
| **ä¿®æ­£æ–¹é‡** | `CommandRouter` ã«ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ `bestEffortSendKeys` ã¨ `buildPaneEnv` ã‚’æŠ½å‡ºã€‚ã“ã‚Œã«ã‚ˆã‚Š `handleNewSession` (~90è¡Œ) ã¨ `splitWindowResolved` (~120è¡Œ) ã‚‚è‡ªç„¶ã«çŸ­ç¸®ã•ã‚Œã‚‹ |

### I-21: `app_pane_api.go` ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_pane_api.go` |
| **å•é¡Œ** | 10å€‹ã®å…¬é–‹ãƒ¡ã‚½ãƒƒãƒ‰ã™ã¹ã¦ã«åŒä¸€ã® paneID TrimSpace + requireSessions ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ4-7è¡Œï¼‰ãŒå­˜åœ¨ |
| **ä¿®æ­£æ–¹é‡** | `requireSessionsWithPaneID` ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«æŠ½å‡º |

### I-22: `SessionView.tsx` ãŒ ~280è¡Œã§å¤§ãã™ãã‚‹

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/SessionView.tsx` |
| **å•é¡Œ** | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªãƒãƒ¼ãƒ ç®¡ç†ï¼ˆ3ref + 2state + 3useEffectï¼‰ãŒæœ¬ä½“ã¨æ··åœ¨ã— SRP é•å |
| **ä¿®æ­£æ–¹é‡** | `useWindowRename` ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«æŠ½å‡º |

### I-23: `useBackendSync` ã®åˆæœŸåŒ–ç«¶åˆ

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/hooks/useBackendSync.ts` L97â€“L115 |
| **å•é¡Œ** | `ListSessions` ã¨ `GetActiveSession` ã®2ã¤ã®éåŒæœŸå‘¼ã³å‡ºã—ãŒ `setActiveSession` ã‚’ä¸Šæ›¸ãã—åˆã†å¯èƒ½æ€§ |
| **ä¿®æ­£æ–¹é‡** | `Promise.all` ã§åŒæ™‚å–å¾—ã—1ç®‡æ‰€ã§æ±ºå®š |

### I-24: TerminalPane ã®å·¨å¤§ useEffectï¼ˆ~230è¡Œï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/TerminalPane.tsx` L93â€“L321 |
| **å•é¡Œ** | TerminalåˆæœŸåŒ–ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ãƒ»ãƒªã‚µã‚¤ã‚ºãƒ»ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ãªã©ãŒå…¨ã¦1ã¤ã®useEffectã«é›†ç´„ |
| **ä¿®æ­£æ–¹é‡** | ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯åˆ†é›¢ã‚’æ¤œè¨ï¼ˆC-6 ã¨åŒæ™‚å¯¾å¿œãŒåŠ¹ç‡çš„ï¼‰ |

### I-25: `applyModelOverride` ã§ `--model=`ï¼ˆç©ºå€¤ï¼‰ã®ã‚¬ãƒ¼ãƒ‰ä¸è¶³

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/model_transform.go` L153â€“L175 |
| **å•é¡Œ** | `splitModelEqualsArg` ãƒ‘ã‚¹ã§ `--model=`ï¼ˆã‚¤ã‚³ãƒ¼ãƒ«å¾ŒãŒç©ºï¼‰ã®å ´åˆã«ç©ºãƒã‚§ãƒƒã‚¯ãªã—ã€‚ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ãƒ‘ã‚¹ã«ã¯ã‚¬ãƒ¼ãƒ‰ãŒã‚ã‚‹ |
| **ä¿®æ­£æ–¹é‡** | `splitModelEqualsArg` ãƒ‘ã‚¹ã«ã‚‚ç©ºå€¤ã‚¬ãƒ¼ãƒ‰ã‚’è¿½åŠ  |

### I-26: `handleNewWindow` ã§ attach å‰ã® pane ãƒã‚¤ãƒ³ã‚¿ Terminal nil ãƒªã‚¹ã‚¯ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_window.go` L150â€“170ä»˜è¿‘ |
| **å•é¡Œ** | `pane.Terminal == nil` ãƒã‚§ãƒƒã‚¯ã¯å…¥ã£ã¦ã„ã‚‹ãŒã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°æ¬¡ç¬¬ã§åˆ¥ã‚´ãƒ«ãƒ¼ãƒãƒ³ãŒ Terminal ã‚’ nil åŒ–ã™ã‚‹å¯èƒ½æ€§ã€‚C-9 ã¨åŒæ§˜ã® TOCTOU ãƒ‘ã‚¿ãƒ¼ãƒ³ |
| **ä¿®æ­£æ–¹é‡** | C-9 ã®è¨­è¨ˆæ–¹é‡ã¨çµ±ä¸€ã€‚Terminal å‚ç…§ã‚’ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã«é€€é¿ |

### I-27: `WriteToPanesInWindow` ã§2ç•ªç›®ä»¥é™ã®ãƒšã‚¤ãƒ³ã® Write ã‚¨ãƒ©ãƒ¼ãŒã‚µã‚¤ãƒ¬ãƒ³ãƒˆæ¶ˆå¤±ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/session_manager_pane_io.go` |
| **å•é¡Œ** | `firstErr` ã®ã¿è¿”å´ã—ã€2ç•ªç›®ä»¥é™ã®ãƒšã‚¤ãƒ³ã¸ã®æ›¸ãè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒã‚µã‚¤ãƒ¬ãƒ³ãƒˆã«æ¶ˆå¤±ã€‚ãƒ‡ãƒãƒƒã‚°å›°é›£ |
| **ä¿®æ­£æ–¹é‡** | `slog.Warn` ã§å¾Œç¶šã‚¨ãƒ©ãƒ¼ã‚’è¨˜éŒ² |

### I-28: `emitLayoutChangedForSession` ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå–å¾—å¤±æ•—ãŒ Debug ãƒ¬ãƒ™ãƒ«ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_pane.go` |
| **å•é¡Œ** | ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¤ãƒ™ãƒ³ãƒˆæ¬ è½ã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¡¨ç¤ºä¸æ•´åˆã‚’å¼•ãèµ·ã“ã™ãŸã‚ã€`slog.Warn` ãŒé©åˆ‡ |
| **ä¿®æ­£æ–¹é‡** | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’ `Debug` â†’ `Warn` ã«å¤‰æ›´ |

### I-29: shim `applyModelTransform` ãŒ config.Load() å¤±æ•—æ™‚ã«ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™ï¼ˆshimä»•æ§˜é•åï¼‰ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/model_transform.go` |
| **å•é¡Œ** | shim ä»•æ§˜ï¼ˆå¤‰æ›å¤±æ•—æ™‚ã¯åŸæ–‡ã‚’ãã®ã¾ã¾è»¢é€ã€ã‚¨ãƒ©ãƒ¼ã§å‹•ä½œã‚’æ­¢ã‚ãªã„ï¼‰ã«å¾“ã†ãªã‚‰ã€ã‚¨ãƒ©ãƒ¼ã‚’ãƒ­ã‚°ã—ã¤ã¤ `(false, nil)` ã‚’è¿”ã™æ–¹ãŒé©åˆ‡ã€‚è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ™‚çš„å•é¡Œã§ã‚³ãƒãƒ³ãƒ‰å…¨ä½“ãŒå¤±æ•—ã—ã†ã‚‹ |
| **ä¿®æ­£æ–¹é‡** | ã‚¨ãƒ©ãƒ¼ã‚’ãƒ­ã‚°å‡ºåŠ›ã—ã¤ã¤ `(false, nil)` ã‚’è¿”ã™ã‚ˆã†å¤‰æ›´ |

### I-30: shim `modelConfigCached`/`modelConfigLoaded` ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ã®ãƒ†ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆæ¬ å¦‚ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/model_transform.go`, `main_test.go` |
| **å•é¡Œ** | ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒªã‚»ãƒƒãƒˆé–¢æ•°ãŒãªã„ã€‚å°†æ¥ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ loader ãƒ‘ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹éš›ã«ãƒ†ã‚¹ãƒˆé–“ã§çŠ¶æ…‹ãŒãƒªãƒ¼ã‚¯ |
| **ä¿®æ­£æ–¹é‡** | `resetModelConfigCache()` ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¿½åŠ  |

### I-31: shim `command_transform.go` ã®å„å¤‰æ›é–¢æ•°ã®ç›´æ¥ãƒ†ã‚¹ãƒˆæ¬ å¦‚ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/command_transform.go`, `main_test.go` |
| **å•é¡Œ** | `applyShellTransform`, `applySessionOrSplitTransform`, `applySendKeysTransform` ã®ç›´æ¥ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãªã— |
| **ä¿®æ­£æ–¹é‡** | å„å¤‰æ›é–¢æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’è¿½åŠ  |

### I-32: `copySnapshotCache` ã® shallow copy å‰æãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¬ å¦‚ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_snapshot_delta.go` |
| **å•é¡Œ** | `SessionSnapshot` å†…ã®ã‚¹ãƒ©ã‚¤ã‚¹ï¼ˆWindowsï¼‰ã‚„ãƒã‚¤ãƒ³ã‚¿ã¯å…±æœ‰ã€‚ç¾çŠ¶ã¯ `Snapshot()` ãŒæ¯å›ç‹¬ç«‹ã‚³ãƒ”ãƒ¼ã‚’è¿”ã— `snapshotDeltaMu` ãŒã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ã¦ã„ã‚‹ãŸã‚å®‰å…¨ã ãŒã€å‰æã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜è¨˜ã™ã¹ã |
| **ä¿®æ­£æ–¹é‡** | shallow copy ã®å®‰å…¨æ€§å‰æã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜è¨˜ |

### I-33: `KillSession()` ã®å†—é•·ãªå¤‰æ•°å®£è¨€ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_session_api.go` L113â€“115 |
| **å•é¡Œ** | `var worktreeInfo` ã‚’å®£è¨€ã—ãŸç›´å¾Œã« `:=` ã§å†ä»£å…¥ã€‚`var` è¡Œã¯ä¸è¦ |
| **ä¿®æ­£æ–¹é‡** | å†—é•·ãª `var` è¡Œã‚’å‰Šé™¤ |

### I-34: `app_events.go` legacy map payload ã®å‹ä¸ä¸€è‡´æ™‚ã«ã‚µã‚¤ãƒ¬ãƒ³ãƒˆã‚¹ã‚­ãƒƒãƒ—ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_events.go` L86â€“88 |
| **å•é¡Œ** | `toBytes()` ãŒäºˆæœŸã—ãªã„å‹ã« `nil` ã‚’è¿”ã—ã€ã‚µã‚¤ãƒ¬ãƒ³ãƒˆã«ã‚¹ã‚­ãƒƒãƒ—ã€‚legacy ã‚³ãƒ¼ãƒ‰ã ãŒ debug ãƒ­ã‚°è¿½åŠ æ¨å¥¨ |
| **ä¿®æ­£æ–¹é‡** | `slog.Debug` ã§å‹ä¸ä¸€è‡´æ™‚ã®ãƒ­ã‚°å‡ºåŠ›ã‚’è¿½åŠ  |

### I-35: `usePrefixKeyMode` ã® Ref åŒæœŸãƒ‘ã‚¿ãƒ¼ãƒ³ã®å†—é•·æ€§ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/hooks/usePrefixKeyMode.ts` L28â€“44 |
| **å•é¡Œ** | 4ã¤ã®å€‹åˆ¥ `useEffect` + `useRef` ã§åŒæœŸã€‚`useTmuxStore.getState()` ã‚’ç›´æ¥å‘¼ã¶ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ–¹ãŒã‚·ãƒ³ãƒ—ãƒ« |
| **ä¿®æ­£æ–¹é‡** | ãƒãƒ³ãƒ‰ãƒ©å†…ã§ `useTmuxStore.getState()` ã‚’ä½¿ç”¨ã— Ref åŒæœŸã‚’å»ƒæ­¢ |

### I-36: `tmuxStore` ã® `setSessions` ã¨ `applySessionDelta` ã®é‡è¤‡ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/stores/tmuxStore.ts` |
| **å•é¡Œ** | `buildOrder` â†’ `sortByOrder` â†’ `activeSession` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ãŒåŒãƒ‘ã‚¿ãƒ¼ãƒ³ã§ç¹°ã‚Šè¿”ã—ã€‚DRY åŸå‰‡ã«åã—ã€ä¸€æ–¹ã ã‘ä¿®æ­£ã™ã‚‹ã¨ãƒã‚°ãƒªã‚¹ã‚¯ |
| **ä¿®æ­£æ–¹é‡** | å…±é€šãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã«æŠ½å‡º |

### I-37: `useBackendSync` ã® `any` å‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/hooks/useBackendSync.ts` |
| **å•é¡Œ** | `handler: (...data: any[]) => void` ã§å‹å®‰å…¨æ€§æ¬ å¦‚ã€‚ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ­£ã—ãè¡Œã‚ã‚Œã¦ã„ã‚‹ |
| **ä¿®æ­£æ–¹é‡** | ã‚¤ãƒ™ãƒ³ãƒˆåâ†’ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰å‹ã®ãƒãƒƒãƒ”ãƒ³ã‚°å‹å®šç¾©ã‚’è¿½åŠ  |

### I-38: `TerminalPane` WebGL addon éåŒæœŸãƒ­ãƒ¼ãƒ‰ã® disposed ãƒã‚§ãƒƒã‚¯ç«¶åˆçª“ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/TerminalPane.tsx` |
| **å•é¡Œ** | `disposed` ãƒã‚§ãƒƒã‚¯ã¨ `term.loadAddon` ã®é–“ã«å¾®å°ãªç«¶åˆçª“ã€‚`try-catch` è¿½åŠ ã§å …ç‰¢åŒ–å¯èƒ½ |
| **ä¿®æ­£æ–¹é‡** | `try-catch` ã§ WebGL addon ãƒ­ãƒ¼ãƒ‰å¤±æ•—ã‚’ã‚­ãƒ£ãƒƒãƒ |

### I-39: fontSize å¤‰æ›´æ™‚ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¸ã® ResizePane é€šçŸ¥ãŒæ¬ å¦‚ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `frontend/src/components/TerminalPane.tsx` |
| **å•é¡Œ** | `fitAddon.fit()` å¾Œã€ResizeObserver ã¯ DOM ã‚µã‚¤ã‚ºå¤‰æ›´ãŒãªã„ãŸã‚ç™ºç«ã—ãªã„å¯èƒ½æ€§ã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«èª¤ã£ãŸ cols/rows ãŒæ®‹ã‚‹ãƒªã‚¹ã‚¯ |
| **ä¿®æ­£æ–¹é‡** | fontSize å¤‰æ›´å¾Œã«æ˜ç¤ºçš„ã« `ResizePane` API ã‚’å‘¼ã³å‡ºã™ |

### I-40: `app_pane_api.go` ã® `GetPaneReplay`, `GetPaneEnv`, `ApplyLayoutPreset` ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆä¸è¶³ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `app_pane_api_test.go` |
| **å•é¡Œ** | å­˜åœ¨ã—ãªã„ãƒšã‚¤ãƒ³IDã€ã‚»ãƒƒã‚·ãƒ§ãƒ³æœªå­˜åœ¨æ™‚ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æœªè¨­å®šæ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¹ãŒæœªãƒ†ã‚¹ãƒˆ |
| **ä¿®æ­£æ–¹é‡** | å„ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ  |

### I-41: `command_router_handlers_pane_test.go` ã® rootPath/worktreePath ä¸¡æ–¹ç©ºãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆæ¬ å¦‚ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `internal/tmux/command_router_handlers_pane_test.go` |
| **å•é¡Œ** | `TestSplitWindowWorkDirFallback` ã§ rootPath ã¨ worktreePath ãŒä¸¡æ–¹ç©ºã®å ´åˆã®ãƒ†ã‚¹ãƒˆãªã— |
| **ä¿®æ­£æ–¹é‡** | ä¸¡æ–¹ç©ºã®ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ  |

### I-42: `parse.go` ã® `Flags` ã‚³ãƒ¡ãƒ³ãƒˆãŒ `int` å‹ã‚’è¨€åŠã—ã¦ã„ãªã„ï¼ˆ407çµ±åˆï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ•ã‚¡ã‚¤ãƒ«** | `cmd/tmux-shim/parse.go` |
| **å•é¡Œ** | ã‚³ãƒ¡ãƒ³ãƒˆ `// Values are string or bool` ã ãŒ `flagInt` ã‚±ãƒ¼ã‚¹ã§ `int` ã‚’æ ¼ç´ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã¨å®Ÿè£…ãŒä¹–é›¢ |
| **ä¿®æ­£æ–¹é‡** | ã‚³ãƒ¡ãƒ³ãƒˆã‚’ `// Values are string, bool, or int` ã«ä¿®æ­£ |

---

## 5. Suggestion â€” æ”¹å–„ææ¡ˆ

### è¨­è¨ˆãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-1 | `internal/tmux/session_manager.go` | `cloneSessionSnapshots` â†’ `SessionSnapshot.Clone()` ãƒ¡ã‚½ãƒƒãƒ‰åŒ– + ç‹¬ç«‹æ€§ãƒ†ã‚¹ãƒˆè¿½åŠ  |
| S-2 | `internal/tmux/command_router.go` | `paneEnvView()` ã®å®‰å…¨æ€§ãŒå¥‘ç´„ã®ã¿ã€‚å°†æ¥çš„ã«èª­ã¿å–ã‚Šå°‚ç”¨æŠ½è±¡ï¼ˆ`iter.Seq2` ç­‰ï¼‰ã‚’æ¤œè¨ |
| S-3 | `internal/tmux/session_manager_targets.go` | `ResolveSessionTarget` ãŒ `resolveSessionTargetLocked` ã‚’å†…éƒ¨å‘¼å‡ºã—ã™ã‚‹å½¢ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ |
| S-4 | `app_events.go` | `emitBackendEvent` ã®ãƒã‚¹ãƒˆæ·±åº¦4æ®µ â†’ `handlePaneOutputEvent` ã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã«æŠ½å‡ºã—ã¦ãƒ•ãƒ©ãƒƒãƒˆåŒ– |
| S-5 | `internal/tmux/command_router_handlers_pane.go` | `handleKillPane` ã® `target` ãƒ‘ãƒ¼ã‚¹ â†’ `ResolveTarget` ã«çµ±ä¸€ |
| S-6 | `cmd/tmux-shim/spec.go` | `validateRequired` ã® `-t` æ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³é‡è¤‡ â†’ å…±é€š validator é–¢æ•°ã«æŠ½å‡º |
| S-7 | `cmd/tmux-shim/spec.go` | `commandSpec.name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãƒãƒƒãƒ—ã‚­ãƒ¼ã¨é‡è¤‡ â†’ å‰Šé™¤å¯èƒ½ |
| S-8 | `cmd/tmux-shim/command_transform.go` | `applySessionOrSplitTransform` ã®é–¢æ•°åãŒå®Ÿæ…‹ã¨ãšã‚Œ â†’ `applyNewProcessTransform` ç­‰ã«æ”¹å |

### å‘½åãƒ»ã‚³ãƒ¡ãƒ³ãƒˆãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-9 | `internal/tmux/session_manager_window.go` | `activeWindowInSessionLocked` è‡ªå‹•ä¿®å¾©æ™‚ã®ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ  |
| S-10 | `internal/tmux/command_router_handlers_session.go` | `handleAttachSession` ã® `-t` ãŒ no-op çš„æ‰±ã„ã§ã‚ã‚‹æ—¨ã‚’ã‚³ãƒ¡ãƒ³ãƒˆæ˜è¨˜ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã€Œreturns "ok\n"ã€ã¯å®Ÿéš›ã¯ç©ºæ–‡å­—åˆ—ã‚’è¿”ã™ãŸã‚ä¿®æ­£ |
| S-11 | `internal/tmux/key_table.go` | `C-n` / `C-p` ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ãŒ tmux éäº’æ›ï¼ˆå®Ÿ tmux ã¯ prefix + n/pï¼‰ã€‚æ„å›³çš„ã§ã‚ã‚Œã°ã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ |
| S-12 | `app_pane_api.go` L206 | `session.Windows[0] == nil` ã¯åˆ°é”ä¸èƒ½ãªæ¡ä»¶ â†’ ã‚³ãƒ¡ãƒ³ãƒˆã§ã€Œdefensive guardã€ã‚’æ˜è¨˜ã™ã‚‹ã‹ `len == 0` ãƒã‚§ãƒƒã‚¯ã®ã¿ã«ç°¡ç´ åŒ– |
| S-13 | `app_snapshot_metrics.go` L68â€“L69 | `estimateSessionSnapshotSize` ã®ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚º `103` ãŒãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ â†’ ã‚­ãƒ¼åãƒã‚¤ãƒˆæ•°ç©ã¿ä¸Šã’å½¢å¼ã‚’æ¤œè¨ |
| S-14 | `app_status.go` L50â€“L62 | `resolveActiveWindowSnapshot` ã®ä¸ä¸€è‡´æ™‚ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°å‡ºåŠ›ã‚’æ¤œè¨ |
| S-15 | `app_status.go` L10â€“L48 | `resolvePaneTitle` ã®4æ®µãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ â†’ å„ªå…ˆåº¦ã‚’æ•´ç†ã—ã€Œåˆ¥ãƒšã‚¤ãƒ³ã®Titleè¡¨ç¤ºã€ãŒæ„å›³é€šã‚Šã‹å†ç¢ºèª |
| S-16 | `command_router_handlers_pane.go` L283â€“L308 | `handleListPanes` ã®ã‚½ãƒ¼ãƒˆé–¢æ•°ãŒéå‰°ã«é˜²å¾¡çš„ â†’ `ListPanesByWindowTarget` ã®æˆ»ã‚Šå€¤ä¿è¨¼ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ– |
| S-17 | `internal/tmux/command_router_handlers_session.go` ç­‰ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚µã‚¤ã‚º `120, 40` ã®ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼åå¾© â†’ `DefaultTerminalCols = 120`, `DefaultTerminalRows = 40` ã‚’å®šæ•°åŒ– |

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-18 | `frontend/src/styles/layout.css` | `.window-tab-close` ã« `:focus-within` è¿½åŠ  â†’ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§ã‚‚ close ãƒœã‚¿ãƒ³è¡¨ç¤º |
| S-19 | `frontend/src/components/SessionView.tsx` | `role="tablist"` ã® ARIA ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸å®Œå…¨ï¼ˆ`role="tab"` / `aria-selected` / `aria-controls` ä¸è¶³ï¼‰â†’ å®Œå…¨å®Ÿè£… or å‰Šé™¤ |
| S-20 | `frontend/src/components/SessionView.tsx` | `confirmRemoveWindow` ã‚’ `useCallback` ã§åŒ…ã‚€ |
| S-21 | `frontend/src/components/SessionView.tsx` | `windowLabel` ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå¤–ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«æŠ½å‡º â†’ ãƒ†ã‚¹ãƒˆå¯èƒ½ã«ã™ã‚‹ |
| S-22 | `frontend/src/store/tmuxStore.ts` | `setActiveWindowId` ã«æœ€ä½é™ã® validation è¿½åŠ  |
| S-23 | `frontend/src/api.ts` | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸çµ±ä¸€ â†’ `try-catch` or ç´ é€šã—ã‚’çµ±ä¸€ |
| S-24 | `frontend/src/components/TerminalPane.tsx` | `memo` ã®ã‚«ã‚¹ã‚¿ãƒ æ¯”è¼ƒé–¢æ•°ã§ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‚ç…§ã‚’ç„¡è¦– â†’ ã€Œè¦ªãŒ useCallback ã§å®‰å®šå‚ç…§ã‚’ç¶­æŒã™ã‚‹å‰æã€ã‚’ã‚³ãƒ¡ãƒ³ãƒˆæ˜è¨˜ |
| S-25 | `frontend/src/types/tmux.ts` L57 vs `models.ts` L231 | `created_at` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ä¸ä¸€è‡´ï¼ˆstring vs anyï¼‰â†’ å‹å®‰å…¨ã«ã™ã‚‹ãªã‚‰ `Date` ãƒ‘ãƒ¼ã‚¹å±¤è¿½åŠ  |

### ãƒ†ã‚¹ãƒˆè¿½åŠ 

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-26 | `internal/tmux/session_manager_window_test.go` | `fallbackWindowIDNearIndex` å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆ0å€‹ãƒ»1å€‹ãƒ»å‰Šé™¤æ¸ˆã¿IDï¼‰ |
| S-27 | `cmd/tmux-shim/model_transform.go` | transform é–¢æ•°ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’ `model_transform_test.go` ã«åˆ†é›¢ |
| S-28 | `internal/tmux/command_router.go` | `init()` ã§ã®é‡è¤‡ãƒãƒ³ãƒ‰ãƒ©ç™»éŒ²æ™‚ panic ã‚’æ¤œè¨¼ã™ã‚‹ `TestInit` ãƒ†ã‚¹ãƒˆè¿½åŠ  |
| S-29 | `app_snapshot_delta.go` | diff ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ å …ç‰¢æ€§ â†’ `TestSnapshotFieldCounts` ã®æ´»ç”¨ã‚’å¾¹åº• |
| S-30 | `cmd/tmux-shim/parse.go` | `"--"` å˜ä½“ãŒæœ«å°¾ã«æ¥ã‚‹å ´åˆã®ãƒ†ã‚¹ãƒˆè¿½åŠ  |
| S-31 | `internal/tmux/session_manager_test.go` | `cloneSessionSnapshots` ç‹¬ç«‹æ€§ãƒ†ã‚¹ãƒˆ + `CreateSession` é‡è¤‡åãƒ†ã‚¹ãƒˆè¿½åŠ  |
| S-32 | `app_pane_api_test.go` | `ResizePane` å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆå¹…0/è² å€¤ï¼‰ |
| S-33 | `internal/tmux/session_manager_window_test.go` | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤æ™‚ã® `ActiveWindowID` è‡ªå‹•é·ç§»ãƒ†ã‚¹ãƒˆ + kill-window ã§æœ€å¾Œã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤ã‚·ãƒŠãƒªã‚ª |
| S-34 | `internal/tmux/key_table_test.go` | å…¨ç‰¹æ®Šã‚­ãƒ¼åãƒ»ä¿®é£¾ã‚­ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã§ã‚«ãƒãƒ¼ + F1-F12ã‚­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚µãƒãƒ¼ãƒˆæ¤œè¨ |

### ä»¥ä¸‹ã¯ review-202602181407 ã‹ã‚‰ã®çµ±åˆé …ç›®

#### App Layer

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-35 | `app_snapshot_delta.go` L145â€“160 | `snapshotDelta()` ã®2å›ç›®ã®ãƒ­ãƒƒã‚¯å†…ãƒã‚§ãƒƒã‚¯ï¼ˆ`!snapshotPrimed \|\| snapshotCache == nil`ï¼‰ã¯ `snapshotDeltaMu` ã§ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã•ã‚Œã¦ã„ã‚‹ãŸã‚åˆ°é”ä¸èƒ½ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜è¨˜æ¨å¥¨ |
| S-36 | `app_snapshot_metrics.go` L203â€“210 | `estimateSnapshotPayloadBytes` ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–‹å§‹ç›´å¾Œã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°è¨­è¨ˆæ„å›³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§è¨˜è¼‰æ¨å¥¨ |
| S-37 | `app_status.go` L77â€“85 | `BuildStatusLine()` ãŒ `time.Now()` ã‚’ç›´æ¥å‘¼å‡ºã—ã€‚ãƒ†ã‚¹ãƒˆæ™‚ã®æ™‚åˆ»åˆ¶å¾¡ãŒå›°é›£ï¼ˆä½å„ªå…ˆåº¦ï¼‰ |
| S-38 | `app_pane_api.go` L188â€“201 | `ApplyLayoutPreset` ã®å¢ƒç•Œã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆæ¬ å¦‚ï¼ˆ`[session has no windows]`, `[preset is required]` ã®ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¹ãŒãƒ†ã‚¹ãƒˆæœªã‚«ãƒãƒ¼ï¼‰ |
| S-39 | `app_events.go` L191â€“210 | `emitSnapshot()` ã®ç›´æ¥ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä¸åœ¨ï¼ˆ`requestSnapshot` çµŒç”±ã®çµ±åˆãƒ†ã‚¹ãƒˆã®ã¿ï¼‰ |
| S-40 | `app_snapshot_delta.go` L129 | `delta.Removed` ã®ã¿ `sort.Strings()` ã§éå¯¾ç§°ã€‚æ„å›³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜è¨˜æ¨å¥¨ |
| S-41 | `app_events_test.go`, `app_pane_api_test.go`, `app_session_api_test.go` | `runtimeEventsEmitFn` ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰æ³¨è¨˜ãŒä¸€éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã€‚å…¨ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«çµ±ä¸€æ¨å¥¨ |

#### tmux Layer

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-42 | `internal/tmux/key_table.go` | `sendKeysTable` ã¨ `parseControlKey` ã®é‡è¤‡ã‚³ãƒ¡ãƒ³ãƒˆæ•´ç†ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ­ã‚¸ãƒƒã‚¯å„ªå…ˆã®æ—¨ã‚’ã‚³ãƒ¡ãƒ³ãƒˆè¨˜è¼‰æ¨å¥¨ |
| S-43 | `internal/tmux/session_manager_windows.go` L228â€“238 | `WindowIndexInSession` ã® nil ãƒã‚§ãƒƒã‚¯æ¬ å¦‚ã€‚ä»–ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã®ä¸€è²«æ€§ã®ãŸã‚è¿½åŠ æ¨å¥¨ |
| S-44 | `internal/tmux/command_router_handlers_session.go` L163â€“165 | `handleShowEnvironment` ã§ `-g` ãƒ•ãƒ©ã‚°æ™‚ã« Debug ãƒ­ã‚°è¿½åŠ æ¨å¥¨ |
| S-45 | `internal/tmux/session_manager_sessions.go` L166â€“210 | `cloneSessionForRead` ã® Terminal=nil åˆ¶ç´„ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¬ å¦‚ |
| S-46 | `internal/tmux/format.go` L72â€“82 | `expandFormat` ã®ãƒã‚¹ãƒˆ `#{}` éã‚µãƒãƒ¼ãƒˆã‚’æ˜è¨˜æ¨å¥¨ |
| S-47 | `internal/tmux/session_manager_sessions.go` | `cloneSessionForRead` ã® nil ãƒšã‚¤ãƒ³ã‚¹ã‚­ãƒƒãƒ—ã§ `make([]*TmuxPane, len(window.Panes))` + `continue` â†’ nil ã®ç©´ãŒæ®‹ã‚‹ã€‚`append` æ–¹å¼ã«å¤‰æ›´æ¨å¥¨ |
| S-48 | `internal/tmux/command_router_handlers_pane.go` | `handleSendKeys` ã§ç©ºãƒšã‚¤ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ­ã‚°ãªã—ã€‚Debug ãƒ­ã‚°è¿½åŠ æ¨å¥¨ |
| S-49 | `internal/tmux/command_router_handlers_window.go` | `handleNewWindow` ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¨ãƒ©ãƒ¼é›†ç©ãŒä¸ååˆ†ã€‚è¤‡æ•°ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®æƒ…å ±æå¤±ãƒªã‚¹ã‚¯ |

#### tmux-shim

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-50 | `cmd/tmux-shim/model_transform.go` L161â€“183 | `applyModelOverride` ã§ãƒ«ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚¹ã‚­ãƒƒãƒ—ãŒæœªè€ƒæ…® |
| S-51 | `cmd/tmux-shim/model_transform.go` L82â€“94 | `loadAgentModelConfig` ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰æã‚³ãƒ¡ãƒ³ãƒˆä¸è¶³ |
| S-52 | `cmd/tmux-shim/main_test.go` | `list-sessions`, `show-environment` ã®çµ±åˆãƒ†ã‚¹ãƒˆä¸è¶³ |
| S-53 | `cmd/tmux-shim/main_test.go` | `parseCommand` ã® `flagEnv` ã§ `=` ã‚’å«ã‚€ VALUE ã®ãƒ†ã‚¹ãƒˆä¸è¶³ |

#### Frontend

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-54 | `frontend/src/types/tmux.ts`, `frontend/wailsjs/go/models.ts` | å‹äºŒé‡å®šç¾©ã®å•é¡Œï¼ˆæ‰‹æ›¸ãå‹ã¨è‡ªå‹•ç”Ÿæˆå‹ã®ä¹–é›¢ãƒªã‚¹ã‚¯ï¼‰ |
| S-55 | `frontend/src/components/SearchBar.tsx` | ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ã‚µãƒ¼ãƒã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ¬ å¦‚ã€‚é«˜é »åº¦ã‚¿ã‚¤ãƒ—æ™‚ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ‡¸å¿µ |
| S-56 | `frontend/src/components/TerminalPane.tsx` L17 | `webglUnavailable` ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¹ã‚³ãƒ¼ãƒ—å¤‰æ•°ã®è¨­è¨ˆæ„å›³ã‚’æ˜ç¤ºã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ æ¨å¥¨ |
| S-57 | `frontend/src/hooks/useBackendSync.ts` | `GetActiveSession` ã‚¨ãƒ©ãƒ¼æ™‚ã® `notifyWarn` æ¬ å¦‚ã€‚ä»–ã® API ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨éå¯¾ç§° |

---

## 6. Positive â€” è‰¯ã„ç‚¹

| # | é ˜åŸŸ | å†…å®¹ |
|---|------|------|
| P-1 | è¨­è¨ˆ | ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼å®šæ•°åŒ– + æ ¹æ‹ ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ`outputFlushInterval` / `outputFlushBufSize` ç­‰ï¼‰ |
| P-2 | App | `RenameSession` ã®ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° â€” è²¬å‹™åˆ†é›¢ãŒæ˜ç¢º |
| P-3 | App | `ActiveWindowID` å·®åˆ†æ¯”è¼ƒè¿½åŠ  + `sessionSnapshotEqual` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ•°ã‚¬ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ |
| P-4 | App | `ApplyLayoutPreset` ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å¯¾å¿œ â€” ãƒãƒ«ãƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§æ­£ã—ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆé©ç”¨ |
| P-5 | App | `BuildStatusLine` ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° â€” `resolveActiveWindowSnapshot` ãƒ˜ãƒ«ãƒ‘ãƒ¼æŠ½å‡º |
| P-6 | App | `requestSnapshot` ã® leading-edge fixed-window debounce ãŒè©³ç´°ã«ã‚³ãƒ¡ãƒ³ãƒˆæ¸ˆã¿ |
| P-7 | App | `app_window_api.go` ã®é©åˆ‡ãªè²¬å‹™åˆ†é›¢ã¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| P-8 | tmux | `Snapshot()` å…¨ãƒ‘ã‚¹ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¯ãƒ­ãƒ¼ãƒ³åŒ– â€” data race æ ¹æœ¬å¯¾ç­– |
| P-9 | tmux | `generation` ãƒ™ãƒ¼ã‚¹ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ â€” ä¸è¦ãªã‚¯ãƒ­ãƒ¼ãƒ³å›é¿ |
| P-10 | tmux | `commandSpec` ã® `init()` æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ â€” ç™»éŒ²ãƒŸã‚¹å³åº§æ¤œå‡º |
| P-11 | tmux | ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­è¨ˆã®ä¸€è²«æ€§ï¼ˆæ“ä½œå¤±æ•—æ™‚ã«å‰ã®çŠ¶æ…‹ã«æˆ»ã™ï¼‰ |
| P-12 | tmux | `fallbackWindowIDNearIndex` â€” æœ€è¿‘å‚ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¸ã®è‡ªç„¶ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| P-13 | tmux | `killPaneLocked` ã® closeTargets ãƒ‘ã‚¿ãƒ¼ãƒ³ â€” ãƒ­ãƒƒã‚¯å†…ã§ Terminal nil åŒ– â†’ ãƒ­ãƒƒã‚¯å¤–ã§ Close ã®å®‰å…¨è¨­è¨ˆ |
| P-14 | tmux | copy-on-write PaneEnv â€” èª­ã¿å–ã‚Šå´ã®å®‰å…¨æ€§ã‚’ä¿è¨¼ |
| P-15 | è¨­è¨ˆ | Stable Window ID è¨­è¨ˆ â€” ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ™ãƒ¼ã‚¹ã® TOCTOU å›é¿ |
| P-16 | shim | `--` (ãƒ€ãƒ–ãƒ«ãƒ€ãƒƒã‚·ãƒ¥) é©åˆ‡å‡¦ç† â€” ãƒ•ãƒ©ã‚°vsãƒã‚¸ã‚·ãƒ§ãƒŠãƒ«å¼•æ•°ã®å¢ƒç•Œ |
| P-17 | shim | ã‚¨ãƒ©ãƒ¼æ™‚ã¯åŸæ–‡è»¢é€ï¼ˆshim ã®ä»•æ§˜ã«å¿ å®Ÿï¼‰ |
| P-18 | shim | `runTransformSafe` ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå¾©å…ƒ â€” å¤‰æ›å¤±æ•—æ™‚ã®åŸæ–‡è»¢é€ä¿è¨¼ |
| P-19 | FE | `useBackendSync` ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ”¹å–„ â€” cleanup é–¢æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ |
| P-20 | FE | `fontSizeRef` ãƒ‘ã‚¿ãƒ¼ãƒ³ â€” stale closure å¯¾ç­–ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ |
| P-21 | FE | `ConfirmDialog` ç§»è¡Œ â€” `window.confirm` å»ƒæ­¢ï¼ˆWails ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã§é©åˆ‡ï¼‰ |
| P-22 | FE | Zustand ã‚¹ãƒˆã‚¢ã® slice ãƒ‘ã‚¿ãƒ¼ãƒ³ â€” é–¢å¿ƒã®åˆ†é›¢ |
| P-23 | FE | ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ rename â€” ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚‰ã—ã„ UX |
| P-24 | FE | `isAppConfigPayload` ã®å …ç‰¢ãªãƒ©ãƒ³ã‚¿ã‚¤ãƒ å‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| P-25 | Test | `TestSnapshotFieldCounts` â€” struct ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‰ãƒªãƒ•ãƒˆè‡ªå‹•æ¤œå‡º |
| P-26 | Test | ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã®ä¸€è²«ã—ãŸä½¿ç”¨ |

---

## 7. ã‚¿ã‚¹ã‚¯ä¸€è¦§ & ä¸¦åˆ—ä½œæ¥­å¯å¦è¡¨

### å‡¡ä¾‹

| è¨˜å· | æ„å‘³ |
|------|------|
| âœ… | ä»–ã‚°ãƒ«ãƒ¼ãƒ—ã¨ **ä¸¦åˆ—ä½œæ¥­å¯èƒ½** |
| âš ï¸ | **ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡** â€” åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§¦ã‚‹ãŸã‚é †æ¬¡ä½œæ¥­ |

### ä½œæ¥­ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§

å…¨ã‚°ãƒ«ãƒ¼ãƒ—ã¯äº’ã„ã« **ä¸¦åˆ—ä½œæ¥­å¯èƒ½**ã€‚ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®è¤‡æ•°ã‚¿ã‚¹ã‚¯ã¯ãƒ•ã‚¡ã‚¤ãƒ«ç«¶åˆã®ãŸã‚é †æ¬¡å®Ÿæ–½ã€‚

---

#### ã‚°ãƒ«ãƒ¼ãƒ— A: Frontend/typesï¼ˆç‹¬ç«‹ï¼‰
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-1 | ğŸ”´ | `?? []` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¾©å…ƒ | `models.ts` |
| S-25 | ğŸŸ¢ | `created_at` å‹ä¸ä¸€è‡´ä¿®æ­£ | `tmux.ts` |
| S-54 | ğŸŸ¢ | æ‰‹æ›¸ãå‹ã¨è‡ªå‹•ç”Ÿæˆå‹ã®äºŒé‡å®šç¾©ãƒªã‚¹ã‚¯ | `tmux.ts`, `models.ts` |

#### ã‚°ãƒ«ãƒ¼ãƒ— B: Frontend/useBackendSync âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-2 | ğŸ”´ | BOM é™¤å» | `useBackendSync.ts` |
| I-23 | ğŸŸ  | åˆæœŸåŒ–ç«¶åˆä¿®æ­£ (`Promise.all`) | `useBackendSync.ts` |
| I-37 | ğŸŸ  | `any` å‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã®å‹æ”¹å–„ | `useBackendSync.ts` |
| S-57 | ğŸŸ¢ | `GetActiveSession` ã‚¨ãƒ©ãƒ¼æ™‚ `notifyWarn` æ¬ å¦‚ | `useBackendSync.ts` |

#### ã‚°ãƒ«ãƒ¼ãƒ— C: Frontend/SessionView âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-3 | ğŸ”´ | `commitWindowRename` stale closure ä¿®æ­£ | `SessionView.tsx` |
| C-4 | ğŸ”´ | `registerRenameInput` å®‰å®šåŒ– | `SessionView.tsx` |
| I-9 | ğŸŸ  | hooks å®£è¨€é †åºæ•´ç† | `SessionView.tsx` |
| I-22 | ğŸŸ  | useWindowRename ãƒ•ãƒƒã‚¯æŠ½å‡º | `SessionView.tsx` |
| S-19 | ğŸŸ¢ | ARIA tablist å®Œå…¨å®Ÿè£… or å‰Šé™¤ | `SessionView.tsx` |
| S-20 | ğŸŸ¢ | `confirmRemoveWindow` useCallback åŒ– | `SessionView.tsx` |
| S-21 | ğŸŸ¢ | `windowLabel` ãƒ˜ãƒ«ãƒ‘ãƒ¼æŠ½å‡º | `SessionView.tsx` |

#### ã‚°ãƒ«ãƒ¼ãƒ— D: Frontend/TerminalPane âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-6 | ğŸ”´ | `EventsOff` â†’ cancel é–¢æ•°ã«çµ±ä¸€ | `TerminalPane.tsx` |
| C-10 | ğŸ”´ | `searchAddonRef` null åŒ–ã«ã‚ˆã‚‹å†ãƒã‚¦ãƒ³ãƒˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ | `TerminalPane.tsx` |
| I-24 | ğŸŸ  | å·¨å¤§ useEffect åˆ†å‰² | `TerminalPane.tsx` |
| I-38 | ğŸŸ  | WebGL addon éåŒæœŸãƒ­ãƒ¼ãƒ‰ã® disposed ç«¶åˆçª“ | `TerminalPane.tsx` |
| I-39 | ğŸŸ  | fontSize å¤‰æ›´æ™‚ ResizePane é€šçŸ¥æ¬ å¦‚ | `TerminalPane.tsx` |
| S-24 | ğŸŸ¢ | `memo` æ¯”è¼ƒé–¢æ•°ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  | `TerminalPane.tsx` |
| S-56 | ğŸŸ¢ | `webglUnavailable` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¹ã‚³ãƒ¼ãƒ—æ„å›³æ˜ç¤º | `TerminalPane.tsx` |

#### ã‚°ãƒ«ãƒ¼ãƒ— E: Frontend/ãã®ä»–ï¼ˆç‹¬ç«‹ï¼‰
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| I-8 | ğŸŸ  | `resolveActiveWindow` äºŒé‡å‘¼ã³å‡ºã—é™¤å» | `usePrefixKeyMode.ts` |
| I-10 | ğŸŸ  | ConfirmDialog ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¯¾å¿œ | `App.tsx` |
| I-35 | ğŸŸ  | `usePrefixKeyMode` Ref åŒæœŸãƒ‘ã‚¿ãƒ¼ãƒ³å†—é•·æ€§ | `usePrefixKeyMode.ts` |
| I-36 | ğŸŸ  | `tmuxStore` setSessions/applySessionDelta é‡è¤‡ | `tmuxStore.ts` |
| S-18 | ğŸŸ¢ | `.window-tab-close` ã« `:focus-within` è¿½åŠ  | `layout.css` |
| S-22 | ğŸŸ¢ | `setActiveWindowId` validation è¿½åŠ  | `tmuxStore.ts` |
| S-23 | ğŸŸ¢ | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³çµ±ä¸€ | `api.ts` |
| S-55 | ğŸŸ¢ | `SearchBar` ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ¬ å¦‚ | `SearchBar.tsx` |

#### ã‚°ãƒ«ãƒ¼ãƒ— F: Backend/app_events âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-8 | ğŸ”´ | ã‚¿ã‚¤ãƒŸãƒ³ã‚°ä¾å­˜ãƒ†ã‚¹ãƒˆæ”¹å–„ | `app_events_test.go` |
| I-14 | ğŸŸ  | ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒªã‚·ãƒ¼ä¸€å…ƒåŒ– | `app_events.go` |
| I-34 | ğŸŸ  | legacy map payload å‹ä¸ä¸€è‡´æ™‚ debug ãƒ­ã‚°è¿½åŠ  | `app_events.go` |
| S-4 | ğŸŸ¢ | `emitBackendEvent` ãƒã‚¹ãƒˆæ·±åº¦ãƒ•ãƒ©ãƒƒãƒˆåŒ– | `app_events.go` |
| S-39 | ğŸŸ¢ | `emitSnapshot()` ç›´æ¥ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä¸åœ¨ | `app_events.go` |
| S-41 | ğŸŸ¢ | `runtimeEventsEmitFn` æ³¨è¨˜ã®å…¨ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«çµ±ä¸€ | `app_events_test.go` ç­‰ |

#### ã‚°ãƒ«ãƒ¼ãƒ— G: Backend/app_pane_api âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| I-1 | ğŸŸ  | `ApplyLayoutPreset` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä¿®æ­£ | `app_pane_api.go` |
| I-2 | ğŸŸ  | `ApplyLayoutPreset` TOCTOU å¯¾ç­– | `app_pane_api.go` |
| I-21 | ğŸŸ  | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆå…±é€šåŒ– | `app_pane_api.go` |
| I-40 | ğŸŸ  | `GetPaneReplay`/`GetPaneEnv`/`ApplyLayoutPreset` ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ | `app_pane_api_test.go` |
| S-12 | ğŸŸ¢ | `Windows[0] == nil` é˜²å¾¡ã‚¬ãƒ¼ãƒ‰ã‚³ãƒ¡ãƒ³ãƒˆ | `app_pane_api.go` |
| S-32 | ğŸŸ¢ | `ResizePane` å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆè¿½åŠ  | `app_pane_api_test.go` |
| S-38 | ğŸŸ¢ | `ApplyLayoutPreset` å¢ƒç•Œã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆè¿½åŠ  | `app_pane_api_test.go` |

#### ã‚°ãƒ«ãƒ¼ãƒ— H: Backend/app_ãã®ä»–ï¼ˆç‹¬ç«‹ï¼‰
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| I-18 | ğŸŸ  | ãƒ­ãƒƒã‚¯é †åºã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ | `app_snapshot_delta.go`, `app.go` |
| I-19 | ğŸŸ  | `RenameSession` ã‚¤ãƒ™ãƒ³ãƒˆæ•´åˆæ€§ç¢ºèª | `app_session_api.go` |
| I-32 | ğŸŸ  | `copySnapshotCache` shallow copy å‰æãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | `app_snapshot_delta.go` |
| I-33 | ğŸŸ  | `KillSession()` å†—é•·å¤‰æ•°å®£è¨€å‰Šé™¤ | `app_session_api.go` |
| S-13 | ğŸŸ¢ | `estimateSessionSnapshotSize` ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ | `app_snapshot_metrics.go` |
| S-14 | ğŸŸ¢ | `resolveActiveWindowSnapshot` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ­ã‚° | `app_status.go` |
| S-15 | ğŸŸ¢ | `resolvePaneTitle` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å„ªå…ˆåº¦æ•´ç† | `app_status.go` |
| S-29 | ğŸŸ¢ | `snapshot_delta` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å …ç‰¢æ€§ | `app_snapshot_delta.go` |
| S-35 | ğŸŸ¢ | `snapshotDelta()` 2å›ç›®ãƒ­ãƒƒã‚¯å†…ãƒã‚§ãƒƒã‚¯åˆ°é”ä¸èƒ½ã‚³ãƒ¡ãƒ³ãƒˆ | `app_snapshot_delta.go` |
| S-36 | ğŸŸ¢ | `estimateSnapshotPayloadBytes` ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°è¨­è¨ˆæ„å›³ | `app_snapshot_metrics.go` |
| S-37 | ğŸŸ¢ | `BuildStatusLine()` `time.Now()` ç›´æ¥å‘¼å‡ºã— | `app_status.go` |
| S-40 | ğŸŸ¢ | `snapshotDelta` Removed ã®ã¿ã‚½ãƒ¼ãƒˆã®éå¯¾ç§°æ€§ | `app_snapshot_delta.go` |

#### ã‚°ãƒ«ãƒ¼ãƒ— I: Backend/handlers âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-5 | ğŸ”´ | `append` ã‚¹ãƒ©ã‚¤ã‚¹æ±šæŸ“ä¿®æ­£ (2ç®‡æ‰€) | `handlers_session.go`, `handlers_window.go` |
| I-12 | ğŸŸ  | `resolveWindow*` æˆ»ã‚Šå€¤ã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ | `handlers_window.go` |
| I-16 | ğŸŸ  | `-d` æŒ‡å®šæ™‚ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ | `handlers_session.go` |
| I-17 | ğŸŸ  | `resolveDirectionalPane` TOCTOU å¯¾ç­– | `handlers_pane.go` |
| I-20 | ğŸŸ  | send-keys + env ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å…±é€šåŒ– | `handlers_*.go` 3ãƒ•ã‚¡ã‚¤ãƒ« |
| I-26 | ğŸŸ  | `handleNewWindow` attach å‰ Terminal nil ãƒªã‚¹ã‚¯ | `handlers_window.go` |
| I-28 | ğŸŸ  | `emitLayoutChanged` ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« Debugâ†’Warn | `handlers_pane.go` |
| S-5 | ğŸŸ¢ | `handleKillPane` â†’ `ResolveTarget` çµ±ä¸€ | `handlers_pane.go` |
| S-10 | ğŸŸ¢ | `handleAttachSession` ã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£ | `handlers_session.go` |
| S-16 | ğŸŸ¢ | `handleListPanes` ã‚½ãƒ¼ãƒˆç°¡ç•¥åŒ– | `handlers_pane.go` |
| S-17 | ğŸŸ¢ | ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚µã‚¤ã‚ºå®šæ•°åŒ– | `handlers_*.go` |
| S-44 | ğŸŸ¢ | `handleShowEnvironment` `-g` Debug ãƒ­ã‚°è¿½åŠ  | `handlers_session.go` |
| S-48 | ğŸŸ¢ | `handleSendKeys` ç©ºãƒšã‚¤ãƒ­ãƒ¼ãƒ‰æ™‚ãƒ­ã‚°è¿½åŠ  | `handlers_pane.go` |
| S-49 | ğŸŸ¢ | `handleNewWindow` ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¨ãƒ©ãƒ¼é›†ç©ä¸ååˆ† | `handlers_window.go` |

#### ã‚°ãƒ«ãƒ¼ãƒ— J: Backend/session_manager âš ï¸ã‚°ãƒ«ãƒ¼ãƒ—å†…é †æ¬¡
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-9 | ğŸ”´ | `ResolveTarget` å†…éƒ¨ãƒã‚¤ãƒ³ã‚¿ TOCTOUï¼ˆhandleSendKeys crashï¼‰ | `session_manager_targets.go` |
| I-3 | ğŸŸ  | `ResolveTarget` ãƒ­ãƒƒã‚¯æˆ¦ç•¥å†è¨­è¨ˆ | `session_manager_targets.go` |
| I-4 | ğŸŸ  | `ListPanesByWindowTarget` ãƒã‚¤ãƒ³ã‚¿ãƒªãƒ¼ã‚¯ä¿®æ­£ | `session_manager_pane_io.go` |
| I-11 | ğŸŸ  | `Locked` ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹å‘½åè¦ç´„æ•´ç† | `session_manager_window.go`, `format.go` |
| I-13 | ğŸŸ  | `window_index` äº’æ›æ€§ä¿®æ­£ or ã‚³ãƒ¡ãƒ³ãƒˆ | `format.go` |
| I-15 | ğŸŸ  | `removeWindowAtIndexLocked` Terminal nil åŒ– | `session_manager_pane_lifecycle.go` |
| I-27 | ğŸŸ  | `WriteToPanesInWindow` å¾Œç¶šãƒšã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã®ãƒ­ã‚°è¿½åŠ  | `session_manager_pane_io.go` |
| S-1 | ğŸŸ¢ | `Clone()` ãƒ¡ã‚½ãƒƒãƒ‰åŒ– + ç‹¬ç«‹æ€§ãƒ†ã‚¹ãƒˆ | `session_manager.go` |
| S-3 | ğŸŸ¢ | `ResolveSessionTarget` ãƒªãƒ•ã‚¡ã‚¯ã‚¿ | `session_manager_targets.go` |
| S-9 | ğŸŸ¢ | auto-repair ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ  | `session_manager_window.go` |
| S-42 | ğŸŸ¢ | `sendKeysTable`/`parseControlKey` é‡è¤‡ã‚³ãƒ¡ãƒ³ãƒˆæ•´ç† | `key_table.go` |
| S-43 | ğŸŸ¢ | `WindowIndexInSession` nil ãƒã‚§ãƒƒã‚¯è¿½åŠ  | `session_manager_windows.go` |
| S-45 | ğŸŸ¢ | `cloneSessionForRead` Terminal=nil åˆ¶ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | `session_manager_sessions.go` |
| S-46 | ğŸŸ¢ | `expandFormat` ãƒã‚¹ãƒˆ `#{}` éã‚µãƒãƒ¼ãƒˆæ˜è¨˜ | `format.go` |
| S-47 | ğŸŸ¢ | `cloneSessionForRead` nil ãƒšã‚¤ãƒ³ã‚¹ã‚­ãƒƒãƒ— â†’ append åŒ– | `session_manager_sessions.go` |

#### ã‚°ãƒ«ãƒ¼ãƒ— K: Backend/testsï¼ˆç‹¬ç«‹ï¼‰
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| C-7 | ğŸ”´ | `format_test.go` ãƒ†ã‚¹ãƒˆå¤§å¹…æ‹¡å…… | `format_test.go` |
| I-41 | ğŸŸ  | rootPath/worktreePath ä¸¡æ–¹ç©ºãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ | `command_router_handlers_pane_test.go` |
| S-26 | ğŸŸ¢ | `fallbackWindowIDNearIndex` å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ | `session_manager_window_test.go` |
| S-28 | ğŸŸ¢ | `init()` panic ãƒ†ã‚¹ãƒˆ | `command_router_test.go` |
| S-31 | ğŸŸ¢ | `cloneSession` ç‹¬ç«‹æ€§ãƒ†ã‚¹ãƒˆ + é‡è¤‡åãƒ†ã‚¹ãƒˆ | `session_manager_test.go` |
| S-33 | ğŸŸ¢ | ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤æ™‚ã®è‡ªå‹•é·ç§»ãƒ†ã‚¹ãƒˆ + kill-window æœ€å¾Œã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ | `session_manager_window_test.go` |
| S-34 | ğŸŸ¢ | key_table å…¨ç‰¹æ®Šã‚­ãƒ¼ãƒ†ã‚¹ãƒˆ + F1-F12ã‚µãƒãƒ¼ãƒˆæ¤œè¨ | `key_table_test.go` |

#### ã‚°ãƒ«ãƒ¼ãƒ— L: Shimï¼ˆç‹¬ç«‹ï¼‰
| ID | é‡è¦åº¦ | ã‚¿ã‚¹ã‚¯æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« |
|----|--------|-----------|------------|
| I-5 | ğŸŸ  | `set-environment` ç©ºæ–‡å­—åˆ—å¯¾å¿œ | `parse.go` |
| I-6 | ğŸŸ  | `new-window` ãƒ†ã‚¹ãƒˆè¿½åŠ  | `main_test.go` |
| I-7 | ğŸŸ  | `resize-pane` spec ä¿®æ­£ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆ + æ–¹å‘ãƒ•ãƒ©ã‚°ï¼‰ | `spec.go` |
| I-25 | ğŸŸ  | `applyModelOverride` ç©ºå€¤ã‚¬ãƒ¼ãƒ‰è¿½åŠ  | `model_transform.go` |
| I-29 | ğŸŸ  | `applyModelTransform` config.Load å¤±æ•—æ™‚ã®shimä»•æ§˜é•å | `model_transform.go` |
| I-30 | ğŸŸ  | ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ†ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆæ¬ å¦‚ | `model_transform.go`, `main_test.go` |
| I-31 | ğŸŸ  | `command_transform` å„å¤‰æ›é–¢æ•°ã®ç›´æ¥ãƒ†ã‚¹ãƒˆæ¬ å¦‚ | `command_transform.go`, `main_test.go` |
| I-42 | ğŸŸ  | `Flags` ã‚³ãƒ¡ãƒ³ãƒˆãŒ `int` å‹ã‚’è¨€åŠã—ã¦ã„ãªã„ | `parse.go` |
| S-2 | ğŸŸ¢ | `paneEnvView()` å®‰å…¨æ€§æ”¹å–„ | (å°†æ¥æ¤œè¨) |
| S-6 | ğŸŸ¢ | `-t` æ¤œè¨¼ validator é–¢æ•°æŠ½å‡º | `spec.go` |
| S-7 | ğŸŸ¢ | `commandSpec.name` å†—é•·ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‰Šé™¤ | `spec.go` |
| S-8 | ğŸŸ¢ | `applySessionOrSplitTransform` æ”¹å | `command_transform.go` |
| S-27 | ğŸŸ¢ | transform é–¢æ•°ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆåˆ†é›¢ | `model_transform_test.go` |
| S-30 | ğŸŸ¢ | `"--"` æœ«å°¾ãƒ†ã‚¹ãƒˆè¿½åŠ  | `parse_test.go` |
| S-50 | ğŸŸ¢ | `applyModelOverride` ãƒ«ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœªã‚¹ã‚­ãƒƒãƒ— | `model_transform.go` |
| S-51 | ğŸŸ¢ | `loadAgentModelConfig` ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰æã‚³ãƒ¡ãƒ³ãƒˆ | `model_transform.go` |
| S-52 | ğŸŸ¢ | `list-sessions`/`show-environment` ãƒ†ã‚¹ãƒˆä¸è¶³ | `main_test.go` |
| S-53 | ğŸŸ¢ | `flagEnv` ã§ `=` ã‚’å«ã‚€ VALUE ãƒ†ã‚¹ãƒˆä¸è¶³ | `main_test.go` |

---

### ã‚°ãƒ«ãƒ¼ãƒ—é–“ä¸¦åˆ—ãƒãƒˆãƒªã‚¯ã‚¹

> å…¨12ã‚°ãƒ«ãƒ¼ãƒ—ãŒç›¸äº’ã« **ä¸¦åˆ—ä½œæ¥­å¯èƒ½**ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«é‡è¤‡ãªã—ï¼‰

| | A | B | C | D | E | F | G | H | I | J | K | L |
|---|--|--|--|--|--|--|--|--|--|--|--|--|
| **A** | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **B** | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **C** | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **D** | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **E** | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **F** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **G** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ |
| **H** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ | â—‹ |
| **I** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ | â—‹ |
| **J** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ | â—‹ |
| **K** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - | â—‹ |
| **L** | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | â—‹ | - |

### æ¨å¥¨å„ªå…ˆé †ä½

| å„ªå…ˆåº¦ | ã‚°ãƒ«ãƒ¼ãƒ— | ç†ç”± |
|--------|---------|------|
| ğŸ”´ æœ€å„ªå…ˆ | A, B | C-1 (TypeErroré˜²æ­¢), C-2 (BOMé™¤å») â€” å„1åˆ†ã§ä¿®æ­£å¯èƒ½ |
| ğŸ”´ æœ€å„ªå…ˆ | C, D | C-3/C-4 (stale closure), C-6 (EventsOff), C-10 (searchAddon crash) â€” UIå‹•ä½œä¸è‰¯é˜²æ­¢ |
| ğŸ”´ æœ€å„ªå…ˆ | I (C-5), J (C-9) | append ã‚¹ãƒ©ã‚¤ã‚¹æ±šæŸ“ + ResolveTarget nil deref â€” ãƒ‡ãƒ¼ã‚¿ç ´å£Šãƒ»ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚¹ã‚¯ |
| ğŸŸ¡ é«˜ | F, K | C-7 (format ãƒ†ã‚¹ãƒˆ), C-8 (flaky ãƒ†ã‚¹ãƒˆ) â€” CIå®‰å®šæ€§ |
| ğŸŸ¡ é«˜ | J (I-3,I-4,I-15,I-27) | ãƒ­ãƒƒã‚¯æˆ¦ç•¥ãƒ»ãƒã‚¤ãƒ³ã‚¿ãƒªãƒ¼ã‚¯ãƒ»Terminal nil åŒ–ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ­ã‚° â€” ä¸¦è¡Œå®‰å…¨æ€§ |
| ğŸŸ¡ é«˜ | I (I-16,I-17,I-20,I-26,I-28) | ã‚¤ãƒ™ãƒ³ãƒˆæ¬ è½ãƒ»TOCTOUãƒ»å…±é€šåŒ–ãƒ»Terminal nil â€” å‹•ä½œæ•´åˆæ€§ |
| ğŸŸ¡ é«˜ | L (I-29) | shim config.Load å¤±æ•—æ™‚ã®ä»•æ§˜é•å â€” shim ä»•æ§˜æº–æ‹  |
| ğŸŸ¢ ä¸­ | G, H, L | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å…±é€šåŒ–ãƒ»ãƒ­ãƒƒã‚¯æ–‡æ›¸åŒ–ãƒ»shimæ”¹å–„ |
| ğŸŸ¢ ä¸­ | D (I-38,I-39), E (I-35,I-36) | WebGLç«¶åˆçª“ãƒ»ResizePaneé€šçŸ¥ãƒ»DRYæ”¹å–„ |
| âšª ä½ | Suggestionå…¨èˆ¬ | UXæ”¹å–„ãƒ»å¯èª­æ€§ãƒ»æŠ€è¡“çš„è² å‚µå‰Šæ¸› |

---

### 407çµ±åˆå·®åˆ†ã‚µãƒãƒª

ä»¥ä¸‹ã¯ review-202602181407 ã‹ã‚‰çµ±åˆã•ã‚ŒãŸé …ç›®ã®ä¸€è¦§ã§ã™ã€‚

| 407 ID | çµ±åˆå…ˆ ID | é‡è¦åº¦å¤‰æ›´ | å‚™è€ƒ |
|--------|----------|-----------|------|
| 407 C-1 | **C-9** (æ–°è¦) | Criticalç¶­æŒ | handleSendKeys nil deref ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ |
| 407 C-2 | 1419 I-4 | Câ†’I | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 C-3 | 1419 I-23 | Câ†’I | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 C-4 | 1419 S-24 | Câ†’S | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 C-5 | **C-10** (æ–°è¦) | Criticalç¶­æŒ | searchAddonRef null ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ |
| 407 C-6 | 1419 C-7 | â€” | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 I-1 | 1419 C-5 | Iâ†’C | æ—¢å­˜ã‚«ãƒãƒ¼ï¼ˆæ ¼ä¸Šã’ï¼‰ |
| 407 I-2 | 1419 I-3 | â€” | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 I-3 | 1419 I-17 | â€” | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 I-4 | **I-26** (æ–°è¦) | â€” | handleNewWindow Terminal nil |
| 407 I-5 | **I-27** (æ–°è¦) | â€” | WriteToPanesInWindow ã‚¨ãƒ©ãƒ¼ãƒ­ã‚° |
| 407 I-6 | **I-28** (æ–°è¦) | â€” | emitLayoutChanged ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« |
| 407 I-7 | **I-29** (æ–°è¦) | â€” | shim config.Load ä»•æ§˜é•å |
| 407 I-8 | **I-30** (æ–°è¦) | â€” | shim ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒªã‚»ãƒƒãƒˆ |
| 407 I-9 | 1419 S-27 | â€” | æ—¢å­˜éƒ¨åˆ†ã‚«ãƒãƒ¼ |
| 407 I-10 | **I-31** (æ–°è¦) | â€” | command_transform ãƒ†ã‚¹ãƒˆ |
| 407 I-11 | **I-32** (æ–°è¦) | â€” | shallow copy ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| 407 I-12 | **I-33** (æ–°è¦) | â€” | å†—é•·å¤‰æ•°å®£è¨€ |
| 407 I-13 | **I-34** (æ–°è¦) | â€” | legacy payload ãƒ­ã‚° |
| 407 I-14 | 1419 I-24 | â€” | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 I-15 | **I-35** (æ–°è¦) | â€” | Ref åŒæœŸå†—é•·æ€§ |
| 407 I-16 | **I-36** (æ–°è¦) | â€” | tmuxStore é‡è¤‡ |
| 407 I-17 | **I-37** (æ–°è¦) | â€” | any å‹ãƒãƒ³ãƒ‰ãƒ© |
| 407 I-18 | **I-38** (æ–°è¦) | â€” | WebGL ç«¶åˆçª“ |
| 407 I-19 | **I-39** (æ–°è¦) | â€” | fontSize ResizePane |
| 407 I-20 | **I-40** (æ–°è¦) | â€” | ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ |
| 407 I-21 | 1419 S-34 | â€” | æ—¢å­˜ã‚«ãƒãƒ¼ |
| 407 I-22 | **I-41** (æ–°è¦) | â€” | rootPath ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| 407 I-23 | **I-42** (æ–°è¦) | â€” | Flags ã‚³ãƒ¡ãƒ³ãƒˆ int |
| 407 S-1ã€œS-24 | **S-35ã€œS-57** ç­‰ | â€” | 21ä»¶æ–°è¦è¿½åŠ ã€2ä»¶æ—¢å­˜ã‚«ãƒãƒ¼ |

---

*End of Consolidated Review*
