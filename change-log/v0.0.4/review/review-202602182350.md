# çµ±åˆãƒ¬ãƒ“ãƒ¥ãƒ¼ â€” 2026-02-18

**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥**: 2026-02-18
**å¯¾è±¡**: `myT-x/` é…ä¸‹ã®æœªã‚³ãƒŸãƒƒãƒˆå¤‰æ›´ (58-66ãƒ•ã‚¡ã‚¤ãƒ«, ç´„+7,000/-2,500è¡Œ)
**çµ±åˆå…ƒ**: 4ãƒ¬ãƒ“ãƒ¥ãƒ¼ (23:09, 23:27, 23:31, ãƒ†ã‚¹ãƒˆå“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼)
**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ–¹å¼**: ã‚«ãƒ†ã‚´ãƒªåˆ¥6ä¸¦åˆ—ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ Ã— 3å› + ãƒ†ã‚¹ãƒˆå“è³ªå°‚é–€ãƒ¬ãƒ“ãƒ¥ãƒ¼

---

## æŒ‡æ‘˜ä»¶æ•°ã‚µãƒãƒªãƒ¼ï¼ˆé‡è¤‡æ’é™¤å¾Œï¼‰

| é‡è¦åº¦ | ä»¶æ•° | èª¬æ˜ |
|--------|------|------|
| **Critical** | 2ä»¶ | ãƒãƒ¼ã‚¸å‰ã«ä¿®æ­£å¿…é ˆ |
| **Important** | 30ä»¶ | ä¿®æ­£æ¨å¥¨ |
| **Test Gap** | 20ä»¶ | ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ä¸è¶³ |
| **Suggestion** | 35ä»¶ | æ”¹å–„ææ¡ˆï¼ˆä»»æ„ï¼‰ |

---

## Critical Issuesï¼ˆ2ä»¶ï¼‰

### C-01: `handleKillPane` ã§ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«äºŒé‡ Close

- **ãƒ•ã‚¡ã‚¤ãƒ«**: `internal/tmux/command_router_handlers_pane.go`
- **ã‚«ãƒ†ã‚´ãƒª**: Backend tmuxå†…éƒ¨
- **æ¤œå‡º**: 3å›ã®ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å…¨ã¦ã§æ¤œå‡º + ãƒ†ã‚¹ãƒˆå“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã‚‚ã‚«ãƒãƒ¬ãƒƒã‚¸æ¬ å¦‚ã‚’æŒ‡æ‘˜
- **å•é¡Œ**: `handleKillPane` ã§ `target.Terminal` ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã€`KillPane()` å‘¼ã³å‡ºã—å¾Œã« `terminal.Close()` ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã€‚ã—ã‹ã— `KillPane` â†’ `killPaneLocked` ã®å†…éƒ¨ã§åŒã˜ Terminal ã‚’ `closeTargets` ã«åé›†ã—ã€Lock è§£æ”¾å¾Œã« Close æ¸ˆã¿ã€‚
- **ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼**:
  ```
  handleKillPane:
    terminal := target.Terminal       // (1) ã‚­ãƒ£ãƒ—ãƒãƒ£
    KillPane(paneID)                  // (2) å†…éƒ¨ã§ Terminal.Close() å®Ÿè¡Œ
    terminal.Close()                  // (3) åŒã˜ Terminal ã‚’å†åº¦ Close â†’ äºŒé‡Closeï¼
  ```
- **å½±éŸ¿**: ConPTYãƒãƒ³ãƒ‰ãƒ«ã®äºŒé‡è§£æ”¾ã€‚ãƒ‘ãƒ‹ãƒƒã‚¯ã¾ãŸã¯ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ã€‚
- **ä¿®æ­£æ–¹æ³•**: `handleKillPane` ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ« Close ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã€‚`KillPane` ãŒå†…éƒ¨ã§ Close ã‚’å®Œçµã•ã›ã¦ã„ã‚‹ã€‚

---

### C-02: `KillPane` å¾Œã®ãƒšã‚¤ãƒ³ Index å†è¨ˆç®—æ¼ã‚Œ

- **ãƒ•ã‚¡ã‚¤ãƒ«**: `internal/tmux/session_manager_panes.go`
- **ã‚«ãƒ†ã‚´ãƒª**: Backend tmuxå†…éƒ¨
- **æ¤œå‡º**: 23:31ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã¿
- **å•é¡Œ**: `SplitPane` ã§æ–°ãƒšã‚¤ãƒ³ã® `Index` ã‚’ `len(window.Panes)` ã«è¨­å®šã™ã‚‹ãŒã€`KillPane` ã§ãƒšã‚¤ãƒ³å‰Šé™¤å¾Œã«ã‚¹ãƒ©ã‚¤ã‚¹ç¸®å°ã—ã¦ã‚‚æ®‹å­˜ãƒšã‚¤ãƒ³ã® `Index` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå†è¨ˆç®—ã•ã‚Œãªã„ã€‚
- **å½±éŸ¿**:
  1. `ActivePN` ãŒã‚¹ãƒ©ã‚¤ã‚¹é•·ã‚’è¶…éã™ã‚‹å¯èƒ½æ€§ï¼ˆ`activePaneInWindow` ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ä¾å­˜ï¼‰
  2. `#{pane_index}` ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå‡ºåŠ›ã«æ¬ ç•ªãŒç™ºç”Ÿ
  3. å¤–éƒ¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒ `pane_index` ã‚’ä½¿ã£ã¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè§£æ±ºã™ã‚‹å ´åˆã«ä¸æ•´åˆ
- **ä¿®æ­£æ–¹æ³•**: `killPaneLocked` å†…ã§ãƒšã‚¤ãƒ³å‰Šé™¤å¾Œã«ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿½åŠ :
  ```go
  for i, p := range window.Panes { p.Index = i }
  ```

---

## Important Issuesï¼ˆ30ä»¶ï¼‰

### Backend Appå±¤ï¼ˆ6ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | å•é¡Œ | ä¿®æ­£æ¡ˆ |
|----|---------|------|--------|
| **I-01** | `app_events.go` | `handleLegacyMapPaneOutput` ã§ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ãŒäºŒé‡å‡ºåŠ›ã€‚å‹ãƒŸã‚¹ãƒãƒƒãƒãƒ­ã‚°å¾Œã«æ¬¡ã®æ¡ä»¶ã«ã‚‚è©²å½“ã—ã€Œskip empty pane-output payloadã€ãƒ­ã‚°ã‚‚å‡ºåŠ›ã•ã‚Œã‚‹ã€‚ | å‹ãƒŸã‚¹ãƒãƒƒãƒã®ãƒ­ã‚°å¾Œã« `return` ã§æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã€‚ |
| **I-02** | `app_pane_feed.go` | `startPaneFeedWorker` ã«ãƒ‘ãƒ‹ãƒƒã‚¯å†èµ·å‹•å›æ•°ã®ä¸Šé™ãŒãªã„ã€‚`startIdleMonitor` ã¯ `maxPanicRestartRetries(10)` ã§ä¸Šé™ãŒã‚ã‚‹ãŒã€ã“ã¡ã‚‰ã¯ç„¡é™å†èµ·å‹•ã€‚ | `maxPanicRestartRetries` ã‚¬ãƒ¼ãƒ‰ã‚’è¿½åŠ ã€‚ |
| **I-03** | `app_config_state.go` | `getConfigInternalUnsafe()` ãŒ `cfgMu.RLock` ä¸‹ã§ã‚³ãƒ”ãƒ¼ãªã—ã® config ã‚’è¿”ã™ã€‚å‘¼ã³å‡ºã—å…ƒãŒè¿”å€¤ã® map/slice ã‚’å¤‰æ›´ã™ã‚‹ã¨å†…éƒ¨çŠ¶æ…‹ç ´å£Šã€‚ | é–¢æ•°åã‚’ `getConfigInternalUnsafe` ã«å¤‰æ›´ã— WARNING ã‚³ãƒ¡ãƒ³ãƒˆå¼·èª¿ã€‚ä½¿ç”¨ç®‡æ‰€ãŒãªã„å ´åˆã¯å‰Šé™¤ã€‚ |
| **I-04** | `app_lifecycle.go` | `startup()` æœ«å°¾ã® `flushPendingConfigLoadWarnings()` ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ¥ç¶šå‰ã«æ¶ˆè²»ã•ã‚Œã‚‹å¯èƒ½æ€§ã€‚Wails `EventsOn()` ç™»éŒ²å‰ã«ã‚¤ãƒ™ãƒ³ãƒˆæ¶ˆå¤±ã€‚ | `startup()` ã§ã® flush ã‚’å‰Šé™¤ã—ã€`GetConfigAndFlushWarnings` ã«çµ±ä¸€ã€‚ |
| **I-05** | `app_guards.go` | `requireSessionsWithPaneID(paneID *string)` ãŒãƒã‚¤ãƒ³ã‚¿çµŒç”±ã§å¼•æ•°ã‚’å¤‰æ›´ã€‚Go æ…£ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯å€¤è¿”å´ãŒæ¨å¥¨ã€‚DRYåŒ–ã®åŠ¹æœã¯å¤§ããæ©Ÿèƒ½çš„ã«ã¯å•é¡Œãªã—ã€‚ | `func (a *App) requireSessionsWithPaneID(paneID string) (string, *tmux.SessionManager, error)` ã«å¤‰æ›´ï¼ˆä»»æ„ï¼‰ã€‚ |
| **I-06** | `app_lifecycle.go` | `waitWithTimeout` ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã«ã‚´ãƒ«ãƒ¼ãƒãƒ³ãŒãƒªãƒ¼ã‚¯ã€‚shutdownä¸­ã®ã¿ä½¿ç”¨ã®ãŸã‚ãƒ—ãƒ­ã‚»ã‚¹çµ‚äº†æ™‚ã«å›åã•ã‚Œã‚‹ãŒã€ãƒ†ã‚¹ãƒˆã§ã¯æ³¨æ„ã€‚ | ã‚³ãƒ¡ãƒ³ãƒˆã« 'safe only for process shutdown paths' è¨˜è¼‰æ¸ˆã¿ã€‚ãƒ†ã‚¹ãƒˆæ™‚ã¯ååˆ†ãªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’ä»˜ä¸ã€‚ |

### Backend tmuxå†…éƒ¨ï¼ˆ10ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | å•é¡Œ | ä¿®æ­£æ¡ˆ |
|----|---------|------|--------|
| **I-07** | `command_router_handlers_pane.go` | `handleKillPane` ã§ `ResolveTarget` ã‹ã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒã‚¤ãƒ³ã‚¿ `target` ã«å¯¾ã—ãƒ­ãƒƒã‚¯ä¸åœ¨ã§ `target.Window.Session.Name`, `target.Window.ID` ã‚’èª­ã¿å–ã‚Šã€‚ | `GetPaneContextSnapshot` ã‚’åˆ©ç”¨ã™ã‚‹ã‹ã€ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¤‰æ›´ã€‚ |
| **I-08** | `command_router_handlers_pane.go` | `handleResizePane` ã§ `target.Width`/`target.Height` ã‚’ãƒ­ãƒƒã‚¯å¤–èª­ã¿å–ã‚Šã€‚Go ãƒ¡ãƒ¢ãƒªãƒ¢ãƒ‡ãƒ«ä¸Šã¯æŠ€è¡“çš„ã«ãƒ‡ãƒ¼ã‚¿ãƒ¬ãƒ¼ã‚¹ã€‚ | DATA RACE NOTE ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ˜ç¤ºã€‚ |
| **I-09** | `command_router_handlers_pane.go` | `emitLayoutChangedForSession` ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãŒ `slog.Debug` â†’ `slog.Warn` ã«å¤‰æ›´ã•ã‚ŒãŸ3ç®‡æ‰€ã€‚æ­£å¸¸ãªä¸¦è¡Œå‡¦ç†ãƒ•ãƒ­ãƒ¼ã§ç™ºç”Ÿã—ã†ã‚‹ãŸã‚ `Warn` ã¯éå‰°ã€‚ | `slog.Info` ã«å¤‰æ›´ã€‚ |
| **I-10** | `session_manager_targets.go` | `resolveWindowPaneTarget` ãŒ `window.Panes[paneIdx]` ã® nil ãƒã‚§ãƒƒã‚¯ç„¡ã—ã€‚`activePaneInWindow` ã‚‚åŒæ§˜ã€‚ | nil ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ : `if pane == nil { return nil, false, fmt.Errorf(...) }` |
| **I-11** | `session_manager_targets.go` | `ResolveDirectionalPane` ã®ã‚¯ãƒ©ãƒ³ãƒ—å‹•ä½œãŒ tmux ã® wrap-around ã¨ç•°ãªã‚‹ã€‚å…ˆé ­ãƒšã‚¤ãƒ³ã§ `-L`/`-U` ã§ã‚‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒ 0 ã«ã‚¯ãƒ©ãƒ³ãƒ—ã•ã‚ŒåŒã˜ãƒšã‚¤ãƒ³ãŒè¿”ã‚‹ã€‚ | COMPATIBILITY DEVIATION ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã€ã¾ãŸã¯ãƒ©ãƒƒãƒ—ã‚¢ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè£…ã€‚ |
| **I-12** | `session_manager_targets.go` | `resolveSessionTargetLocked` ã®å‘½åãŒ `*Locked/*RLocked` è¦ç´„ã¨ä¸ä¸€è‡´ã€‚èª­ã¿å–ã‚Šå°‚ç”¨é–¢æ•°ã ãŒ `Locked` ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã€‚ | è¦ç´„ã‚³ãƒ¡ãƒ³ãƒˆæ›´æ–°ã‹é–¢æ•°åå¤‰æ›´ã€‚ |
| **I-13** | `session_manager_pane_io.go` | `ListPanesByWindowTarget` ã® `allInSession` ãƒ‘ã‚¹ã§ `copyPaneSlice` ã‚’ä½¿ã‚ãšã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ”ãƒ¼ã€‚DRYåŸå‰‡é•åã€‚ | `copyPaneSlice` ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†çµ±ä¸€ã€‚ |
| **I-14** | `session_manager_sessions.go` | `cloneSessionForRead` ã§ `idString` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæœªã‚³ãƒ”ãƒ¼ã€‚é«˜é »åº¦ãƒ‘ã‚¹ã§ä¸è¦ãªã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç™ºç”Ÿã€‚`copyPaneSlice` ã¯ struct copy ã§è‡ªå‹•ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ãŸã‚ä¸€è²«æ€§ã‚‚ãªã„ã€‚ | `paneCopy` ã« `idString: pane.idString` ã‚’è¿½åŠ ã€‚ |
| **I-15** | `format.go` | `formatSessionLine` ãŒ `strings.ReplaceAll` ã§ãƒ—ãƒªå±•é–‹å¾Œã« `expandFormat` ã‚‚å‡¦ç†ã™ã‚‹äºŒé‡å±•é–‹ã€‚ | ãƒ—ãƒªå±•é–‹ã‚’å‰Šé™¤ã— `lookupFormatVariable` ã«çµ±ä¸€ã€‚ |
| **I-16** | `command_router.go` | `paneEnvView()` ãŒ RLock ä¸‹ã§ãƒãƒƒãƒ—å‚ç…§ã‚’ãã®ã¾ã¾è¿”ã™ã€‚ã‚³ãƒ”ãƒ¼ã‚ªãƒ³ãƒ©ã‚¤ãƒˆå¥‘ç´„ã«ä¾å­˜ã™ã‚‹ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ä¿è¨¼ãªã—ã€‚ | `getPaneEnv()` ã«çµ±ä¸€ã™ã‚‹ã‹ã€INVARIANT ã‚³ãƒ¡ãƒ³ãƒˆå¼·èª¿ã€‚ |

### tmux-shimï¼ˆ5ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | å•é¡Œ | ä¿®æ­£æ¡ˆ |
|----|---------|------|--------|
| **I-17** | `command_transform.go` | `applyNewProcessTransform` ã¨ `applyShellTransform` ã§ Flags/Env ã® nil ãƒã‚§ãƒƒã‚¯åˆæœŸåŒ–ãŒäºŒé‡ã€‚ | ã‚³ãƒ¡ãƒ³ãƒˆã§é˜²å¾¡çš„ã«æ®‹ã™æ—¨ã‚’æ˜è¨˜ã€‚ |
| **I-18** | `model_transform.go` | `applyModelOverride` ã§ `--model=value` å½¢å¼ãŒæœªæ¤œå‡ºã€‚`anyModelFlagPattern` ã¯ `--model<space>` ã®ã¿å¯¾å¿œã€‚å½±éŸ¿ã¯ä½ï¼ˆç¾çŠ¶ç©ºç™½åŒºåˆ‡ã‚Šä½¿ç”¨ï¼‰ã€‚ | æ­£è¦è¡¨ç¾ã« `--model=` ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¿½åŠ ã€‚ |
| **I-19** | `model_transform.go` | `findOverrideModel` ã®ã€Œå®£è¨€é †ã«è©•ä¾¡ (first match wins)ã€ãŒæš—é»™çš„ã€‚è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¨˜è¿°é †ãŒå‹•ä½œã«å½±éŸ¿ã€‚ | README ã«ã€Œoverrides ã¯å®£è¨€é †ã«è©•ä¾¡ã•ã‚Œã‚‹ã€ã¨æ˜è¨˜ã€‚ |
| **I-20** | `main_test.go` | `TestParseCommandNewCommands` ã¨å€‹åˆ¥ãƒ†ã‚¹ãƒˆé–¢æ•°ã§åŒä¸€ã‚·ãƒŠãƒªã‚ªãŒé‡è¤‡ï¼ˆ4ç®‡æ‰€ä»¥ä¸Šï¼‰ã€‚ãƒ†ã‚¹ãƒˆä¿å®ˆã‚³ã‚¹ãƒˆå¢—å¤§ã€‚ | çµ±åˆã™ã‚‹ã‹ `TestParseCommandNewCommands` å´ã®è©²å½“ã‚±ãƒ¼ã‚¹ã‚’å‰Šé™¤ã€‚ |
| **I-21** | `model_transform.go` | `loadAgentModelConfig` ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ (`modelConfigCached`/`modelConfigLoaded`) ãŒãƒ—ãƒ­ã‚»ã‚¹ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ä¸­ã«å†åæ˜ ã•ã‚Œãªã„ã€‚shimã¯çŸ­å‘½ãƒ—ãƒ­ã‚»ã‚¹å‰æãªã®ã§ç¾çŠ¶ã¯é¡•åœ¨åŒ–ã—ã«ãã„ãŒã€`t.Parallel()` ä¸å¯ã®åˆ¶ç´„ã‚ã‚Šã€‚ | è¨­è¨ˆãƒ¡ãƒ¢ã¨ã—ã¦èªè­˜ã€‚å°†æ¥ã®ãƒ‡ãƒ¼ãƒ¢ãƒ³åŒ–æ™‚ã« TTL ã‚„ãƒªã‚»ãƒƒãƒˆæ©Ÿæ§‹ã‚’æ¤œè¨ã€‚ |

### Frontendï¼ˆ5ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | å•é¡Œ | ä¿®æ­£æ¡ˆ |
|----|---------|------|--------|
| **I-22** | `useTerminalResize.ts` + `useTerminalEvents.ts` | IME composition çµ‚äº†å¾Œã®ä¿ç•™ãƒªã‚µã‚¤ã‚ºãŒãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã•ã‚Œãªã„ã€‚composition ä¸­ã« `pendingResize = true` ãŒã‚»ãƒƒãƒˆã•ã‚Œã‚‹ãŒã€çµ‚äº†å¾Œã«ãƒˆãƒªã‚¬ãƒ¼ãŒãªãæ¬¡ã® ResizeObserver ã¾ã§åæ˜ ã•ã‚Œãªã„ã€‚ | composition çµ‚äº†å¾Œã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ã‚’è¿½åŠ ã€‚ |
| **I-23** | `useTerminalSetup.ts` | `GetPaneReplay` ã® `.then` å†…ã§ `disposed` ãƒã‚§ãƒƒã‚¯å¾Œã« `term.write(replay)` ã‚’å‘¼ã¶ãŒã€`term.dispose()` ãŒå…ˆã«å‘¼ã°ã‚ŒãŸå ´åˆã«ä¾‹å¤–ã€‚ | try-catch ã§å›²ã‚€ã€‚ |
| **I-24** | `useWindowRename.ts` | `commitWindowRename` ã® `renamingWindowId` ãŒä¾å­˜é…åˆ—ã«å«ã¾ã‚Œæ¯å›å†ç”Ÿæˆã€‚Guard 1 ã¨ Guard 2 ã®å…±å­˜ç†ç”±ã‚‚ä¸æ˜ç¢ºã€‚ | Guard 1 ã‚³ãƒ¡ãƒ³ãƒˆã«ã€ŒReact batching ã«ã‚ˆã‚Š renamingWindowId ãŒã¾ã æ›´æ–°ã•ã‚Œã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã¨æ˜è¨˜ã€‚deps ã‹ã‚‰å¤–ã—ã¦ ref ç®¡ç†ã‚‚æ¤œè¨ã€‚ |
| **I-25** | `ConfirmDialog.tsx` | Tab ã‚­ãƒ¼ã§ `e.stopPropagation()` æœªå‘¼ã³å‡ºã—ã€‚`usePrefixKeyMode` ç­‰ã®ä»–ã‚­ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã¨ç«¶åˆã™ã‚‹å¯èƒ½æ€§ï¼ˆä½ãƒªã‚¹ã‚¯ï¼‰ã€‚ | Tab ãƒãƒ³ãƒ‰ãƒ©ã«ã‚‚ `e.stopPropagation()` ã‚’è¿½åŠ ã€‚ |
| **I-26** | `tmuxStore.ts` | `resolveSessionState` ã§ `String(activeSessionSnapshot.active_window_id)` ä½¿ç”¨ã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒçœç•¥æ™‚ `String(undefined)` = `"undefined"` ãŒã‚»ãƒƒãƒˆã•ã‚Œã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ¤œç´¢å¤±æ•—ã€‚ | å‹ã‚¬ãƒ¼ãƒ‰ã‚’è¿½åŠ : `typeof rawId === 'number' ? String(rawId) : null` |

### Config/Install/IPCï¼ˆ4ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | å•é¡Œ | ä¿®æ­£æ¡ˆ |
|----|---------|------|--------|
| **I-27** | `shim_cleanup_windows.go` | `removeLegacyDirectory` ã®è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªèµ°æŸ»ã§ `current := legacyBase` ãŒ `filepath.Clean` ã•ã‚Œã¦ã„ãªã„ã€‚æœ«å°¾ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã®ä¸ä¸€è‡´ãƒªã‚¹ã‚¯ã€‚ | `current = filepath.Clean(legacyBase)` ã§åˆæœŸå€¤æ­£è¦åŒ–ã€‚ |
| **I-28** | `shim_cleanup_windows.go` | `filterPathEntries` ã«ç©ºæ–‡å­—åˆ— `removeDir` ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã®é˜²å¾¡ãªã—ã€‚`filepath.Clean("")` = `"."` ã§ PATH å†…ã® `.` ãŒæ„å›³ã›ãšå‰Šé™¤ã•ã‚Œã‚‹å¯èƒ½æ€§ã€‚ | `normalizedRemove == "."` ã®å ´åˆã« `return pathValue` ã§æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã€‚ |
| **I-29** | `protocol.go` | `DefaultPipeName()` ã§ USERNAME ç’°å¢ƒå¤‰æ•°ãŒç©ºã‹ã¤ `user.Current()` å¤±æ•—æ™‚ã€ç©ºæ–‡å­—åˆ—ã‚’å«ã‚€ãƒ‘ã‚¤ãƒ—å `\\.\pipe\myT-x-` ãŒè¿”ã•ã‚Œã‚‹ã€‚ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®è¡çªãƒªã‚¹ã‚¯ã€‚ | ç©ºã®å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆä¾‹: `"default"`ï¼‰ã‚’è¿½åŠ ã€‚ |
| **I-30** | `protocol.go` | `decodeRequest()` ã§ Flags ã¨ Env ã¯ nilâ†’ç©ºmapåˆæœŸåŒ–ã™ã‚‹ãŒ Args ã¯ nil ã®ã¾ã¾ã€‚ä¸€è²«æ€§ãªã—ã€‚ | Args ã‚‚ `[]string{}` ã§åˆæœŸåŒ–ã€ã¾ãŸã¯æ–¹é‡ã‚’çµ±ä¸€ã€‚ |

---

## ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚®ãƒ£ãƒƒãƒ—ï¼ˆ20ä»¶ï¼‰

### å„ªå…ˆåº¦: é«˜

| ID | å¯¾è±¡é–¢æ•° | å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ | æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|----|---------|-----------|------|------------|
| **G-01** | `handleKillPane` Closeå›æ•° | `command_router_handlers_pane.go` | äºŒé‡Closeæœªæ¤œè¨¼ | Mock Terminal ã§ Close å‘¼ã³å‡ºã—å›æ•°ãƒ†ã‚¹ãƒˆ |
| **G-02** | `ResolveDirectionalPane` | `session_manager_targets.go` | æ–°è¦å…¬é–‹é–¢æ•°ã«ãƒ†ã‚¹ãƒˆç„¡ã— | `DirNone`/`DirPrev`/`DirNext` ã®ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆ |
| **G-03** | `CreateSessionWithWorktree` E2E | `app_worktree_api.go` | å€‹åˆ¥é–¢æ•°ãƒ†ã‚¹ãƒˆã®ã¿ã€‚çµ±åˆãƒ†ã‚¹ãƒˆ+ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆæ¬ å¦‚ | git fixture ã‚’ä½¿ã£ãŸçµ±åˆãƒ†ã‚¹ãƒˆ |
| **G-04** | `SendSyncInput` | `app_pane_api.go` | å°‚ç”¨ãƒ†ã‚¹ãƒˆç„¡ã— | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³+æˆåŠŸãƒ‘ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆ |
| **G-05** | `Clone` (Config) | `config.go` | ãƒ†ã‚¹ãƒˆç„¡ã— | ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼æ¤œè¨¼ + ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ•°ã‚¬ãƒ¼ãƒ‰ |
| **G-06** | `handleNewWindow` | `command_router_handlers_window.go` | ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¢ã‚¿ãƒƒãƒã€-d ãƒ•ãƒ©ã‚°ã€-P/-F å‡ºåŠ›ã®ãƒ†ã‚¹ãƒˆç„¡ã— | ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ãƒ†ã‚¹ãƒˆ |
| **G-07** | `handleKillWindow` | `command_router_handlers_window.go` | Terminal.Closeã€æœ€å¾Œã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤æ™‚ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤ãƒ†ã‚¹ãƒˆç„¡ã— | ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ãƒ†ã‚¹ãƒˆ |
| **G-08** | `handleSelectWindow` | `command_router_handlers_window.go` | -t ãƒ•ãƒ©ã‚°è§£æ±ºã€pane-focused ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚¹ãƒˆç„¡ã— | ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ãƒ†ã‚¹ãƒˆ |

### å„ªå…ˆåº¦: ä¸­

| ID | å¯¾è±¡é–¢æ•° | å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ | æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|----|---------|-----------|------|------------|
| **G-09** | `handleSendKeys` nil/ç©ºpayload | `command_router_handlers_pane.go` | é–“æ¥ãƒ†ã‚¹ãƒˆã®ã¿ | å°‚ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆ |
| **G-10** | `SplitWindowInternal` | `command_router_handlers_pane.go` | GUI Fast-path ãƒ†ã‚¹ãƒˆç„¡ã— | ç©ºã‚¿ãƒ¼ã‚²ãƒƒãƒˆ/æ­£å¸¸åˆ†å‰²ãƒ†ã‚¹ãƒˆ |
| **G-11** | `handleListPanes` | `command_router_handlers_pane.go` | IPCçµ±åˆãƒ†ã‚¹ãƒˆç„¡ã— | `-s`, `-F` ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ†ã‚¹ãƒˆ |
| **G-12** | `EnsureFile` | `config.go` | ãƒ†ã‚¹ãƒˆç„¡ã— | ãƒ•ã‚¡ã‚¤ãƒ«ç„¡ã—/æ—¢å­˜/ä¸æ­£ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ |
| **G-13** | `ApplyLayoutPresetToActiveWindow` | `session_manager_pane_io.go` | SessionManager ãƒ¬ãƒ™ãƒ«ã®ç›´æ¥ãƒ†ã‚¹ãƒˆç„¡ã— | AppçµŒç”±ã®ã¿ã§ãªãç›´æ¥ãƒ†ã‚¹ãƒˆ |
| **G-14** | `buildPaneEnv`/`isBlockedEnvironmentKey` | `command_router.go` | ãƒ†ã‚¹ãƒˆç„¡ã— | blocked key ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ç›´æ¥ãƒ†ã‚¹ãƒˆ |
| **G-15** | `configureGlobalHotkey` | `app_lifecycle.go` | ãƒ†ã‚¹ãƒˆç„¡ã— | ãƒ‘ãƒ¼ã‚¹ãƒ­ã‚¸ãƒƒã‚¯åˆ†é›¢ + ãƒ†ã‚¹ãƒˆ |
| **G-16** | `readLimitedFile` ä¸Šé™è¶…é | `config.go` | ãƒ†ã‚¹ãƒˆç„¡ã— | 1MB+1 byte ãƒ†ã‚¹ãƒˆ |
| **G-17** | `RemoveWindowByID` å°‚ç”¨ãƒ†ã‚¹ãƒˆ | `session_manager_windows.go` | ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ä½¿ç”¨ã®ã¿ | æœ€å¾Œã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤æ‹’å¦ãƒ†ã‚¹ãƒˆ |
| **G-18** | `startIdleMonitor` | `app_lifecycle.go` | ãƒ†ã‚¹ãƒˆç„¡ã— | mock time ãƒ†ã‚¹ãƒˆ |

### å„ªå…ˆåº¦: ä½

| ID | å¯¾è±¡é–¢æ•° | å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|----|---------|-----------|------|
| **G-19** | `toString()`/`toBytes()` | `app_helpers.go` | é–“æ¥ãƒ†ã‚¹ãƒˆã®ã¿ã€‚å…¨åˆ†å²ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆæ¨å¥¨ |
| **G-20** | `sanitizePaneEnv` | `config.go` | Load/Save å†…ã§é–“æ¥ãƒ†ã‚¹ãƒˆã€‚ç›´æ¥ãƒ†ã‚¹ãƒˆåŒ–æ¨å¥¨ |

---

## Suggestionsï¼ˆ35ä»¶ï¼‰

### Appå±¤ï¼ˆ9ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-01 | `app_events.go` | `shouldSyncPaneStates` ãŒå‰¯ä½œç”¨ã‚’æŒã¤è¿°èªã€‚`checkAndAdvanceTopologySync()` ç­‰ã®åå‰ã«å¤‰æ›´æ¨å¥¨ã€‚ |
| S-02 | `app_events.go` | typed `PaneOutputEvent` ãƒ‘ã‚¹ã«ã‚‚ empty payload ã®ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ ï¼ˆlegacy ãƒ‘ã‚¹ã¨ã®ä¸€è²«æ€§ï¼‰ã€‚ |
| S-03 | `app_events.go` | `handleLegacyMapPaneOutput` ã® TODO ã‚³ãƒ¡ãƒ³ãƒˆã«æœŸé™ã‚„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’è¿½åŠ æ¨å¥¨ã€‚ |
| S-04 | `app_snapshot_delta.go` | `IMPORTANT` ã‚³ãƒ¡ãƒ³ãƒˆ5ç®‡æ‰€ãŒç¹°ã‚Šè¿”ã—ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ¡ãƒ³ãƒˆã§ä¸€åº¦è¨€åŠã—å„é–¢æ•°ã¯ç°¡ç•¥åŒ–ã€‚ |
| S-05 | `app_snapshot_metrics.go` | å›ºå®šãƒã‚¤ãƒˆæ•° `103` ã®ã‚¬ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆè¿½åŠ ã‚’æ¤œè¨ã€‚ |
| S-06 | `app_pane_api.go` | `ResizePane` ãŒã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç™ºè¡Œ (`requestSnapshot`) ã‚’è¡Œã‚ãªã„ã€‚ä»–APIã¨ã®ä¸€è²«æ€§ç¢ºèªã€‚ |
| S-07 | `app_snapshot_delta.go` | `copySnapshotCache` ã®æµ…ã„ã‚³ãƒ”ãƒ¼ã€‚å°†æ¥ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãƒã‚¤ãƒ³ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ æ™‚ã®ãƒªã‚¹ã‚¯ã€‚`DeepCopy()` æ¤œè¨ã€‚ |
| S-08 | `app_events_test.go` | `TestEmitSnapshot` ã® `tt.name` æ–‡å­—åˆ—ä¸€è‡´ã«ã‚ˆã‚‹æ¡ä»¶åˆ†å²ãŒè„†å¼±ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã« `wantPayload bool` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã€‚ |
| S-09 | `app_status.go` | `resolveActiveWindowSnapshot` ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ­ã‚°ã§ `windows[0].ID` ã‚¢ã‚¯ã‚»ã‚¹ã¨ return ã®è·é›¢ã«æ³¨æ„ã€‚ |

### tmux-shimï¼ˆ8ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-10 | `main.go` | `shimDebugLogKeepGenerations = 32` Ã— 5MB = æœ€å¤§160MBã€‚é–‹ç™ºçµ‚äº†å¾Œã«å€¤è¦‹ç›´ã—æ¨å¥¨ã€‚ |
| S-11 | `main.go` | `rotateShimDebugLogIfNeeded` ã® retry ãƒ«ãƒ¼ãƒ— `4` ãŒãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã€‚`const maxRotateRetries` æ¨å¥¨ã€‚ |
| S-12 | `main.go` | ã‚³ãƒ¡ãƒ³ãƒˆä¸­ã®æ–‡å­—åŒ–ã‘ `çª¶ãƒ»` ã‚’ ASCII ã«ä¿®æ­£ã€‚ |
| S-13 | `command_transform.go` | `flagValue` ã¨ `parse.go` ã® `asString` ãŒåŒæ©Ÿèƒ½ã§é‡è¤‡ã€‚çµ±ä¸€æ¨å¥¨ã€‚ |
| S-14 | `model_transform.go` | `applyModelOverride` ãƒ¡ã‚½ãƒƒãƒ‰ãŒé•·ã„ã€‚å‡¦ç†ãƒ•ãƒ­ãƒ¼æ¦‚è¦ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…ˆé ­ã«è¿½åŠ æ¨å¥¨ã€‚ |
| S-15 | `model_transform.go` | Overrides ãƒ«ãƒ¼ãƒ—å†…ã§æ¯å› `regexp.MustCompile`ã€‚transformer ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¨å¥¨ã€‚ |
| S-16 | `model_transform.go` | `applyFromToReplacement` ã® defense-in-depth ã« `debugLog` è¿½åŠ ã€‚ |
| S-17 | `model_transform.go` | `applyModelOverride` ã® `isLikelyOptionToken` ã‚¹ã‚­ãƒƒãƒ—ãƒ‘ã‚¹ã«ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ ã€‚ |

### Backend tmuxå†…éƒ¨ï¼ˆ8ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-18 | `command_router.go` | `bestEffortSendKeys` ã® `pane.Terminal` ãƒ­ãƒƒã‚¯å¤–èª­ã¿å–ã‚Šã« safety note ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã€‚ |
| S-19 | `session_manager_windows.go` | `removeWindowAtIndexLocked` ã® `removedPanes` åˆæœŸåŒ–ã®é‡è¤‡ã‚’æ•´ç†ã€‚ |
| S-20 | `session_manager_snapshot.go` | `Snapshot()` ã® `RUnlock` ã‚’ defer ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¤‰æ›´ã€‚RLock ãƒ‘ã‚¹ã®å®‰å…¨æ€§ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã€‚ |
| S-21 | `command_router_handlers_window.go` | `handleNewWindow`/`handleKillWindow`/`handleSelectWindow` ã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãƒ†ã‚¹ãƒˆè¿½åŠ ã€‚ |
| S-22 | `command_router_handlers_pane_test.go` | `TestHandleResizePane` ã« 0 ã‚„ãƒã‚¤ãƒŠã‚¹ dimensions ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ ã€‚ |
| S-23 | `session_manager_pane_io.go` | `WriteToPanesInWindow` ãŒ firstErr ã®ã¿è¿”å´ã€‚å¤±æ•—ãƒšã‚¤ãƒ³æƒ…å ±ãŒå¤±ã‚ã‚Œã‚‹ã€‚ |
| S-24 | `key_table.go` | `sendKeysTable` ã¨ `parseControlKey` ã®ä¸æ•´åˆæ¤œå‡ºç”¨ã‚¬ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆè¿½åŠ æ¨å¥¨ã€‚ |
| S-25 | `session_manager_targets.go` | `#{window_index}` ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ–‡å­—åˆ—ä½¿ç”¨æ™‚ã¯ `@` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹å¿…è¦ã¨æ˜è¨˜ã€‚ |

### Frontendï¼ˆ5ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-26 | `useTerminalSetup.ts` | `setRendererMode` â†’ `logRendererMode` ã«ãƒªãƒãƒ¼ãƒ ï¼ˆãƒŸã‚¹ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã€‚ |
| S-27 | `useTerminalFontSize.ts` | ç¬¬2 useEffect ã®ä¾å­˜é…åˆ—ã‹ã‚‰ä¸è¦ãª ref ã‚’é™¤å»ã— `[fontSize, paneId]` ã®ã¿ã«ã€‚ |
| S-28 | `useTerminalEvents.ts` | eslint-disable ã®æŠ‘åˆ¶ã‚³ãƒ¡ãƒ³ãƒˆã«é™¤å¤–ã—ã¦ã„ã‚‹å®‰å®šå‚ç…§ã®å…·ä½“åã‚’æ˜è¨˜æ¨å¥¨ã€‚ |
| S-29 | `layout.css` | `.window-tab-close:focus-within` ã‚’ `:focus-visible` ã«å¤‰æ›´ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼‰ã€‚ |
| S-30 | `tmux.ts` | DRIFT RISK ã‚³ãƒ¡ãƒ³ãƒˆã¯æœ‰ç”¨ã€‚CI ã§ Go struct ã¨ã®å‹ä¸€è‡´ã‚’æ¤œè¨¼ã™ã‚‹ä»•çµ„ã¿ã‚’å°†æ¥æ¤œè¨ã€‚ |

### Config/Install/IPCï¼ˆ3ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-31 | `config_test.go` | `TestLoadAgentModel` ã« "ALL" ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰çµ±åˆãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ ã€‚ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹æ¤œè¨¼ã‚‚è¿½åŠ ã€‚ |
| S-32 | `protocol.go` | `TmuxRequest.Flags` ã®å‹ `map[string]any` ã«å‹åˆ¶ç´„ãªã—ã€‚ä»»æ„ã®å‹æ··å…¥å¯èƒ½ã€‚ |
| S-33 | `shim_cleanup_windows.go` | `stalePathSubstring` ãŒãƒ†ã‚¹ãƒˆç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ `\Temp\TestEnsureShim` ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã€‚æœ¬ç•ªã«ãƒ†ã‚¹ãƒˆå°‚ç”¨ãƒ­ã‚¸ãƒƒã‚¯ã€‚ |

### ãƒ†ã‚¹ãƒˆæ”¹å–„ï¼ˆ2ä»¶ï¼‰

| ID | ãƒ•ã‚¡ã‚¤ãƒ« | ææ¡ˆ |
|----|---------|------|
| S-34 | `session_manager_test.go` | `cloneSessionSnapshots` ãƒ†ã‚¹ãƒˆã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚«ã‚¦ãƒ³ãƒˆã‚¬ãƒ¼ãƒ‰è¿½åŠ ã€‚ |
| S-35 | `AgentModelSettings.tsx` | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã‚­ãƒ¼ãŒé…åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ™ãƒ¼ã‚¹ã€‚è¡Œå‰Šé™¤æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒé–“é•ã£ãŸè¡Œã«è¡¨ç¤ºã€‚`ov.id` ã‚’ã‚­ãƒ¼ã«ä½¿ç”¨æ¨å¥¨ã€‚ |

---

## Positive Observationsï¼ˆè‰¯ã„ç‚¹ï¼‰

### è¨­è¨ˆãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- `snapshotEventPolicies` ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•åŒ–ã«ã‚ˆã‚‹ DRY æ”¹å–„ â€” Open-Closed åŸå‰‡æº–æ‹ 
- `requireSessionsWithPaneID` ã«ã‚ˆã‚‹ 7ãƒ¡ã‚½ãƒƒãƒ‰ã® DRYåŒ–ï¼ˆç´„40è¡Œå‰Šæ¸›ï¼‰
- TerminalPane ãƒ•ãƒƒã‚¯4åˆ†å‰²è¨­è¨ˆ (662è¡Œâ†’298è¡Œ) â€” SRP æº–æ‹ 
- ãƒ­ãƒƒã‚¯é †åºã®ä½“ç³»çš„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`cfgSaveMuâ†’cfgMu`, `snapshotDeltaMuâ†’snapshotMu`ï¼‰
- `resolveSessionState` ãƒ˜ãƒ«ãƒ‘ãƒ¼ã®æŠ½å‡ºã§é‡è¤‡ãƒ­ã‚¸ãƒƒã‚¯å…±é€šåŒ–

### å®‰å…¨æ€§ãƒ»å …ç‰¢æ€§
- TOCTOU ä¿®æ­£ã®å“è³ªãŒé«˜ã„ï¼ˆ`ApplyLayoutPresetToActiveWindow`, `ResolveDirectionalPane`, `RemoveWindowByID`ï¼‰
- `ResolveTarget` ã®ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯ãƒ­ãƒƒã‚­ãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³
- Terminal ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã®ãƒ­ãƒƒã‚¯å¤–å®Ÿè¡Œï¼ˆãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯é˜²æ­¢ï¼‰
- `runTransformSafe` ã«ã‚ˆã‚‹ panic recovery + snapshot rollbackï¼ˆshimï¼‰
- ä¸–ä»£ãƒ™ãƒ¼ã‚¹ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥
- ç’°å¢ƒå¤‰æ•°ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆblockedEnvironmentKeysã€null ãƒã‚¤ãƒˆé™¤å»ï¼‰
- `feedBytePool` ã®å¤§ãƒãƒƒãƒ•ã‚¡å»ƒæ£„ï¼ˆmaxPoolBufSize è¶…éæ™‚ã« GC å§”ä»»ï¼‰

### ãƒ†ã‚¹ãƒˆå“è³ª (ç·åˆè©•ä¾¡: **A-**)
- ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è²«é©ç”¨
- æ§‹é€ ä½“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ•°ã‚¬ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ (`reflect.TypeOf().NumField()`)
- `snapshotEventPolicyConsistency` ç­‰ã® invariant ãƒ†ã‚¹ãƒˆ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆï¼ˆsymlinkè„±å‡ºã€path traversalã€null byteæ³¨å…¥ã€ãƒã‚¸ã‚§ãƒƒãƒˆä¸Šé™ï¼‰
- `t.Cleanup` + é–¢æ•°å¤‰æ•°ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹å®‰å…¨ãªãƒ¢ãƒƒã‚¯ç®¡ç†
- EventsOn cancel ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹å®‰å…¨ãªãƒªã‚¹ãƒŠãƒ¼è§£é™¤

### Frontend
- IME composition ã®3ç‚¹ç›£è¦–ï¼ˆcompositionstart/end/blurï¼‰
- WebGL ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: onContextLoss â†’ DOM ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼åˆ‡æ›¿ï¼ˆ3é‡é˜²å¾¡ï¼‰
- RAF ãƒãƒƒãƒæ›¸ãè¾¼ã¿ï¼ˆpendingWrites + requestAnimationFrameï¼‰
- `useWindowRename` ã® inflight guard è¨­è¨ˆ

### Config/Install/IPC
- `CleanupLegacyShimInstalls` ã¯å…¨ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿ï¼ˆèµ·å‹•ãƒ–ãƒ­ãƒƒã‚¯ã—ãªã„è¨­è¨ˆï¼‰
- ã¹ãç­‰æ€§ã®è¨­è¨ˆã¨æ¤œè¨¼
- ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ–¹å¼ã®å®‰å…¨ãªãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤

---

## ä¸¦åˆ—ä½œæ¥­è¡¨

### å‡¡ä¾‹
- â­• **ä¸¦åˆ—OK**: ä»–ã‚¿ã‚¹ã‚¯ã¨ç‹¬ç«‹ã—ã¦åŒæ™‚ä½œæ¥­å¯èƒ½
- âš ï¸ **æ¡ä»¶ä»˜ã**: åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ¥ä¿®æ­£ã¨ã®ç«¶åˆã‚ã‚Š
- ğŸ”— **ä¾å­˜**: å…ˆè¡Œã‚¿ã‚¹ã‚¯å®Œäº†ã‚’å¾…ã¤

### Phase 1: Criticalï¼ˆæœ€å„ªå…ˆ â€” é †æ¬¡å®Ÿè¡Œï¼‰

| ID | æ¦‚è¦ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« | ä¸¦åˆ— | å‚™è€ƒ |
|----|------|-------------|:----:|------|
| C-01 | handleKillPane äºŒé‡Close | `command_router_handlers_pane.go` | â€” | **æœ€åˆã«ä¿®æ­£**ã€‚I-07/I-08/I-09 ã¨åŒãƒ•ã‚¡ã‚¤ãƒ« |
| C-02 | KillPane Index å†è¨ˆç®— | `session_manager_panes.go` | â­• | C-01 ã¨ç‹¬ç«‹ãƒ•ã‚¡ã‚¤ãƒ« |

### Phase 2: Important â€” ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆC-01å®Œäº†å¾Œã€5ä¸¦åˆ—å¯ï¼‰

| ãƒãƒƒãƒ | ã‚¿ã‚¹ã‚¯ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« | ä¸¦åˆ— | å‚™è€ƒ |
|--------|-------|-------------|:----:|------|
| **A** | I-07 + I-08 + I-09 | `command_router_handlers_pane.go` | ğŸ”— C-01 | C-01å®Œäº†å¾Œã«åŒãƒ•ã‚¡ã‚¤ãƒ«ã¾ã¨ã‚ã¦ä¿®æ­£ |
| **B** | I-10 + I-11 + I-12 | `session_manager_targets.go` | â­• | å¤‰æ›´ç®‡æ‰€ãŒé›¢ã‚Œã¦ã„ã‚‹ãŸã‚å®Ÿè³ªä¸¦åˆ—OK |
| **C** | I-13 + I-14 | `session_manager_pane_io.go` + `session_manager_sessions.go` | â­• | åˆ¥ãƒ•ã‚¡ã‚¤ãƒ« |
| **D** | I-15 + I-16 | `format.go` + `command_router.go` | â­• | åˆ¥ãƒ•ã‚¡ã‚¤ãƒ« |
| **E** | I-01 + I-02 | `app_events.go` + `app_pane_feed.go` | â­• | åˆ¥ãƒ•ã‚¡ã‚¤ãƒ« |

### Phase 3: Important â€” tmux-shim + Config + Frontendï¼ˆå…¨ä¸¦åˆ—å¯ï¼‰

| ãƒãƒƒãƒ | ã‚¿ã‚¹ã‚¯ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« | ä¸¦åˆ— | å‚™è€ƒ |
|--------|-------|-------------|:----:|------|
| **F** | I-17 + I-18 + I-19 + I-20 + I-21 | `cmd/tmux-shim/` å„ãƒ•ã‚¡ã‚¤ãƒ« | â­• | shim ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã§ç‹¬ç«‹ |
| **G** | I-22 | `useTerminalResize.ts` + `useTerminalEvents.ts` | â­• | Frontendã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ç‹¬ç«‹ |
| **H** | I-23 + I-24 + I-25 | `useTerminalSetup.ts` + `useWindowRename.ts` + `ConfirmDialog.tsx` | â­• | å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç‹¬ç«‹ |
| **I** | I-26 | `tmuxStore.ts` | â­• | Frontend ç‹¬ç«‹ |
| **J** | I-27 + I-28 | `shim_cleanup_windows.go` | â­• | åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã ãŒã¾ã¨ã‚ã¦ä¿®æ­£ |
| **K** | I-29 + I-30 | `protocol.go` | â­• | åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã ãŒã¾ã¨ã‚ã¦ä¿®æ­£ |
| **L** | I-03 + I-04 + I-05 + I-06 | `app_config_state.go` + `app_lifecycle.go` + `app_guards.go` | â­• | I-04/I-06ã¯åŒãƒ•ã‚¡ã‚¤ãƒ«ã ãŒã¾ã¨ã‚ã¦ä¿®æ­£ |

### Phase 4: ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸æ‹¡å……ï¼ˆå…¨ä¸¦åˆ—å¯ï¼‰

| ãƒãƒƒãƒ | ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚®ãƒ£ãƒƒãƒ— | æ–°è¦/æ—¢å­˜ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | ä¸¦åˆ— |
|--------|-----------------|---------------------|:----:|
| **M** | G-01 | `command_router_handlers_pane_test.go` | â­• |
| **N** | G-02 | `session_manager_targets_test.go` (æ–°è¦) | â­• |
| **O** | G-03 + G-04 | `app_worktree_api_test.go` + `app_pane_api_test.go` | â­• |
| **P** | G-05 + G-12 + G-16 | `config_test.go` | â­• |
| **Q** | G-06 + G-07 + G-08 | `command_router_handlers_window_test.go` (æ–°è¦) | â­• |
| **R** | G-09 + G-10 + G-11 | `command_router_handlers_pane_test.go` | âš ï¸ M | Må®Œäº†å¾Œã«è¿½åŠ  |
| **S** | G-13 + G-14 | `session_manager_pane_io_test.go` + `command_router_test.go` | â­• |
| **T** | G-15 + G-18 | `app_lifecycle_test.go` | â­• |

### Phase 5: Suggestionsï¼ˆä»»æ„ â€” å…¨ä¸¦åˆ—å¯ï¼‰

| ãƒãƒƒãƒ | ã‚¿ã‚¹ã‚¯ | å¯¾è±¡ | ä¸¦åˆ— |
|--------|-------|------|:----:|
| **U** | S-01ã€œS-09 | Appå±¤å„ãƒ•ã‚¡ã‚¤ãƒ« | â­• |
| **V** | S-10ã€œS-17 | tmux-shim å„ãƒ•ã‚¡ã‚¤ãƒ« | â­• |
| **W** | S-18ã€œS-25 | internal/tmux å„ãƒ•ã‚¡ã‚¤ãƒ« | â­• |
| **X** | S-26ã€œS-30 | Frontend å„ãƒ•ã‚¡ã‚¤ãƒ« | â­• |
| **Y** | S-31ã€œS-35 | Config/ãƒ†ã‚¹ãƒˆå„ãƒ•ã‚¡ã‚¤ãƒ« | â­• |

---

### æ¨å¥¨ä½œæ¥­ãƒ•ãƒ­ãƒ¼

```
Phase 1: C-01 â†’ C-02 (C-02ã¯ä¸¦åˆ—å¯ã ãŒã€C-01ã‚’æœ€å„ªå…ˆ)
    â”‚
    â–¼
Phase 2: ãƒãƒƒãƒ A (C-01å®Œäº†å¾Œ) + Bã€œE (ä¸¦åˆ—)
    â”‚
    â–¼
Phase 3: ãƒãƒƒãƒ Fã€œL (å…¨ä¸¦åˆ—å¯ã€Phase 2ã¨åŒæ™‚ã‚‚å¯èƒ½ã ãŒåˆ¥ã‚«ãƒ†ã‚´ãƒª)
    â”‚
    â–¼
Phase 4: ãƒãƒƒãƒ Mã€œT (ãƒ†ã‚¹ãƒˆè¿½åŠ ã€å®Ÿè£…ä¿®æ­£å®Œäº†å¾Œ)
    â”‚
    â–¼
Phase 5: ãƒãƒƒãƒ Uã€œY (Suggestionsã€ä½™è£•ãŒã‚ã‚Œã°)
```

---

### çµ±è¨ˆã‚µãƒãƒª

| åˆ†é¡ | ä»¶æ•° |
|------|------|
| ğŸ”´ Critical Issues | 2 |
| ğŸŸ ğŸŸ¡ Important Issues | 30 |
| ğŸŸ  Test Coverage Gaps | 20 |
| ğŸ’¡ Suggestions | 35 |
| âœ… Positive Observations | 25+ |

---

### é‡è¤‡æ’é™¤ãƒ¡ãƒ¢

ä»¥ä¸‹ã®æŒ‡æ‘˜ã¯è¤‡æ•°ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ¤œå‡ºã•ã‚Œã€çµ±åˆæ™‚ã«é‡è¤‡æ’é™¤:

| çµ±åˆå¾ŒID | å…ƒãƒ¬ãƒ“ãƒ¥ãƒ¼ (é‡è¤‡å…ƒ) |
|---------|-------------------|
| C-01 | 23:09 C-1, 23:27 C-1, 23:31 I-10, Test TC-1 |
| I-05 | 23:27 I-14, 23:09 S-3, 23:31 S-02 |
| I-07 | 23:27 I-3, 23:31 I-10 |
| I-08 | 23:09 I-4, 23:31 I-11 |
| I-11 | 23:27 I-4, 23:09 I-3 |
| I-22 | 23:27 I-1, 23:09 I-6 |
| I-02 | 23:31 I-01, 23:09 S-2 |
| I-17 | 23:31 I-05, 23:09 S-11 |
| S-08 | 23:27 I-15, 23:09 S-8 |

---

*çµ±åˆãƒ¬ãƒ“ãƒ¥ãƒ¼ä½œæˆ: 2026-02-18 23:50 JST*
*çµ±åˆå…ƒ: review-20260218230900.md, review-20260218232734.md, review-20260218233127.md, test-quality-review-20260218.md*
