# PR Review Summary — 2026-02-21 15:14

## レビュー対象ファイル一覧

| # | ファイル | 変更種別 |
|---|---------|---------|
| 1 | `myT-x/app.go` | 変更 |
| 2 | `myT-x/app_devpanel_api.go` | 変更 |
| 3 | `myT-x/app_events.go` | 変更 |
| 4 | `myT-x/app_events_test.go` | 変更 |
| 5 | `myT-x/app_lifecycle.go` | 変更 |
| 6 | `myT-x/app_lifecycle_test.go` | 変更 |
| 7 | `myT-x/app_pane_api_test.go` | 変更 |
| 8 | `myT-x/app_session_api_test.go` | 変更 |
| 9 | `myT-x/internal/tmux/command_router.go` | 変更 |
| 10 | `myT-x/internal/tmux/command_router_env_test.go` | 変更 |
| 11 | `myT-x/internal/tmux/command_router_handlers_session.go` | 変更 |
| 12 | `myT-x/internal/tmux/command_router_handlers_window.go` | 変更 |
| 13 | `myT-x/internal/tmux/command_router_handlers_window_test.go` | 変更 |
| 14 | `myT-x/internal/tmux/session_manager_directional_test.go` | 変更 |
| 15 | `myT-x/internal/tmux/session_manager_pane_io_test.go` | 変更 |
| 16 | `myT-x/internal/tmux/session_manager_test.go` | 変更 |
| 17 | `myT-x/internal/tmux/session_manager_window_test.go` | 変更 |
| 18 | `myT-x/internal/tmux/session_manager_windows.go` | 変更 |
| 19 | `myT-x/internal/sessionlog/handler.go` | **新規追加** |
| 20 | `myT-x/internal/sessionlog/handler_test.go` | **新規追加** |
| 21 | `myT-x/internal/testutil/helpers.go` | **新規追加** |
| 22 | `myT-x/frontend/src/hooks/useBackendSync.ts` | 変更 |
| 23 | `myT-x/frontend/src/hooks/usePrefixKeyMode.ts` | 変更 |
| 24 | `myT-x/frontend/src/hooks/useWindowRename.ts` | **削除** |
| 25 | `myT-x/frontend/src/stores/errorLogStore.ts` | **新規追加** |
| 26 | `myT-x/frontend/src/styles/layout.css` | 変更 |
| 27 | `myT-x/frontend/src/styles/viewer.css` | 変更 |
| 28 | `myT-x/frontend/wailsjs/go/main/App.d.ts` | 変更 |
| 29 | `myT-x/frontend/wailsjs/go/main/App.js` | 変更 |
| 30 | `myT-x/frontend/wailsjs/go/models.ts` | 変更 |

---

## カテゴリA: appレイヤー (app.go, app_*.go)

> レビュアー: subagent-app-layer

### 🔴 クリティカルな問題
*特になし*

### 🟡 重要な問題

#### A-1: コメントの文字化け (Mojibake)
- **[`app_events.go`:143-147]**
  - `snapshotEventPolicies` の `NOTE(1-window model):` コメントに文字化けが発生している箇所が存在する（`迴ｾ蝨ｨ縺ｮ...` の形式）
  - 「1セッション = 1ウィンドウ」という重要な設計方針の解説部分であり、開発者が誤読するリスクがある
  - **対処**: Shift-JIS/EUC-JP として誤認されているため、ファイル全体を UTF-8 として再保存

#### A-2: セッションログファイル名の衝突リスク
- **[`app_session_log.go`:121付近]**
  - セッションログファイルが `session-YYYYMMDD-HHMMSS.jsonl` 形式で命名されているため、1秒以内の再起動時にファイル名が重複する可能性がある
  - **対処**: PID を付与（例: `session-YYYYMMDD-HHMMSS-<PID>.jsonl`）することで一意性を保証

### 🔵 改善提案

#### A-3: 1-windowモデル変更による副作用確認
- **[`app_events.go`:140-150]**
  - `tmux:window-created` の emit が削除されたことによる、フロントエンド側への影響確認が必要
  - 既存セッション（複数ウィンドウ保持）が接続された場合の整合性が保たれているか再確認

#### A-4: `slog.Default()` リストア漏れの可能性
- **[`app_lifecycle_test.go`]**
  - テスト後に `slog.SetDefault()` でリストアするコードが漏れていないか確認
  - 他のテストの実行順序に依存した副作用が発生するリスク

### ✅ 良い点
- **デッドロック回避**: `startup` で `baseHandler` を直接 `TeeHandler` に渡すことで slog mutex によるデッドロックを完璧に回避
- **Windows GUIモード対応**: `safeStderrWriter` による `os.Stderr` プローブでWindowsパニックを防止する優秀な防御的実装
- **O(1) ログ管理**: `sessionLogRingBuffer` による循環バッファで効率的なメモリ使用
- **詳細デバッグログ**: `DevPanelGitStatus` でのdettached HEAD分岐に適切なデバッグログを追加

---

## カテゴリB: コマンドルーター (command_router*.go)

> レビュアー: subagent-router

### 🔴 クリティカルな問題

#### B-1: 設計変更の整合性 — `handleNewWindow` アーキテクチャ変更
- **[`command_router_handlers_window.go`全体]**
  - `handleNewWindow` が tmux の標準挙動（`AddWindow`）を使わず、`CreateSession` によって新しいセッションを作成するよう大幅変更
  - 「1セッション1ウィンドウ」モデルへの意図的な変更であるが、以下の確認が必要:
    1. `tmux:window-created` イベント削除によるクライアント側への影響
    2. 既存のマルチウィンドウを保持する古いセッションへの影響
    3. `AddWindow` API を呼んでいた他の経路（コードベース全体）が存在しないか

### 🟡 重要な問題

#### B-2: スナップショット取得失敗時の処理続行
- **[`command_router_handlers_window.go`:298-302]**
  - セッション作成直後の `GetSession` 取得失敗時に警告ログのみで `nil` のまま続行する
  - 作成直後に見つからないのはシステム上の不整合であり、処理中断（エラーを返す）を検討すべき

```go
// 現状: nil で続行（問題あり）
newSessionSnap, snapOk := r.sessions.GetSession(newSessionName)
if !snapOk {
    newSessionSnap = nil      // ← nil で続行
    slog.Warn("...")
}

// 改善案: エラーで中断またはロールバック
newSessionSnap, snapOk := r.sessions.GetSession(newSessionName)
if !snapOk {
    return rollbackSession("snapshot", fmt.Errorf("session not found after creation: %s", newSessionName))
}
```

#### B-3: `resolveEnvForPaneCreation` への nil 継承環境変数
- **[`command_router_handlers_window.go`:304]**
  - `resolveEnvForPaneCreation` の第3引数 (`inheritedEnv`) に `nil` が渡されている
  - `new-window` は通常、親ペインの環境変数を継承すべきであり、空 `nil` が意図的かどうかコメントで明示すべき

### 🔵 改善提案

#### B-4: テストヘルパーの不統一 — `boolPtr` vs `testutil.Ptr`
- **[`command_router_handlers_window_test.go`:923付近]**
  - テスト用の `boolPtr` ヘルパーがローカルに追加されているが、`command_router_env_test.go` では `testutil.Ptr` を使用するようリファクタリング済み
  - `boolPtr` を `testutil.Ptr[bool]` に統一すること

#### B-5: `new-window` の `-n` フラグの必須化
- **[`command_router_handlers_window.go`:236-238]**
  - 標準 tmux では `-n` (名前) は任意オプションだが、本実装では必須にしている
  - tmux 互換性を意識する場合は自動名生成ロジックの追加または明示的なドキュメント化が必要

#### B-6: 削除テストケースのスキップ対応
- **[`command_router_handlers_window_test.go`]**
  - マルチウィンドウ関連のテストケースが削除されている
  - 将来の再サポートに備えて `t.Skip("1-window model: multi-window not yet supported")` への切り替えを推奨

### ✅ 良い点
- **13ステップコメント付きフロー**: `handleNewWindow` の処理フローが明確にドキュメント化されており保守性高い
- **ロールバック実装**: セッション作成後の失敗時に作成したセッションを確実に削除するロールバックロジック
- **`copySessionFlags` ヘルパー**: フラグ継承ロジックの一元化により修正漏れを防止

---

## カテゴリC: セッションマネージャー (session_manager*.go)

> レビュアー: subagent-session-manager

### 🔴 クリティカルな問題

#### C-1: `AddWindow` メソッドの完全削除
- **[`session_manager_windows.go`]**
  - `AddWindow` メソッドが完全に削除されている
  - セッションに2番目以降のウィンドウを追加する公開APIが存在しなくなった
  - コンパイルエラーまたは機能欠落の可能性が極めて高い
  - **対処**: 1-windowモデルで不要であれば削除を明示的にドキュメント化し、将来のマルチウィンドウサポートのために存在を残すかどうか設計判断を記録すること

#### C-2: テストカバレッジの著しい低下
- **[`session_manager_window_test.go`]**
  - 以下の詳細テストが削除され、簡略化された `TestRemoveWindowByID` にのみ置き換え:
    - `TestRemoveWindowActiveWindowIDAutoTransition` — `ActiveWindowID` の遷移検証
    - `TestResolveDirectionalPane_MultipleWindowScopeIsolation` — ウィンドウ境界越えない invariant 検証
  - **リファクタリング後ロジックの正当性が不十分な検証状態**

### 🟡 重要な問題

#### C-3: 方向別ナビゲーション隔離テストの削除
- **[`session_manager_directional_test.go`]**
  - `TestResolveDirectionalPane_MultipleWindowScopeIsolation` が削除
  - ペイン間の方向移動（DirNext/DirPrev）がウィンドウ境界を越えないという不変条件（Invariant）が無検証

#### C-4: `@stableID` 検証テストの削除
- **[`session_manager_pane_io_test.go`]**
  - `TestListPanesByWindowTargetStableID` が削除
  - `@stableID` 形式のターゲット指定（例: `session:@123`）はインデックス変動環境での安定操作に不可欠であり、検証が失われるリスク大

#### C-5: `ResolveTarget` 修復ロジックテストの削除
- **[`session_manager_test.go`]**
  - `TestResolveTargetRepairsStaleActiveWindowID` が削除
  - 古い `ActiveWindowID` を自動修復する堅牢性保証テストが失われた

#### C-6: `WindowIndexInSession` の削除
- **[`session_manager_windows.go`]**
  - `WindowIndexInSession` が削除
  - `RenameWindowByID` がイベント互換性のためインデックスを返す仕様を維持しているが、単体でインデックスを取得する手段がなくなった

### 🔵 改善提案

#### C-7: `TestRemoveWindowByID` テストケース拡充
- **[`session_manager_window_test.go`:200付近]**
  - 2つ以上のウィンドウを持つセッションから削除した際の `ActiveWindowID` 引き継ぎを検証するケースを追加

#### C-8: Terminal オブジェクトの具体的検証
- **[`session_manager_window_test.go`:230付近]**
  - `TestRemoveWindowByID_RemovedPanesPreserveTerminal` において non-nil 確認だけでなく、ダミー Terminal を注入して結果に含まれることを具体的に検証

### ✅ 良い点
- **IDベースAPIへの統一**: インデックスベース（`RemoveWindow`, `RenameWindow`）から IDベース（`ByID`）への移行は並行処理安全性を高める優れた設計判断
- **入力バリデーション**: `TestRenameWindowByID` に空文字・空白のみの名前拒否と自動トリム仕様をテストで明文化

---

## カテゴリD: セッションログ・テストユーティリティ (sessionlog/, testutil/)

> レビュアー: subagent-sessionlog

### 🔴 クリティカルな問題
*特になし*

### 🟡 重要な問題

#### D-1: ベースハンドラエラー時のコールバック未実行
- **[`internal/sessionlog/handler.go`:52-56]**
  - `h.base.Handle` がエラーを返した場合、callback が実行されずに即座に終了する
  - ディスクフルなどでベースハンドラが失敗した際、UIへのエラー表示などのクリティカルな通知も消失する

```go
// 現状 (問題あり)
func (h *TeeHandler) Handle(ctx context.Context, record slog.Record) error {
    err := h.base.Handle(ctx, record)
    if err != nil {
        return err  // ← callback が呼ばれない
    }
    if h.callback != nil && record.Level >= h.minLevel {
        h.callback(record.Time, record.Level, record.Message, h.group)
    }
    return nil
}

// 改善案: エラー時でもcallbackを実行（一定レベル以上）
func (h *TeeHandler) Handle(ctx context.Context, record slog.Record) error {
    err := h.base.Handle(ctx, record)
    if h.callback != nil && record.Level >= h.minLevel {
        h.callback(record.Time, record.Level, record.Message, h.group)  // エラー有無に関わらず実行
    }
    return err
}
```

### 🔵 改善提案

#### D-2: `EntryCallback` の `source` 引数名の混乱
- **[`internal/sessionlog/handler.go`:13-15]**
  - 引数名 `source` は `slog` パッケージの `slog.Source`（ファイル名・行番号）と混同しやすい
  - `group` または `category` など意味的に明確な名前に変更を推奨

```go
// 変更前
type EntryCallback func(ts time.Time, level slog.Level, msg string, source string)

// 変更後（推奨）
type EntryCallback func(ts time.Time, level slog.Level, msg string, group string)
```

#### D-3: `EntryCallback` の属性情報欠如
- **[`internal/sessionlog/handler.go`:13-15]**
  - 現在の `EntryCallback` はメッセージのみを受け取り `slog.Attr` を受け取れない
  - 構造化ログの属性を通知・分析に活かすため、属性リストも引数に追加することを検討

#### D-4: `WithAttrs` で付与された属性がcallback側で失われる
- **[`internal/sessionlog/handler.go`:67-73]**
  - `WithAttrs` で指定された属性はベースハンドラには反映されるが、TeeHandler 自体が属性を保持しないため callback 呼び出し時には属性コンテキストが失われる
  - callback 側でも属性情報を利用したい場合は `TeeHandler` 構造体で属性を累積保持する必要がある

#### D-5: ベースハンドラエラー時の挙動テストが未記述
- **[`internal/sessionlog/handler_test.go`]**
  - ベースハンドラがエラーを返した場合の callback 呼び出し有無のテストが存在しない
  - 意図した挙動を明文化するテストケースの追加を推奨

### ✅ 良い点
- `slog.Handler` インターフェースの丁寧な実装（`WithGroup`, `WithAttrs` によるイミュータブルなハンドラ生成でスレッドセーフ）
- `handler_test.go` でネストしたグループ結合・nil コールバック安全操作などエッジケースを網羅
- `testutil/helpers.go` の `Ptr[T any]` ジェネリクスヘルパーはシンプルかつ有用

---

## カテゴリE: フロントエンド (hooks/, stores/, styles/, wailsjs/)

> レビュアー: subagent-frontend

### 🔴 クリティカルな問題

> ✅ 追加調査により解消: `asObject` は `../utils/typeGuards` からインポートされており (`handler.go 10行目`)、`typeGuards.ts` ファイルの存在も確認済み。実行時エラーの懸念は解消。

### 🟡 重要な問題

#### E-1: "c" キーバインドの削除によるUX劣化
- **[`frontend/src/hooks/usePrefixKeyMode.ts`]**
  - tmux 標準の "c" キー（`new-window`）のハンドラが完全削除
  - コメントには `NewSessionModal` を使うべきとあるが、ショートカットキーを完全無効化するのではなく、モーダルを開くアクションを割り当てる代替策を検討
  - **tmux互換性を重視するユーザーには重大な操作感の低下**

#### E-2: Wailsjs API の削除（`AddWindow`, `RemoveWindow`, `RenameWindow`）
- **[`frontend/wailsjs/go/main/App.d.ts` / `.js`]**
  - `AddWindow`, `RemoveWindow`, `RenameWindow` が削除されている
  - プロジェクト全体で他コンポーネントから参照されていないか確認が必要

### 🔵 改善提案

#### E-3: `setEntries` の重複排除キー生成のパフォーマンス
- **[`frontend/src/stores/errorLogStore.ts`:38-42]**
  - `deduplicationKey` 関数が全エントリを毎回走査して文字列キーを生成
  - `MAX_ENTRIES = 10,000` と大きく、頻繁な更新で影響が出る可能性
  - Map キャッシュまたはエントリへのハッシュ付与を検討

```typescript
// 現状（毎回全走査）
const deduplicationKey = (e: ErrorLogEntry): string =>
    `${e.ts}|${e.level}|${e.msg}|${e.source}`;
const backendKeys = new Set(incoming.map(deduplicationKey));

// 改善案（Map を利用）
const backendKeys = new Map(incoming.map(e => [deduplicationKey(e), e]));
const liveOnly = state.entries.filter(e => !backendKeys.has(deduplicationKey(e)));
const merged = [...backendKeys.values(), ...liveOnly].slice(-MAX_ENTRIES);
```

#### E-4: `unreadCount` の非直感的リセット
- **[`frontend/src/stores/errorLogStore.ts`:45]**
  - `setEntries`（バックエンドからの全取得時）で一律 `unreadCount = 0` にリセットする
  - ユーザーがエラーログ画面を開いていない状態でバックエンド同期が走った場合、未読数が消える
  - 画面表示状態（Visibility）と連動させるか、明示的な既読アクションを設けることを推奨

#### E-5: CSS変数活用の統一
- **[`frontend/src/styles/viewer.css`]**
  - `.error-log-view` 等の新設スタイルで色は CSS変数を使用しているが、フォントサイズや余白は直値になっている
  - テーマ対応やメンテナンス性向上のため変数化を推奨

### ✅ 良い点
- **[`useBackendSync.ts`]**: `app:error-logged` 購読 → `GetSessionErrorLog()` スナップショット取得の順序によりデータ取りこぼしを防ぐ堅牢な同期ロジック
- **[`layout.css`]**: 不要になった `.window-tab-bar` 関連スタイルが適切に削除されクリーンな状態
- **[`errorLogStore.ts`]**: ts+level+msg+source の複合キーによる高精度な重複排除
- **[`useWindowRename.ts`] 削除**: 参照元コンポーネントでの参照も適切に整理済みを確認

---

## 横断的な指摘事項

### X-1: 1-windowモデルへの移行に伴う "dead code" と到達不能コードの把握
複数箇所で `NOTE(1-window model)` コメントとともに `else` ブランチや `tmux:window-*` イベントが「到達不能コード」として残されている。これは将来のマルチウィンドウ拡張への意図的な備えではあるが:
- 到達不能コードが多いとテストカバレッジ計測が歪む
- 「いつ再有効化するか」のタイムラインをタスクとして記録しておくことを推奨

### X-2: CRLF/LF の混在
- **[`errorLogStore.ts`, `viewer.css`]**
  - `git status` 出力に `CRLF will be replaced by LF` 警告が出ている
  - `.gitattributes` で `* text=auto` または `*.ts text eol=lf` の設定を推奨

### X-3: テスト削除パターンの一貫性
- 複数のテストファイルで「マルチウィンドウ関連テストの削除」が行われているが、削除ではなく `t.Skip` でのスキップの方が:
  1. テスト資産が保持される
  2. 再有効化が容易
  3. レビュー時の意図が明確

---

## Critical Issues 総括 (マージ前に必ず修正)

| ID | 重要度 | カテゴリ | 概要 |
|---|--------|---------|------|
| C-1 | 🔴 Critical | セッションマネージャー | `AddWindow` の完全削除 — 機能欠落の可能性 |
| C-2 | 🔴 Critical | セッションマネージャー | テストカバレッジ著しく低下（重要エッジケース未検証） |
| B-1 | 🔴 Critical | コマンドルーター | `handleNewWindow` アーキテクチャ変更の整合性確認 |

## Important Issues 総括 (できるだけ修正)

| ID | 重要度 | カテゴリ | 概要 |
|---|--------|---------|------|
| A-1 | 🟡 Important | appレイヤー | コメント文字化け |
| A-2 | 🟡 Important | appレイヤー | ログファイル名衝突リスク |
| B-2 | 🟡 Important | コマンドルーター | CreateSession直後スナップショット取得失敗時の処理続行 |
| B-3 | 🟡 Important | コマンドルーター | `inheritedEnv = nil` の意図未明示 |
| C-3 | 🟡 Important | セッションマネージャー | 方向ナビゲーション隔離テスト削除 |
| C-4 | 🟡 Important | セッションマネージャー | `@stableID` 検証テスト削除 |
| C-5 | 🟡 Important | セッションマネージャー | `ResolveTarget` 修復ロジックテスト削除 |
| C-6 | 🟡 Important | セッションマネージャー | `WindowIndexInSession` 削除による影響 |
| D-1 | 🟡 Important | セッションログ | ベースハンドラエラー時のcallback未実行 |
| E-1 | 🟡 Important | フロントエンド | "c" キーバインド削除によるUX劣化 |
| E-2 | 🟡 Important | フロントエンド | Wailsjs API 削除の参照漏れ確認 |

## Suggestions 総括 (Nice to have)

| ID | カテゴリ | 概要 |
|---|---------|------|
| A-3 | appレイヤー | 1-windowモデル変更の副作用確認 |
| A-4 | appレイヤー | テスト後の `slog.Default()` リストア確認 |
| B-4 | コマンドルーター | `boolPtr` → `testutil.Ptr` 統一 |
| B-5 | コマンドルーター | `-n` フラグの必須化とtmux互換性 |
| B-6 | コマンドルーター | テスト削除 → `t.Skip` への切り替え |
| C-7 | セッションマネージャー | `TestRemoveWindowByID` エッジケース拡充 |
| C-8 | セッションマネージャー | Terminal オブジェクトの具体的検証 |
| D-2 | セッションログ | `source` 引数名を `group` に変更 |
| D-3 | セッションログ | `EntryCallback` に属性情報を追加 |
| D-4 | セッションログ | `WithAttrs` 属性の callback 伝播 |
| D-5 | セッションログ | エラー時挙動のテスト追加 |
| E-3 | フロントエンド | 重複排除キー生成のパフォーマンス改善 |
| E-4 | フロントエンド | `unreadCount` リセットタイミングの改善 |
| E-5 | フロントエンド | CSS変数活用の統一 |
| X-1 | 横断 | 到達不能コードの文書化 |
| X-2 | 横断 | CRLF/LF 混在の解消 |
| X-3 | 横断 | テスト削除 → `t.Skip` パターンへ |

---

## タスク並列作業可否表

> 🟢 = 並列作業可能 / 🟡 = 注意（依存あり） / 🔴 = 直列作業推奨

| タスクID | 作業内容 | 対象ファイル | 並列OK? | 作業者へのコメント |
|---------|---------|------------|--------|----------------|
| **C-1** | `AddWindow` の設計判断と復元/削除の明示 | `session_manager_windows.go` | 🔴 | **最優先**。他のタスクが依存する基盤。先に設計方針を確定させること |
| **C-2** | 削除されたエッジケーステストの復元 | `session_manager_window_test.go` | 🟡 | C-1 の完了後に着手。テスト追加のみなので他への影響なし |
| **B-1** | `handleNewWindow` アーキテクチャ変更の影響調査 | `command_router_handlers_window.go`, フロントエンド全体 | 🔴 | C-1 と同時に設計確認。フロントエンドとバックエンドの両エキスパートが連携して確認 |
| **A-1** | コメント文字化けの修正 | `app_events.go` | 🟢 | 単純なテキスト修正。完全に独立しているため即座に並列作業可能 |
| **A-2** | ログファイル名のPID付与 | `app_session_log.go` | 🟢 | 命名規則のみの変更。他への影響なし |
| **B-2** | CreateSession直後スナップショット失敗時のロールバック | `command_router_handlers_window.go` | 🟢 | B-1 の調査結果に依らず修正可能 |
| **B-3** | `nil inheritedEnv` への意図明示コメント | `command_router_handlers_window.go` | 🟢 | コメント追加のみ |
| **B-4** | `boolPtr` → `testutil.Ptr` 統一 | `command_router_handlers_window_test.go` | 🟢 | リファクタリングのみ。機能変更なし |
| **B-6** | テスト削除 → `t.Skip` への切り替え | `command_router_handlers_window_test.go` | 🟢 | 単純な置き換え作業 |
| **C-3** | 方向ナビゲーション隔離テスト復元 | `session_manager_directional_test.go` | 🟢 | `directional_test.go` に限定された追加作業 |
| **C-4** | `@stableID` 検証テスト復元 | `session_manager_pane_io_test.go` | 🟢 | `pane_io_test.go` に限定 |
| **C-5** | `ResolveTarget` 修復ロジックテスト復元 | `session_manager_test.go` | 🟢 | `session_manager_test.go` のみ |
| **D-1** | ベースハンドラエラー時のcallback実行設計 | `internal/sessionlog/handler.go` | 🟢 | 独立したパッケージ。完全に並列可能 |
| **D-2** | `source` → `group` 引数名変更 | `internal/sessionlog/handler.go`, `handler_test.go` | 🟡 | D-1 と並列可能だが同一ファイルのため競合注意。同一担当者に割り当て推奨 |
| **D-5** | エラー時挙動のテスト追加 | `internal/sessionlog/handler_test.go` | 🟡 | D-1 の設計確定後に記述。先に D-1 のポリシーを決めること |
| **E-1** | "c" キーバインドの代替アクション実装 | `frontend/src/hooks/usePrefixKeyMode.ts` | 🟡 | UIの操作設計（NewSessionModal の使い方）の合意が先 |
| **E-2** | Wailsjs 削除 API 参照確認 | プロジェクト全体 (grep) | 🟢 | 調査のみ。コード変更不要の場合も多い |
| **E-3** | `setEntries` パフォーマンス改善 | `frontend/src/stores/errorLogStore.ts` | 🟢 | 独立したストア。完全並列可能 |
| **E-4** | `unreadCount` リセット改善 | `frontend/src/stores/errorLogStore.ts` | 🟡 | E-3 と同一ファイル。同一担当者推奨 |
| **X-1** | 到達不能コードの文書化 | `app_events.go`, `command_router_handlers_window.go` | 🟢 | コメント追加のみ |
| **X-2** | `.gitattributes` CRLF/LF 設定 | `.gitattributes` | 🟢 | 完全独立。即座に作業可能 |
| **X-3** | テスト削除 → `t.Skip` 一括変換 | 全 `*_test.go` | 🟢 | テキスト変換のみ。機能影響なし |

---

## 推奨アクション順序

```
Phase 1 (ブロッカー解消 — 直列):
  └─ C-1: AddWindow 設計判断
  └─ B-1: アーキテクチャ変更の整合性確認

Phase 2 (独立タスク — 完全並列):
  ├─ 担当者A: A-1, A-2, X-1, X-2
  ├─ 担当者B: B-2, B-3, B-4, B-6
  ├─ 担当者C: C-2, C-3, C-4, C-5, X-3
  ├─ 担当者D: D-1, D-2, D-5（D-2はD-1確定後）
  └─ 担当者E: E-2, E-3, E-4（E-1は合意待ち）

Phase 3 (依存解消後):
  └─ E-1: キーバインド代替実装（UI合意後）
```
