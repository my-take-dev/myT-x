# PR ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ

**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ—¥æ™‚:** 2026-02-24 11:21:23  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡:** `myT-x/` é…ä¸‹ ã‚³ãƒŸãƒƒãƒˆå‰å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ« (46ãƒ•ã‚¡ã‚¤ãƒ«)  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ–¹å¼:** ã‚«ãƒ†ã‚´ãƒªåˆ¥ä¸¦åˆ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ (5ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåŒæ™‚å®Ÿè¡Œ)

---

## å¤‰æ›´æ¦‚è¦

| ã‚«ãƒ†ã‚´ãƒª | ãƒ•ã‚¡ã‚¤ãƒ«æ•° | ä¸»ãªå¤‰æ›´å†…å®¹ |
|---------|----------|------------|
| Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ - å…¥åŠ›å±¥æ­´ | 5 | `inputLineBuffer` å‹å¤‰æ›´ (`strings.Builder` â†’ `[]rune`)ã€DCS/SOS/PM/APC ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å¯¾å¿œã€ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚¬ãƒ¼ãƒ‰è¿½åŠ  |
| Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ - ã‚»ãƒƒã‚·ãƒ§ãƒ³/ãƒšã‚¤ãƒ³ API | 6 | `QuickStartSession` æ–°è¦å®Ÿè£…ã€`resolveSessionNameForPane` ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚½ãƒ¼ãƒˆä¿®æ­£ |
| Go å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | 5 | `DefaultSessionDir` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ ã€`testutil.Ptr` çµ±ä¸€ã€ãƒ†ã‚¹ãƒˆOSä¾å­˜å•é¡Œ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ - è¨­å®šç³» | 6 | `defaultSessionDir` è¨­å®šè¿½åŠ ã€ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆä¿®é£¾ã‚­ãƒ¼å¿…é ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç«¶åˆãƒã‚§ãƒƒã‚¯ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ - Viewer System | 7 | `useSyncExternalStore` ã«ã‚ˆã‚‹ãƒãƒƒã‚¸ã‚«ã‚¦ãƒ³ãƒˆæ±ç”¨åŒ–ã€ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆé‡è¤‡æ¤œçŸ¥ã€ä¿®é£¾ã‚­ãƒ¼ã‚¬ãƒ¼ãƒ‰ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ/API/å‹ | 8 | QuickStart ãƒœã‚¿ãƒ³è¿½åŠ ã€ErrorBoundary ãƒªãƒˆãƒ©ã‚¤ä¸Šé™ã€CRLF å•é¡Œ |
| è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ã‚¹ã‚¿ã‚¤ãƒ« | 2 | `config.yaml` è¿½è¨˜ã€CSS è¿½åŠ  |

---

## PR ãƒ¬ãƒ“ãƒ¥ãƒ¼ ã‚µãƒãƒªãƒ¼

### Critical Issues (0ä»¶)

ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ»ãƒ‡ãƒ¼ã‚¿ç ´å£Šãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ç›´çµã™ã‚‹å•é¡Œã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚

---

### Important Issues (8ä»¶)

> âš  ã“ã‚Œã‚‰ã¯ãƒãƒ¼ã‚¸å‰ã«ä¿®æ­£ã™ã‚‹ã“ã¨ã‚’å¼·ãæ¨å¥¨ã—ã¾ã™ã€‚

#### [I-1] `flushLineBuffer` ã® GUARD 2 ãŒ ãƒªãƒ³ã‚°ãƒãƒƒãƒ•ã‚¡ã¸ã®æ›¸ãè¾¼ã¿ã‚‚é®æ–­ã™ã‚‹

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_input_history.go](myT-x/app_input_history.go)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ - å…¥åŠ›å±¥æ­´

**å•é¡Œ:**

```go
// (1) GUARD 1: ãƒ­ãƒƒã‚¯å–å¾—å‰
if gen != 0 && a.shuttingDown.Load() { return }

a.inputLineBufMu.Lock()
lb.buf = lb.buf[:0]   // ãƒãƒƒãƒ•ã‚¡ã‚’ã“ã“ã§ã‚¯ãƒªã‚¢ï¼ˆãƒ‡ãƒ¼ã‚¿èª­ã¿å–ã‚Šæ¸ˆã¿ï¼‰
a.inputLineBufMu.Unlock()

// (2) GUARD 2: ãƒ­ãƒƒã‚¯è§£æ”¾å¾Œ
if gen != 0 && a.shuttingDown.Load() { return }  // â† ã“ã‚ŒãŒã‚ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±

a.writeInputHistoryEntry(...)
```

**ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ã‚·ãƒŠãƒªã‚ª:**
1. GUARD 1 é€šé (shuttingDown=false)
2. ãƒ­ãƒƒã‚¯å–å¾— â†’ `lb.buf` èª­ã¿å–ã‚Šå¾Œã‚¯ãƒªã‚¢
3. ãƒ­ãƒƒã‚¯è§£æ”¾ â†’ ã“ã®ç¬é–“ã« `shutdown()` ãŒ `shuttingDown=true` ã‚’ã‚»ãƒƒãƒˆ
4. `flushAllLineBuffers()` ãŒãƒ­ãƒƒã‚¯å–å¾— â†’ æ—¢ã«ç©ºãƒãƒƒãƒ•ã‚¡ â†’ ä½•ã‚‚ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„
5. **GUARD 2 ãŒ `shuttingDown=true` ã‚’è¦³æ¸¬ â†’ return ã§ã‚¨ãƒ³ãƒˆãƒªå®Œå…¨æ¶ˆå¤±**

`writeInputHistoryEntry` ã¯ç‹¬è‡ªã® nil ã‚¬ãƒ¼ãƒ‰ã‚’æŒã¤ãŸã‚GUARD 2 ã¯ä¸è¦ã§ã™ã€‚

**ä¿®æ­£æ¡ˆ:**

```go
a.inputLineBufMu.Unlock()
// NOTE: No shutdown guard here.
// writeInputHistoryEntry is safe post-shutdown:
//   - file write: guarded by inputHistoryFile != nil
//   - ring buffer: safe to write after shutdown (memory-only)
a.writeInputHistoryEntry(InputHistoryEntry{...})
```

---

#### [I-2] `TestRecordInput_IgnoredDuringShutdown` ãŒ `inputLineBuffers` ã‚’åˆæœŸåŒ–ã—ãªã„

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_input_history_test.go](myT-x/app_input_history_test.go)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ - å…¥åŠ›å±¥æ­´

**å•é¡Œ:** ãƒ†ã‚¹ãƒˆãŒ `recordInput` ã®å®Ÿè£…å†…ã§ `shuttingDown` ãƒã‚§ãƒƒã‚¯ãŒ `inputLineBuffers` ã‚¢ã‚¯ã‚»ã‚¹ã‚ˆã‚Šå‰ã«ã‚ã‚‹ã“ã¨ã«æš—é»™ä¾å­˜ã€‚å®Ÿè£…å¤‰æ›´ã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆã®å‰æãŒå´©ã‚Œã‚‹æã‚ŒãŒã‚ã‚‹ã€‚

**ä¿®æ­£æ¡ˆ:**

```go
a := &App{
    configPath:          "config.yaml",
    inputHistoryEntries: newInputHistoryRingBuffer(inputHistoryMaxEntries),
    inputLineBuffers:    map[string]*inputLineBuffer{}, // æ˜ç¤ºçš„ã«åˆæœŸåŒ–
}
```

---

#### [I-3] `QuickStartSession` ã®ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚»ãƒƒã‚·ãƒ§ãƒ³åå¤‰æ›´ TOCTOU ã‚’æœªã‚«ãƒãƒ¼

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_session_api.go](myT-x/app_session_api.go)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** Go ã‚»ãƒƒã‚·ãƒ§ãƒ³ API

**å•é¡Œ:** ç¾åœ¨ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³æ¶ˆæ»…æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ã‚¹ãƒ«ãƒ¼ã€ã®ã¿ã‚’èª¬æ˜ã—ã¦ã„ã‚‹ãŒã€ã‚»ãƒƒã‚·ãƒ§ãƒ³åå¤‰æ›´ (RenameSession) ã¨ã®ç«¶åˆã‚±ãƒ¼ã‚¹ãŒæœªè¨€åŠã€‚åå‰å¤‰æ›´å¾Œã«ãƒ•ã‚©ãƒ¼ãƒ«ã‚¹ãƒ«ãƒ¼ã™ã‚‹ã¨åŒä¸€ RootPath ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒ2ã¤ä½œã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

**ä¿®æ­£æ¡ˆï¼ˆã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ï¼‰:**

```go
// NOTE: TOCTOU-safe â€” if the session disappears or is renamed between
// findSessionByRootPath and the snapshot loop, we fall through to CreateSession.
// In the rename case, a duplicate RootPath session may be created; this is
// acceptable because rename+QuickStart racing is a user-error scenario.
```

---

#### [I-4] ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ã‚°ã®ã‚½ãƒ¼ãƒˆãƒã‚°ä¿®æ­£ã«ãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã—ãªã„

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_session_log.go](myT-x/app_session_log.go)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** Go ã‚»ãƒƒã‚·ãƒ§ãƒ³ API

**å•é¡Œ:** `return leftOK` â†’ `return !leftOK` ã¯ãƒ­ã‚¸ãƒƒã‚¯åè»¢ï¼ˆãƒã‚°ä¿®æ­£ï¼‰ã ãŒã€malformed ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ··åœ¨ã™ã‚‹ã‚·ãƒŠãƒªã‚ªã‚’æ¤œè¨¼ã™ã‚‹ãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã—ãªã„ã€‚å°†æ¥ã®ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ã‚’æ¤œçŸ¥ã§ããªã„ã€‚

**è¿½åŠ ã™ã¹ããƒ†ã‚¹ãƒˆ:** malformed ãƒ•ã‚¡ã‚¤ãƒ«åãŒ canonical ãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šå…ˆã«å‰Šé™¤ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆã€‚

---

#### [I-5] ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã® OS ä¾å­˜ (`C:\\Users\\test` ãƒ‘ã‚¹)

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/internal/config/config_test.go](myT-x/internal/config/config_test.go)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** Go å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

**å•é¡Œ:** `TestValidateDefaultSessionDir` ç­‰ã§ Windows çµ¶å¯¾ãƒ‘ã‚¹ `C:\\Users\\test\\projects` ã‚’ç›´æ¥ä½¿ç”¨ã€‚Linux ç’°å¢ƒã§ã¯ `filepath.IsAbs("C:\\Users\\test\\projects")` ãŒ `false` ã‚’è¿”ã—ã€ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã€‚

**ä¿®æ­£æ¡ˆ:**

```go
// ãƒ‘ã‚¿ãƒ¼ãƒ³A: OS ã‚¬ãƒ¼ãƒ‰ã‚’è¿½åŠ 
if runtime.GOOS == "windows" {
    cases = append(cases, struct{ name, dir, want string }{
        {name: "absolute path preserved", dir: `C:\Users\test\projects`, want: `C:\Users\test\projects`},
    }...)
}

// ãƒ‘ã‚¿ãƒ¼ãƒ³B: t.TempDir() ã§ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªçµ¶å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨
absDir := t.TempDir()
cases = append(cases, struct{ name, dir, want string }{
    {name: "real temp dir (absolute)", dir: absDir, want: absDir},
})
```

---

#### [I-6] ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨€èªä¸çµ±ä¸€ (è‹±èª/æ—¥æœ¬èªæ··åœ¨)

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/settings/settingsValidation.ts](myT-x/frontend/src/components/settings/settingsValidation.ts)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ è¨­å®šç³»

**å•é¡Œ:** æ—¢å­˜ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã™ã¹ã¦æ—¥æœ¬èªã ãŒã€æ–°è¦è¿½åŠ ã‚¨ãƒ©ãƒ¼ãŒè‹±èªã€‚åŒä¸€ `validationErrors` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«é›†ç´„ã•ã‚Œã¦UIã«è¡¨ç¤ºã•ã‚Œã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹ãˆã‚‹å•é¡Œã¨ãªã‚‹ã€‚

```typescript
// ä¿®æ­£å‰ï¼ˆè‹±èªï¼‰
setShortcutError(viewId, "At least one modifier key is required");
setShortcutError(viewId, "Conflicts with global hotkey");

// ä¿®æ­£å¾Œï¼ˆæ—¥æœ¬èªï¼‰
setShortcutError(viewId, "ä¿®é£¾ã‚­ãƒ¼ï¼ˆCtrl/Shift/Altï¼‰ãŒå¿…è¦ã§ã™");
setShortcutError(viewId, "ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã¨ç«¶åˆã—ã¦ã„ã¾ã™");
```

---

#### [I-7] `QuickStartSession` ã§ã® `SetActiveSession` å‘¼ã³å‡ºã—é †åºãŒé€†è»¢

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/SessionView.tsx](myT-x/frontend/src/components/SessionView.tsx)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**å•é¡Œ:**

```typescript
// ç¾åœ¨ã®å®Ÿè£… - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’å…ˆã«æ›´æ–°
const snapshot = await api.QuickStartSession();
useTmuxStore.getState().setActiveSession(snapshot.name);  // 1) ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ›´æ–°
await api.SetActiveSession(snapshot.name);               // 2) ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç¢ºå®šï¼ˆå¤±æ•—ã—ãŸã‚‰ä¸æ•´åˆï¼‰
```

`api.SetActiveSession` ãŒå¤±æ•—ã—ãŸå ´åˆã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ Store ã¯ã‚»ãƒƒãƒˆæ¸ˆã¿ãªã®ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯æœªåæ˜ ã€‚ã•ã‚‰ã« QuickStartSession ã® conflict path ã§ã¯ Go å´ã§æ—¢ã« `setActiveSessionName` + `tmux:active-session` ã‚¤ãƒ™ãƒ³ãƒˆãŒ emit ã•ã‚Œã‚‹ãŸã‚ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ side ã®æ‰‹å‹• `setActiveSession` ãŒ**äºŒé‡æ›´æ–°**ã«ãªã‚‹ã€‚

**ä¿®æ­£æ¡ˆ:**

```typescript
const snapshot = await api.QuickStartSession();
await api.SetActiveSession(snapshot.name);               // 1) ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç¢ºå®š
useTmuxStore.getState().setActiveSession(snapshot.name); // 2) æˆåŠŸå¾Œã«UIæ›´æ–°
```

---

#### [I-8] `<label>` ã¨ `<input>` ã® id é–¢é€£ä»˜ã‘æ¬ å¦‚

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/settings/GeneralSettings.tsx](myT-x/frontend/src/components/settings/GeneralSettings.tsx)  
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:** ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ è¨­å®šç³»

**å•é¡Œ:** æ–°è¦è¿½åŠ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª `<input>` ã« `id` ãŒãªãã€`<label>` ã« `htmlFor` ã‚‚ãªã„ã€‚ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£é•åï¼ˆåŒãƒ•ã‚¡ã‚¤ãƒ«ã® Quake Mode ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¯æ­£ã—ãè¨­å®šã•ã‚Œã¦ãŠã‚Šã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å­˜åœ¨ã™ã‚‹ï¼‰ã€‚

**ä¿®æ­£æ¡ˆ:**

```tsx
<label className="form-label" htmlFor="default-session-dir">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</label>
<input
  id="default-session-dir"
  className="form-input"
  ...
/>
```

---

### Suggestions (15ä»¶)

> ğŸ’¡ ã“ã‚Œã‚‰ã¯æ”¹å–„ææ¡ˆã§ã™ã€‚å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Šã«æœ‰ç›Šã§ã™ã€‚

#### [S-1] `skipEscString` ã®è¿”ã‚Šå€¤ã®éå¯¾ç§°æ€§ã«ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_input_history.go](myT-x/app_input_history.go)

BELçµ‚ç«¯: `return idx`ï¼ˆBEL ã¯ 1æ–‡å­—ã€å¤–å´ `i++` ã§ consumeï¼‰  
STçµ‚ç«¯: `return idx+1`ï¼ˆST ã¯ 2æ–‡å­—ã€å¤–å´ `i++` ã§ä¸¡æ–¹ consumeï¼‰  
ã“ã®éå¯¾ç§°ãªç†ç”±ã‚’ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¡ãƒ³ãƒˆã§èª¬æ˜ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã€‚

---

#### [S-2] `launchDir` ã¨ `workspace` ã®é–¢ä¿‚ã‚’æ˜ç¤ºã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app.go](myT-x/app.go)

ç¾åœ¨ `launchDir` ã¨ `workspace` ã¯åŒå€¤ã§åˆæœŸåŒ–ã€‚å°†æ¥ `workspace` ãŒå¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ï¼ˆä»®æƒ³ `cd` ç­‰ï¼‰ãŒã‚ã‚‹å ´åˆã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ†é›¢ã®æ„å›³ã‚’ç¤ºã™ã‚³ãƒ¡ãƒ³ãƒˆãŒä¿å®ˆæ€§ã‚’é«˜ã‚ã‚‹ã€‚

```go
launchDir string // cwd captured at startup; stable even if workspace changes later
```

---

#### [S-3] `aktivateCreatedSession` / `QuickStartSession` ã®é‡è¤‡ Snapshot æ¢ç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…±é€šãƒ˜ãƒ«ãƒ‘ãƒ¼åŒ–

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_session_api.go](myT-x/app_session_api.go)

`requireSessions()` + `Snapshot()` + åå‰ã§ç·šå½¢æ¢ç´¢ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒ 3ç®‡æ‰€ã«å­˜åœ¨ã™ã‚‹ã€‚ä»¥ä¸‹ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«æŠ½å‡ºã§ãã‚‹:

```go
func getSnapshotByName(sessions *tmux.SessionManager, name string) (tmux.SessionSnapshot, bool) {
    for _, s := range sessions.Snapshot() {
        if s.Name == name { return s, true }
    }
    return tmux.SessionSnapshot{}, false
}
```

---

#### [S-4] `utf8.RuneCountInString` 2ãƒ‘ã‚¹ã®æ„å›³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜ç¤º

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_session_log.go](myT-x/app_session_log.go)

```go
// Two-pass approach: RuneCountInString avoids []rune allocation for the
// common case (msg within limit). The alloc occurs only when truncation is needed.
if utf8.RuneCountInString(msg) > frontendLogMaxMsgLen {
```

---

#### [S-5] `QuickStartSession` ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ‘ã‚¹ã‚’ `%q` ã§ã‚¯ã‚©ãƒ¼ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/app_session_api.go](myT-x/app_session_api.go)

```go
// ä¿®æ­£å‰
return tmux.SessionSnapshot{}, fmt.Errorf("quick start path is not a directory: %s", dir)

// ä¿®æ­£å¾Œï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚„ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€ãƒ‘ã‚¹ã®è¨ºæ–­ã‚’å®¹æ˜“ã«ï¼‰
return tmux.SessionSnapshot{}, fmt.Errorf("quick start path is not a directory: %q", dir)
```

---

#### [S-6] `TestValidateDefaultSessionDir` ã« `t.TempDir()` ã‚’ä½¿ã£ãŸãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªçµ¶å¯¾ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/internal/config/config_test.go](myT-x/internal/config/config_test.go)

OS éä¾å­˜ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã¨ã—ã¦ `t.TempDir()` ãŒè¿”ã™å®Ÿéš›ã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Windows/Linux åŒæ–¹ã§å‹•ä½œã™ã‚‹ãƒ†ã‚¹ãƒˆã«ãªã‚‹ã€‚

---

#### [S-7] `validateViewerShortcuts` ã® `normalizeShortcut` äºŒé‡å‘¼ã³å‡ºã—ã‚’å‰Šæ¸›

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/settings/settingsValidation.ts](myT-x/frontend/src/components/settings/settingsValidation.ts)

`getEffectiveViewerShortcut` ã¯æ—¢ã«æ­£è¦åŒ–æ¸ˆã¿ã®æ–‡å­—åˆ—ã‚’è¿”ã™ã€‚`hasShortcutModifier` å†…ã§ã®æ­£è¦åŒ–ã¨ã€ãã®ç›´å¾Œã® `const normalized = normalizeShortcut(effectiveShortcut)` ã¯å†—é•·ã€‚

---

#### [S-8] ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã®ç«¶åˆãƒ†ã‚¹ãƒˆè¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/tests/settingsValidation.test.ts](myT-x/frontend/tests/settingsValidation.test.ts)

```typescript
it("rejects conflict with global hotkey matching a viewer default shortcut", () => {
    const errors = validateViewerShortcuts({}, "Ctrl+Shift+E"); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨åŒå€¤
    expect(errors).toHaveProperty("viewer_shortcut_file-tree");
});
```

---

#### [S-9] `hasShortcutModifier` ã®åˆ°é”ä¸èƒ½ã‚³ãƒ¼ãƒ‰ã‚’æ•´ç†

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/viewer/viewerShortcutUtils.ts](myT-x/frontend/src/components/viewer/viewerShortcutUtils.ts)

```typescript
if (!keyToken) return false;           // åˆ°é”ä¸èƒ½ (æ­£è¦åŒ–æ¸ˆã¿ã§ length â‰¥ 2)
return modifierTokens.length > 0;     // å¸¸ã« true (length â‰¥ 2 ä¿è¨¼æ¸ˆã¿)
```

æ•´ç†å¾Œ:

```typescript
export function hasShortcutModifier(shortcut: string): boolean {
    const normalized = normalizeShortcut(shortcut);
    if (normalized === "") return false;
    const tokens = normalized.split("+");
    return tokens.length >= 2;  // modifier + key ã®2ãƒˆãƒ¼ã‚¯ãƒ³ä»¥ä¸Šãªã‚‰OK
}
```

---

#### [S-10] `ViewerSystem` ã® `shortcutMap` ã§ `normalizeShortcut` ä¸‰é‡å‘¼ã³å‡ºã—ã‚’å‰Šæ¸›

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/viewer/ViewerSystem.tsx](myT-x/frontend/src/components/viewer/ViewerSystem.tsx)

`getEffectiveViewerShortcut` ã®æˆ»ã‚Šå€¤ã¯æ­£è¦åŒ–æ¸ˆã¿ã®ãŸã‚ã€`const normalized = normalizeShortcut(effectiveShortcut)` ã¯å†—é•·ã€‚`effectiveShortcut` ã‚’ãã®ã¾ã¾ map key ã«ä½¿ç”¨ã§ãã‚‹ã€‚

---

#### [S-11] `ActivityStrip` ã® `useSyncExternalStore` ç¬¬3å¼•æ•°ã‚’çœç•¥

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/viewer/ActivityStrip.tsx](myT-x/frontend/src/components/viewer/ActivityStrip.tsx)

Wails ã¯ SSR ã‚’ä½¿ç”¨ã—ãªã„ãŸã‚ç¬¬3å¼•æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆé–¢æ•°ã¯ä¸è¦:

```typescript
const badgeCount = useSyncExternalStore(subscribeBadge, getBadgeCount); // ç¬¬3å¼•æ•°çœç•¥
```

---

#### [S-12] badge API ã®å…±é€šãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’æŠ½å‡º

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/viewer/views/error-log/index.ts](myT-x/frontend/src/components/viewer/views/error-log/index.ts), [input-history/index.ts](myT-x/frontend/src/components/viewer/views/input-history/index.ts)

ä¸¡ãƒ•ã‚¡ã‚¤ãƒ«ã§å®Œå…¨ã«åŒä¸€ã® `getBadgeCount` / `subscribeBadgeCount` ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚å…±é€šãƒ˜ãƒ«ãƒ‘ãƒ¼ã¨ã—ã¦æŠ½å‡ºã§ãã‚‹:

```typescript
export function makeUnreadBadgeAPI(store: { getState: () => { unreadCount: number }; subscribe: (...) }) {
    return {
        getBadgeCount: () => store.getState().unreadCount,
        subscribeBadgeCount: (listener: () => void) =>
            store.subscribe((state, prevState) => {
                if (state.unreadCount !== prevState.unreadCount) listener();
            }),
    };
}
```

---

#### [S-13] `ActivityButton` ã« `React.memo` ã‚’é©ç”¨ã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/viewer/ActivityStrip.tsx](myT-x/frontend/src/components/viewer/ActivityStrip.tsx)

`activeViewId` å¤‰åŒ–æ™‚ã«å…¨ã¦ã® `ActivityButton` ãŒå†ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ãŒã€éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒœã‚¿ãƒ³ã¯å¤‰æ›´ãªã—ã€‚`React.memo` ã§æœ€é©åŒ–å¯èƒ½ã€‚

---

#### [S-14] `ErrorBoundary` ãƒªãƒˆãƒ©ã‚¤ä¸Šé™åˆ°é”å¾Œã® UX æ”¹å–„

**ãƒ•ã‚¡ã‚¤ãƒ«:** [myT-x/frontend/src/components/ErrorBoundary.tsx](myT-x/frontend/src/components/ErrorBoundary.tsx)

1. `retryCount` ãŒæˆåŠŸãƒªãƒˆãƒ©ã‚¤ã‚’ã¾ãŸã„ã§ãƒªã‚»ãƒƒãƒˆã•ã‚Œãªã„ãŸã‚ã€3å›æˆåŠŸå¾Œã«4å›ç›®ã®ã‚¨ãƒ©ãƒ¼ã§å³ disabled ã«ãªã‚‹è¨­è¨ˆæ„å›³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜ç¤ºã™ã‚‹ã“ã¨
2. ä¸Šé™åˆ°é”æ™‚ã®ãƒœã‚¿ãƒ³ã« `title="æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°ã«é”ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚"` ã‚’è¿½åŠ ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¡ˆå†…

---

#### [S-15] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã® CRLF å•é¡Œã‚’ `.gitattributes` ã§è§£æ±º

**å¯¾è±¡:** `GeneralSettings.tsx`, `ActivityStrip.tsx`, `viewerRegistry.ts`, `InputHistoryView.tsx`, `useInputHistory.ts`, `inputHistoryStore.ts`

git ãŒ CRLF ã‚’ LF ã«å¤‰æ›ã™ã‚‹è­¦å‘ŠãŒå‡ºã¦ã„ã‚‹ã€‚`.gitattributes` ã§çµ±ä¸€:

```gitattributes
*.ts    text eol=lf
*.tsx   text eol=lf
*.css   text eol=lf
*.go    text eol=lf
```

---

### Strengths (è‰¯ã„ç‚¹)

#### Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

- **`[]rune` ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**: `strings.Builder` + åˆ¥ç«‹ã¦ `runes` ã‚«ã‚¦ãƒ³ã‚¿ã‚’ `[]rune` ä¸€æœ¬ã«æ•´ç†ã€‚ãƒãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¹å‡¦ç†ãŒ `lb.buf[:len(lb.buf)-1]` ã® O(1) æ“ä½œã«ãªã‚Šã€æ—§ã‚³ãƒ¼ãƒ‰ã®ã€ŒBuilderâ†’[]runeå¤‰æ›â†’æœ«å°¾å‰Šé™¤â†’Builderå†æ›¸ãè¾¼ã¿ã€ã¨ã„ã†å†—é•·ã•ã‚’å®Œå…¨æ’é™¤
- **`skipEscString` ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£**: OSC ã¨ DCS/SOS/PM/APC ã® ST/BEL ã‚¹ã‚­ãƒƒãƒ—ãƒ­ã‚¸ãƒƒã‚¯ã‚’ `allowBEL bool` 1ã¤ã§çµ±ä¸€ã— DRY åŸå‰‡ã‚’éµå®ˆ
- **DCS/SOS/PM/APC å¯¾å¿œè¿½åŠ **: tmux ãŒå¤šç”¨ã™ã‚‹ DCS (`\x1bP`) ç­‰ã®æœªå‡¦ç†ãƒã‚°ä¿®æ­£ã€‚ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ãŒãƒ‘ãƒ¼ã‚¹æ¸ˆã¿ã‚´ãƒŸæ–‡å­—ã¨ã—ã¦å…¥åŠ›å±¥æ­´ã«æ¼ã‚Œã‚‹å•é¡Œã‚’è§£æ±º
- **gen=0 ã‚»ãƒ³ãƒãƒãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³**: ã‚¿ã‚¤ãƒãƒ¼èµ·å› ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã¨ shutdown èµ·å› ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚’ä¸–ä»£ã‚«ã‚¦ãƒ³ã‚¿1ã¤ã§åŒºåˆ¥ã™ã‚‹è¨­è¨ˆã¯ç°¡æ½”ã‹ã¤å …ç‰¢
- **ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³å¢ƒç•Œãƒ†ã‚¹ãƒˆã®å……å®Ÿ**: `TestFlushLineBuffer_IgnoresTimerFlushDuringShutdown` ã¨ `TestFlushLineBuffer_ShutdownSentinelStillFlushes` ã®2ãƒ†ã‚¹ãƒˆã§ã‚»ãƒ³ãƒãƒãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ååˆ†ã«æ¤œè¨¼
- **`testutil.Ptr` çµ±ä¸€**: ãƒ­ãƒ¼ã‚«ãƒ«ã® `boolPtrTest` ã‚’å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å‰Šé™¤ã— `testutil.Ptr` ã«ä¸€å…ƒåŒ–ã€‚é‡è¤‡ã—ãŸ `//go:fix inline` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚‚ä¿®æ­£
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ã‚°ã®ã‚½ãƒ¼ãƒˆãƒã‚°ä¿®æ­£ã‚³ãƒ¡ãƒ³ãƒˆãŒæ­£ç¢º**: `return !leftOK` ã®å¤‰æ›´ã«ä»˜ã‘ãŸã€ŒPrefer trimming malformed/non-canonical files before canonical onesã€ã¯ less é–¢æ•°ã®æ„å‘³è«–ã¨å®Œå…¨ã«æ•´åˆ
- **ãƒ†ã‚¹ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªéš”é›¢**: `configPath: "config.yaml"` â†’ `filepath.Join(t.TempDir(), "config.yaml")` ã¨ `defer file.Close()` ã§å®Ÿãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜ã‚’æ’é™¤

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- **`useSyncExternalStore` ã®é©åˆ‡ãªé©ç”¨**: `subscribe`/`getSnapshot` ã®åˆ†é›¢ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«å®šæ•°ã«ã‚ˆã‚‹å®‰å®šå‚ç…§ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã§ã®ç‹¬ç«‹ subscription ãŒå…¨ã¦æ­£ã—ã„
- **`EMPTY_SUBSCRIBE` / `ZERO_BADGE` å®šæ•°**: ãƒ¬ãƒ³ãƒ€ãƒ¼æ¯ã®å†ç”Ÿæˆã‚’é˜²ããƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«å®šæ•°å®šç¾©
- **ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰æ’é™¤**: `view.id === "error-log"` ãƒã‚§ãƒƒã‚¯ã‚’ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ã«ç½®ãæ›ãˆãŸè¨­è¨ˆæ”¹å–„
- **`latestEntrySeq` ã«ã‚ˆã‚‹ `useLayoutEffect` æœ€é©åŒ–**: `entries` å…¨ä½“ã§ãªãæœ€å¾Œã® seq ç•ªå·ã®ã¿ deps ã«æŒ‡å®šã—ä½™åˆ†ãª `markAllRead` å‘¼ã³å‡ºã—ã‚’é˜²æ­¢
- **`setShortcutError` ã® first-wins ãƒãƒªã‚·ãƒ¼**: modifier ãƒã‚§ãƒƒã‚¯ãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç«¶åˆãƒ»é‡è¤‡ã®3ç¨®ã‚¨ãƒ©ãƒ¼å„ªå…ˆåº¦ãŒä¸€ãƒ˜ãƒ«ãƒ‘ãƒ¼ã§çµ±ä¸€çš„ã«æ‹…ä¿
- **ä¿å­˜æ™‚ã®æ­£è¦åŒ–é©ç”¨**: `normalizeShortcut(value.trim())` ã‚’ map æ™‚ã«é©ç”¨ã—ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«å¸¸ã«æ­£è¦åŒ–æ¸ˆã¿ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãŒä¿å­˜ã•ã‚Œã‚‹
- **`try-catch-finally` ã®æ­£ç¢ºãªä½¿ç”¨**: QuickStart ãƒãƒ³ãƒ‰ãƒ©ãŒ `finally` ã§ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ç¢ºå®Ÿã«è§£é™¤
- **`type="button"` ã®æ˜ç¤º**: QuickStart ãƒœã‚¿ãƒ³ã« `type="button"` ã‚’æ˜ç¤ºã—æ„å›³ã—ãªã„ãƒ•ã‚©ãƒ¼ãƒ ã‚µãƒ–ãƒŸãƒƒãƒˆã‚’é˜²æ­¢

---

## ã‚¿ã‚¹ã‚¯ä¸€è¦§ã¨ä¸¦åˆ—ä½œæ¥­å¯å¦

> ä½œæ¥­è€…ãŒä¿®æ­£ã«å–ã‚Šçµ„ã‚€éš›ã®ä¸¦åˆ—å®Ÿè¡Œå¯å¦ã‚’ç¤ºã™è¡¨ã§ã™ã€‚ä¾å­˜é–¢ä¿‚ãŒãªã„é …ç›®ã¯åŒæ™‚ã«ä½œæ¥­å¯èƒ½ã§ã™ã€‚

### å‡¡ä¾‹

| ãƒãƒ¼ã‚¯ | æ„å‘³ |
|-------|-----|
| âœ… ä¸¦åˆ—OK | ä»–ã®ä½œæ¥­ã«ä¾å­˜ã—ãªã„ã€‚åŒæ™‚é€²è¡Œå¯èƒ½ |
| âš  é †æ¬¡ | åˆ¥ã‚¿ã‚¹ã‚¯ã®å®Œäº†å¾Œã«ä½œæ¥­ |
| ğŸ”§ è¦èª¿æŸ» | å½±éŸ¿ç¯„å›²ãŒåºƒã„ãŸã‚äº‹å‰ç¢ºèªãŒå¿…è¦ |

---

### Important Issues ä¿®æ­£ã‚¿ã‚¹ã‚¯è¡¨

| # | ã‚¿ã‚¹ã‚¯ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« | å„ªå…ˆåº¦ | ä¸¦åˆ—å¯å¦ | å‚™è€ƒ |
|---|--------|------------|--------|---------|------|
| I-1 | `flushLineBuffer` ã® GUARD 2 ã‚’å‰Šé™¤ | `app_input_history.go` | ğŸ”´ é«˜ | âœ… ä¸¦åˆ—OK | ä»–ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å½±éŸ¿ãªã—ã€‚ãƒ­ã‚¸ãƒƒã‚¯å¤‰æ›´ã®ãŸã‚æ—¢å­˜ãƒ†ã‚¹ãƒˆå†å®Ÿè¡Œã‚’å¿˜ã‚Œãšã« |
| I-2 | `TestRecordInput_IgnoredDuringShutdown` ã« `inputLineBuffers` åˆæœŸåŒ–è¿½åŠ  | `app_input_history_test.go` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | I-1 ã¨ã¯ç‹¬ç«‹ã€‚ãƒ†ã‚¹ãƒˆã®ã¿ã®å¤‰æ›´ |
| I-3 | `QuickStartSession` ã® TOCTOU ã‚³ãƒ¡ãƒ³ãƒˆè£œè¶³ | `app_session_api.go` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã®ã¿ã€‚å‹•ä½œå¤‰æ›´ãªã— |
| I-4 | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‚½ãƒ¼ãƒˆä¿®æ­£ã®ãƒ†ã‚¹ãƒˆè¿½åŠ  | `app_session_log_test.go` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | ãƒ†ã‚¹ãƒˆè¿½åŠ ã®ã¿ã€‚æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¸ã®å½±éŸ¿ãªã— |
| I-5 | ãƒ†ã‚¹ãƒˆã® OS ä¾å­˜ãƒ‘ã‚¹ã‚’ä¿®æ­£ | `internal/config/config_test.go` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | `runtime.GOOS` ã‚¬ãƒ¼ãƒ‰ã¾ãŸã¯ `t.TempDir()` ä½¿ç”¨ |
| I-6 | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ—¥æœ¬èªåŒ– | `frontend/src/components/settings/settingsValidation.ts` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | æ–‡å­—åˆ—å®šæ•°ã®å¤‰æ›´ã®ã¿ã€‚ãƒ†ã‚¹ãƒˆ (`settingsValidation.test.ts`) ã®æœŸå¾…å€¤ã‚‚æ›´æ–°ãŒå¿…è¦ |
| I-7 | `SetActiveSession` å‘¼ã³å‡ºã—é †åºã‚’ä¿®æ­£ | `frontend/src/components/SessionView.tsx` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | I-6 ã¨ç‹¬ç«‹ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿ã®å¤‰æ›´ |
| I-8 | `<label>` ã« `htmlFor`ã€`<input>` ã« `id` ã‚’è¿½åŠ  | `frontend/src/components/settings/GeneralSettings.tsx` | ğŸŸ¡ ä¸­ | âœ… ä¸¦åˆ—OK | ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ä¿®æ­£ã®ã¿ |

**â†’ I-1ã€œI-8 ã¯å…¨ã¦ç›¸äº’ã«ç‹¬ç«‹ã—ã¦ãŠã‚Šã€å…¨ã‚¿ã‚¹ã‚¯ã‚’ä¸¦åˆ—ã§ä½œæ¥­å¯èƒ½ã§ã™ã€‚**

---

### Suggestions ä¿®æ­£ã‚¿ã‚¹ã‚¯è¡¨

| # | ã‚¿ã‚¹ã‚¯ | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« | å„ªå…ˆåº¦ | ä¸¦åˆ—å¯å¦ | å‚™è€ƒ |
|---|--------|------------|--------|---------|------|
| S-1 | `skipEscString` è¿”ã‚Šå€¤ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  | `app_input_history.go` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | I-1 ã¨åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã®ãŸã‚åŒæ™‚ç·¨é›†æ™‚ã®æ³¨æ„ãŒå¿…è¦ |
| S-2 | `launchDir` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  | `app.go` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã®ã¿ |
| S-3 | `getSnapshotByName` ãƒ˜ãƒ«ãƒ‘ãƒ¼æŠ½å‡º | `app_session_api.go` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | I-3 ã¨åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã€‚äº‹å‰ã« I-3 ã‚’å®Œäº†æ¨å¥¨ |
| S-4 | `utf8.RuneCountInString` ã«ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  | `app_session_log.go` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã®ã¿ |
| S-5 | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã® `%s` â†’ `%q` å¤‰æ›´ | `app_session_api.go` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | S-3 ã¨åŒã˜ãƒ•ã‚¡ã‚¤ãƒ« |
| S-6 | ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ  | `internal/config/config_test.go` | ğŸŸ¢ ä½ | âš  é †æ¬¡ | I-5 ã®å®Œäº†å¾Œã«ä½œæ¥­æ¨å¥¨ |
| S-7 | `normalizeShortcut` äºŒé‡å‘¼ã³å‡ºã—ã‚’å‰Šæ¸› | `settingsValidation.ts` | ğŸŸ¢ ä½ | âš  é †æ¬¡ | I-6 ã®å®Œäº†å¾Œã«ä½œæ¥­æ¨å¥¨ï¼ˆåŒãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ |
| S-8 | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆç«¶åˆãƒ†ã‚¹ãƒˆè¿½åŠ  | `settingsValidation.test.ts` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | I-6 ã¨ç‹¬ç«‹ï¼ˆåˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ |
| S-9 | `hasShortcutModifier` åˆ°é”ä¸èƒ½ã‚³ãƒ¼ãƒ‰ã‚’æ•´ç† | `viewerShortcutUtils.ts` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ä»–ãƒ•ã‚¡ã‚¤ãƒ«ã«å½±éŸ¿ãªã— |
| S-10 | `shortcutMap` ã® `normalizeShortcut` ä¸‰é‡å‘¼ã³å‡ºã—ã‚’å‰Šæ¸› | `ViewerSystem.tsx` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ä»–ãƒ•ã‚¡ã‚¤ãƒ«ã«å½±éŸ¿ãªã— |
| S-11 | `useSyncExternalStore` ç¬¬3å¼•æ•°çœç•¥ | `ActivityStrip.tsx` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ä»–ãƒ•ã‚¡ã‚¤ãƒ«ã«å½±éŸ¿ãªã— |
| S-12 | `makeUnreadBadgeAPI` ãƒ˜ãƒ«ãƒ‘ãƒ¼æŠ½å‡º | `error-log/index.ts`, `input-history/index.ts` | ğŸŸ¢ ä½ | ğŸ”§ è¦èª¿æŸ» | æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãŒå¿…è¦ã€‚æ–°ãƒ˜ãƒ«ãƒ‘ãƒ¼ã®é…ç½®å ´æ‰€ã‚’äº‹å‰æ±ºå®šã™ã‚‹ã“ã¨ |
| S-13 | `ActivityButton` ã« `React.memo` é©ç”¨ | `ActivityStrip.tsx` | ğŸŸ¢ ä½ | âš  é †æ¬¡ | S-11 å®Œäº†å¾Œï¼ˆåŒãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã€‚`toggleView` ã®å‚ç…§å®‰å®šæ€§ã‚’ç¢ºèªã™ã‚‹ã“ã¨ |
| S-14 | `ErrorBoundary` UX æ”¹å–„ (`title` å±æ€§ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆ) | `ErrorBoundary.tsx` | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ä»–ãƒ•ã‚¡ã‚¤ãƒ«ã«å½±éŸ¿ãªã— |
| S-15 | `.gitattributes` ã§ãƒ•ã‚¡ã‚¤ãƒ«ã® CRLF å•é¡Œã‚’è§£æ±º | `.gitattributes` (æ–°è¦) | ğŸŸ¢ ä½ | âœ… ä¸¦åˆ—OK | ãƒªãƒã‚¸ãƒˆãƒªãƒ«ãƒ¼ãƒˆã«è¿½åŠ  |

---

### ä¸¦åˆ—ä½œæ¥­ã‚°ãƒ«ãƒ¼ãƒ—æ¨å¥¨

```
ä½œæ¥­è€…A (Go ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ‹…å½“):
  I-1 (app_input_history.go)
  I-2 (app_input_history_test.go)
  I-3, S-3, S-5 (app_session_api.go)
  I-4, S-4  (app_session_log / app_session_log_test.go)

ä½œæ¥­è€…B (Go ãƒ†ã‚¹ãƒˆæ‹…å½“):
  I-5, S-6  (internal/config/config_test.go)
  S-2       (app.go ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ )
  S-1       (app_input_history.go ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  - Aå®Œäº†å¾Œ)

ä½œæ¥­è€…C (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ‹…å½“):
  I-6, S-7  (settingsValidation.ts)
  I-7       (SessionView.tsx)
  I-8       (GeneralSettings.tsx)
  S-8       (settingsValidation.test.ts)
  S-9       (viewerShortcutUtils.ts)
  S-10      (ViewerSystem.tsx)
  S-11, S-13 (ActivityStrip.tsx)
  S-12      (badge API ãƒ˜ãƒ«ãƒ‘ãƒ¼æŠ½å‡º)
  S-14      (ErrorBoundary.tsx)
  S-15      (.gitattributes)
```

> **æ³¨æ„:** ä½œæ¥­è€… A ã¨ B ã¯ `app_session_api.go` ã‚’åŒæ™‚ç·¨é›†ã—ãªã„ã‚ˆã†æ³¨æ„ã—ã¦ãã ã•ã„ï¼ˆI-3 / S-3 / S-5 ã¯åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã€‚

---

## ä¿®æ­£ã®å½±éŸ¿ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ä¿®æ­£å¾Œã¯ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:

- [ ] `go test ./myT-x/... -v` ãŒå…¨ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ (I-1, I-2, I-4 ä¿®æ­£å¾Œ)
- [ ] `go test ./myT-x/internal/config/... -v` ãŒå…¨ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ (I-5 ä¿®æ­£å¾Œ)
- [ ] `npm test` ã¾ãŸã¯ `vitest run` ãŒå…¨ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ (I-6, S-8 ä¿®æ­£å¾Œ)
- [ ] `go build ./myT-x/...` ãŒã‚¨ãƒ©ãƒ¼ãªããƒ“ãƒ«ãƒ‰ã§ãã‚‹ã“ã¨ (å…¨ Go ä¿®æ­£å¾Œ)
- [ ] `settingsValidation.test.ts` ã®æœŸå¾…å€¤ãŒ I-6 ã®æ—¥æœ¬èªåŒ–ã¨ä¸€è‡´ã™ã‚‹ã“ã¨
