# PR Review â€” 2026-02-24 12:57:31

## ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡

ã‚³ãƒŸãƒƒãƒˆå‰ã® `myT-x/` é…ä¸‹ã®å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ51ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’7ã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡ã—ã€ä¸¦åˆ—ã§æ·±ãå…¥å¿µãªãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã—ãŸã€‚

---

## å¤‰æ›´æ¦‚è¦

| ã‚«ãƒ†ã‚´ãƒª | ä¸»ãªå¤‰æ›´å†…å®¹ |
|---|---|
| A: Goãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ã‚¢ | `launchDir`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ ã€`inputLineBuffers`åˆæœŸåŒ–ã€ãƒ­ã‚°ã‚½ãƒ¼ãƒˆãƒã‚°ä¿®æ­£ã€UTF-8æœ€é©åŒ– |
| B: Goå…¥åŠ›å±¥æ­´ãƒ»ãƒšã‚¤ãƒ³API | `[]rune`ãƒãƒƒãƒ•ã‚¡ã¸ã®å¤‰æ›´ã€DCS/SOS/PM/APCã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†è¿½åŠ ã€ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚¬ãƒ¼ãƒ‰ |
| C: Goã‚»ãƒƒã‚·ãƒ§ãƒ³API | `QuickStartSession`æ–°è¦å®Ÿè£…ã€`testutil.Ptr`ã¸ã®çµ±ä¸€ |
| D: Goå†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | `DefaultSessionDir`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹é™¤å» |
| E: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­å®š | ãƒ“ãƒ¥ãƒ¼ã‚¢ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæ¤œè¨¼å¼·åŒ–ã€`defaultSessionDir` UIè¿½åŠ ã€Meta/Fã‚­ãƒ¼å¯¾å¿œ |
| F: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ | `useSyncExternalStore`ã«ã‚ˆã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é§†å‹•ãƒãƒƒã‚¸ã€ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆä¿®é£¾ã‚­ãƒ¼å¼·åˆ¶ |
| G: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | `QuickStart`ãƒœã‚¿ãƒ³ã€`ErrorBoundary`ãƒªãƒˆãƒ©ã‚¤åˆ¶é™ã€async/awaitä¿®æ­£ |

---

## Critical Issuesï¼ˆä¿®æ­£å¿…é ˆï¼‰

### ğŸ”´ C1 â€” [app_session_api.go] QuickStartSession: æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³æ´»æ€§åŒ–ãƒ‘ã‚¹ã§ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãŒç™ºè¡Œã•ã‚Œãªã„

**é‡è¦åº¦:** ä¿®æ­£å¿…é ˆ / **å½±éŸ¿:** UIã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¹ãƒˆãƒ»ã‚µã‚¤ãƒ‰ãƒãƒ¼ãŒæ›´æ–°ã•ã‚Œãªã„

`QuickStartSession` ã® `conflict` ãƒ‘ã‚¹ï¼ˆæ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æ´»æ€§åŒ–ã—ã¦è¿”ã™åˆ†å²ï¼‰ã§ã¯ `requestSnapshot(true)` ãŒå‘¼ã°ã‚Œã¦ã„ãªã„ã€‚  
`CreateSession` ãƒ‘ã‚¹ã¯ `defer` ã§ç¢ºå®Ÿã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ç™ºè¡Œã™ã‚‹ãŒã€ã“ã®ãƒ‘ã‚¹ã ã‘ãŒæ¼ã‚Œã¦ã„ã‚‹ã€‚  
çµæœã¨ã—ã¦ `setActiveSessionName` ã§ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãŒå¤‰ã‚ã£ã¦ã‚‚ã€**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®UIï¼ˆã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¹ãƒˆï¼‰ã«åæ˜ ã•ã‚Œãªã„**ã€‚

```go
// å•é¡Œç®‡æ‰€ (app_session_api.go ~L74-L84)
if s.Name == conflict {
    a.setActiveSessionName(conflict)
    a.emitBackendEvent("tmux:active-session", map[string]any{"name": conflict})
    // â† a.requestSnapshot(true) ãŒæ¬ è½
    return s, nil
}
```

**ä¿®æ­£:**
```go
if s.Name == conflict {
    a.setActiveSessionName(conflict)
    a.emitBackendEvent("tmux:active-session", map[string]any{"name": conflict})
    a.requestSnapshot(true)  // è¿½åŠ å¿…é ˆ
    return s, nil
}
```

---

### ğŸ”´ C2 â€” [app_session_api.go] QuickStartSession: å˜ä½“ãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã—ãªã„

**é‡è¦åº¦:** ä¿®æ­£å¿…é ˆ / **å½±éŸ¿:** ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ã®æ¤œçŸ¥ä¸èƒ½

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦ç´„ã€Œæ–°è¦å…¬é–‹é–¢æ•°ã«ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆï¼ˆæ­£å¸¸ç³»+ç•°å¸¸ç³»ï¼‰ã€ã¸ã®å®Œå…¨é•åã€‚  
ä»¥ä¸‹ã®å…¨ã‚±ãƒ¼ã‚¹ãŒæœªã‚«ãƒãƒ¼:

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | ãƒªã‚¹ã‚¯ |
|---|---|
| `DefaultSessionDir` è¨­å®šæ™‚ã®å„ªå…ˆé †ä½ | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯ãŒå£Šã‚Œã¦ã‚‚æ°—ã¥ã‘ãªã„ |
| `launchDir` ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‹•ä½œ | ç©ºè¨­å®šæ™‚ã®æŒ™å‹•ãŒä¸æ˜ |
| ä¸¡æ–¹ç©ºã®ã¨ãã®ã‚¨ãƒ©ãƒ¼ | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¤‰æ›´ã«æ°—ã¥ã‘ãªã„ |
| å­˜åœ¨ã—ãªã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã®ã‚¨ãƒ©ãƒ¼ | `os.Stat` ã‚¨ãƒ©ãƒ¼ä¼æ’­ã®ç¢ºèªãŒã§ããªã„ |
| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ãŸã¨ãã®ã‚¨ãƒ©ãƒ¼ | `info.IsDir()` ã‚¬ãƒ¼ãƒ‰ãŒæ©Ÿèƒ½ã™ã‚‹ã‹ä¸æ˜ |
| conflict ã‚ã‚Šãƒ»ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå†…ã«å­˜åœ¨ã™ã‚‹ã‚±ãƒ¼ã‚¹ | `requestSnapshot` ä¿®æ­£ï¼ˆC1ï¼‰ã‚’æ¤œè¨¼ã§ããªã„ |
| conflict ã‚ã‚Šãƒ»TOCTOU fallthrough | `CreateSession` å§”è­²ã®ç¢ºèªãŒã§ããªã„ |
| sessionName æ­£è¦åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ`"."`, `string(os.PathSeparator)`ï¼‰ | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯åã®ç¢ºèªãŒã§ããªã„ |

---

### ğŸ”´ C3 â€” [QuickSearch.tsx] ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆå¤±æ•—ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¸€åˆ‡é€šçŸ¥ã•ã‚Œãªã„

**é‡è¦åº¦:** ä¿®æ­£å¿…é ˆ / **å½±éŸ¿:** ã‚µã‚¤ãƒ¬ãƒ³ãƒˆå¤±æ•—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ“ä½œæˆå¦ã‚’åˆ¤æ–­ã§ããªã„

```tsx
// QuickSearch.tsx ~L80
} catch (err) {
    console.warn("[DEBUG-QUICKSEARCH] SetActiveSession failed:", err);
    // â† ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®é€šçŸ¥ãªã—ã€‚ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã„ãŸã¾ã¾ä½•ã‚‚èµ·ããªã„
}
```

**Sidebar.tsx ã§ã¯åŒä¸€æ“ä½œã« `addNotification` ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šï¼ˆä¸€è²«æ€§ã®æ¬ å¦‚ï¼‰:**
```tsx
// Sidebar.tsx ~L163
} catch (error) {
    console.error("[sidebar] SetActiveSession failed", ...);
    addNotification(`Failed to activate session "${sessionName}".`, "warn"); // â† é€šçŸ¥ã‚ã‚Š
}
```

**ä¿®æ­£**: `useNotificationStore` ã‚’ `QuickSearch` ã«ã‚‚è¿½åŠ ã—ã€ã‚¨ãƒ©ãƒ¼æ™‚ã« `addNotification` ã‚’å‘¼ã¶ã€‚

---

### ğŸ”´ C4 â€” [QuickSearch.tsx] APIå¾…æ©Ÿä¸­ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒç„¡åå¿œï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºãªã—ï¼‰

**é‡è¦åº¦:** ä¿®æ­£å¿…é ˆ / **å½±éŸ¿:** ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ“ä½œã®å—ç†ã‚’ç¢ºèªã§ããªã„

æ—§å®Ÿè£…ï¼ˆfire-and-forgetï¼‰ã¯å³åº§ã«é–‰ã˜ãŸã€‚ç¾è¡Œå®Ÿè£…ã¯APIå®Œäº†ã¾ã§**ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã„ãŸã¾ã¾ç„¡åå¿œ**ã€‚  
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®é…å»¶æ™‚ã«ã€Œæ“ä½œãŒå—ã‘ä»˜ã‘ã‚‰ã‚Œã¦ã„ãªã„ã€ã¨èª¤èªã•ã›ã‚‹ã€‚

```tsx
// QuickSearch.tsx ~L78
const selectResult = async (sessionName: string) => {
    try {
        await api.SetActiveSession(sessionName);  // â† ã“ã“ã§ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºãªã—ï¼‰
        setActiveSession(sessionName);
        onClose();
    }
};
```

**ä¿®æ­£æ¡ˆ**: `useState` ã§ `isLoading` ã‚’ç®¡ç†ã—ã€ãƒœã‚¿ãƒ³ç„¡åŠ¹åŒ–ã¾ãŸã¯ã‚¹ãƒ”ãƒŠãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã€‚ã‚ã‚‹ã„ã¯æ¥½è¦³çš„æ›´æ–°ï¼ˆå…ˆã«é–‰ã˜ã‚‹ï¼‰+ ã‚¨ãƒ©ãƒ¼æ™‚ã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¤‰æ›´ã™ã‚‹ã€‚

---

### ğŸ”´ C5 â€” [ErrorBoundary.tsx] MAX_RETRIES åˆ°é”å¾Œã«å®Œå…¨å›å¾©ä¸èƒ½ãªçŠ¶æ…‹ã«ãªã‚‹

**é‡è¦åº¦:** ä¿®æ­£å¿…é ˆ / **å½±éŸ¿:** ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã¨ã—ã¦æœ€æ‚ªã®UXï¼ˆè©°ã¿çŠ¶æ…‹ï¼‰

```tsx
// ErrorBoundary.tsx ~L64
<button className="error-boundary-retry" onClick={this.handleReset}
    disabled={reachedRetryLimit}>
    å†è©¦è¡Œ
</button>
```

`retryCount >= 3` å¾Œã«ã‚¨ãƒ©ãƒ¼ãŒå†ç™ºã™ã‚‹ã¨ã€ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ç”»é¢ã‹ã‚‰ä¸€åˆ‡è„±å‡ºã§ããªã„ã€‚  
ãªãœæŠ¼ã›ãªã„ã‹ã®èª¬æ˜ã‚‚ã€ä»£æ›¿æ‰‹æ®µï¼ˆã‚¢ãƒ—ãƒªå†èµ·å‹•æŒ‡ç¤ºç­‰ï¼‰ã‚‚å­˜åœ¨ã—ãªã„ã€‚

**ä¿®æ­£æ¡ˆ:**
```tsx
{reachedRetryLimit ? (
    <p className="error-boundary-limit-msg">
        å†è©¦è¡Œã®ä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚
    </p>
) : (
    <button className="error-boundary-retry" onClick={this.handleReset}>
        å†è©¦è¡Œ
    </button>
)}
```

---

## Important Issuesï¼ˆå¯¾å¿œæ¨å¥¨ï¼‰

### ğŸŸ¡ I1 â€” [app_input_history.go] `timerGen` uint64 ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚ã® gen=0 ã‚»ãƒ³ãƒãƒãƒ«è¡çª

**å½±éŸ¿:** ç†è«–çš„ãƒã‚°ï¼ˆ2^64å›å…¥åŠ›ã§ç™ºç”Ÿï¼‰ã ãŒè¨­è¨ˆä¸Šã®æ¬ é™¥

```go
lb.timerGen++      // overflow: 2^64-1 â†’ 0
gen := lb.timerGen // gen = 0 â† ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚»ãƒ³ãƒãƒãƒ«ã¨è¡çª
```

`flushLineBuffer` ã¯ `gen==0` ã‚’ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚»ãƒ³ãƒãƒãƒ«ã¨ã—ã¦ç‰¹åˆ¥æ‰±ã„ã™ã‚‹ãŸã‚ã€é€šå¸¸ã®ã‚¿ã‚¤ãƒãƒ¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒèª¤ã£ã¦ã‚»ãƒ³ãƒãƒãƒ«çµŒè·¯ã§å®Ÿè¡Œã•ã‚Œã‚‹ã€‚

**ä¿®æ­£æ¡ˆ:**
```go
lb.timerGen++
if lb.timerGen == 0 {
    lb.timerGen = 1 // skip sentinel value
}
```

---

### ğŸŸ¡ I2 â€” [app_session_api.go] `string(os.PathSeparator)` ãŒWindowsã®ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ«ãƒ¼ãƒˆã‚’ã‚¬ãƒ¼ãƒ‰ã§ããªã„

**å½±éŸ¿:** `C:\` ã‚’ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä½¿ã†ã¨ `"C:"` ãŒã‚»ãƒƒã‚·ãƒ§ãƒ³åã«ãªã‚‹ï¼ˆtmuxæ§‹æ–‡ã§`:` ã¯åŒºåˆ‡ã‚Šæ–‡å­—ï¼‰

```go
// app_session_api.go ~L88-L91
if sessionName == "" || sessionName == "." || sessionName == string(os.PathSeparator) {
    sessionName = "quick-session"
}
// Windows: filepath.Base("C:\") = "C:" â†’ ã‚¬ãƒ¼ãƒ‰ã‚’ã™ã‚ŠæŠœã‘ã‚‹
```

| `dir` | `filepath.Base(dir)` | ã‚¬ãƒ¼ãƒ‰åˆ¤å®š |
|---|---|---|
| `C:\Users\foo` | `"foo"` | âœ… é€šé |
| `C:\` | `"C:"` | âŒ ã‚¬ãƒ¼ãƒ‰ã‚’ã™ã‚ŠæŠœã‘ã‚‹ |

**ä¿®æ­£æ¡ˆ:**
```go
vol := filepath.VolumeName(sessionName)
if sessionName == "" || sessionName == "." || sessionName == string(os.PathSeparator) ||
    (vol != "" && sessionName == vol) {
    sessionName = "quick-session"
}
```

---

### ğŸŸ¡ I3 â€” [internal/config/config.go] `validateDefaultSessionDir` ã« `filepath.Clean` ã«ã‚ˆã‚‹æ­£è¦åŒ–ãŒæ¬ å¦‚

**å½±éŸ¿:** `C:\Users\..\Windows` ã®ã‚ˆã†ãªéæ­£è¦åŒ–ãƒ‘ã‚¹ãŒãã®ã¾ã¾ä¿å­˜ã•ã‚Œã‚‹

`filepath.IsAbs` ã¯ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç„¡è¦–ã™ã‚‹ã€‚  
åŒãƒ•ã‚¡ã‚¤ãƒ«ã® `validateConfigPath` ã¯ `filepath.Abs()`ï¼ˆå†…éƒ¨ã§ `filepath.Clean` ã‚’å‘¼ã¶ï¼‰ã‚’ä½¿ã£ã¦ãŠã‚Šéå¯¾ç§°ã€‚

```go
// ä¿®æ­£: validateDefaultSessionDir ã«è¿½åŠ 
cfg.DefaultSessionDir = filepath.Clean(dir)
```

ç·©å’Œè¦å› : `QuickStartSession` å´ã§ `filepath.EvalSymlinks` ãŒå‘¼ã°ã‚Œã‚‹ãŸã‚å®Ÿå®³ã¯é™å®šçš„ã ãŒã€configå±¤ã§ã®æ­£è¦åŒ–ãŒå®Œçµã—ã¦ã„ãªã„ã®ã¯è¨­è¨ˆä¸Šã®ä¸æ•´åˆã€‚

---

### ğŸŸ¡ I4 â€” [internal/config/config_test.go] `TestLoadDefaultSessionDir` ãŒ `filepath.ToSlash` ã§ä»–ãƒ†ã‚¹ãƒˆã¨ä¸æ•´åˆ

**å½±éŸ¿:** Windowsä¸Šã§ã‚¹ãƒ©ãƒƒã‚·ãƒ¥åŒºåˆ‡ã‚Šã¨ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥åŒºåˆ‡ã‚ŠãŒæ··åœ¨

```go
// å•é¡Œ: ToSlash ã§ "/" ã«å¤‰æ›ã—ãŸãƒ‘ã‚¹ã‚’æ¯”è¼ƒ
defaultSessionDir := filepath.ToSlash(filepath.Clean(...))

// ä»–ãƒ†ã‚¹ãƒˆã¯å…¨ã¦ filepath.Clean ã®ã¿ä½¿ç”¨ï¼ˆãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼‰
```

**ä¿®æ­£:**
```go
defaultSessionDir := filepath.Clean(filepath.Join(t.TempDir(), "project"))
```

---

### ğŸŸ¡ I5 â€” [app_input_history_test.go] DCSå†…BELãŒçµ‚ç«¯ã«ãªã‚‰ãªã„ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆæ¬ è½

**å½±éŸ¿:** `skipEscString` ã® `allowBEL=false` ã®åŠ¹æœãŒæœªæ¤œè¨¼

```go
// æ¬ è½ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
{name: "BEL inside DCS body is not a terminator",
 input: "\x1bPdata\x07more\x1b\\tail",
 want: "tail"},
{name: "BEL inside SOS body is not a terminator",
 input: "\x1bXdata\x07more\x1b\\tail",
 want: "tail"},
```

---

### ğŸŸ¡ I6 â€” [app_session_api.go] `findSessionByRootPath` + `requireSessions()` ã«ã‚ˆã‚‹äºŒé‡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå–å¾—

**å½±éŸ¿:** ä¸è¦ãªTOCTOUã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®æ‹¡å¤§

`findSessionByRootPath` ã®å†…éƒ¨ã§ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ä¸€åº¦å–å¾—ã—ã¦ã„ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ãã®å¾Œ `requireSessions()` â†’ `sessions.Snapshot()` ã§å†åº¦å–å¾—ã—ã¦ã„ã‚‹ã€‚2å›ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆé–“ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ãŒå¤‰åŒ–ã™ã‚‹çª“ãŒæ„å›³ã‚ˆã‚Šåºƒããªã‚‹ã€‚

**æ”¹å–„æ¡ˆ:** `requireSessions()` + `sessions.Snapshot()` ã‚’1å›ã®ã¿å®Ÿè¡Œã—ã€åå‰æ¤œç´¢ã¨æ´»æ€§åŒ–ã‚’åŒä¸€ãƒ«ãƒ¼ãƒ—ã§å®Œçµã•ã›ã‚‹ã€‚

---

### ğŸŸ¡ I7 â€” [settingsValidation.ts] globalHotkeyç«¶åˆå¾Œã«`continue`ãŒãªããƒ“ãƒ¥ãƒ¼é–“é‡è¤‡ãƒã‚§ãƒƒã‚¯ã«æ··å…¥

**å½±éŸ¿:** ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç«¶åˆã‚¨ãƒ©ãƒ¼å¾Œã‚‚ç„¡é–¢ä¿‚ãªå‡¦ç†ãŒç¶™ç¶š

```ts
if (normalizedGlobalHotkey !== "" && normalized === normalizedGlobalHotkey) {
    setShortcutError(viewId, "ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã¨é‡è¤‡ã—ã¦ã„ã¾ã™");
    // continue ãŒãªã„ãŸã‚ continue ãŒãªã„ãŸã‚ ownersByShortcut ã«è¿½åŠ ãŒç¶šã
}
```

`setShortcutError` ã® first-write-wins ã«ã‚ˆã‚Šè¡¨ç¤ºä¸Šã¯æ­£ã—ã„ãŒã€æ„å›³ãŒä¸æ˜ç­ã§å°†æ¥ã®ãƒã‚°æºã«ãªã‚Šã†ã‚‹ã€‚`continue` ã‚’è¿½åŠ ã—ã¦æ˜ç¤ºåŒ–ã™ã‚‹ã€‚

---

### ğŸŸ¡ I8 â€” [SettingsModal.tsx] Quake Mode ç„¡åŠ¹æ™‚ã‚‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç«¶åˆãƒã‚§ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹

**å½±éŸ¿:** quakeMode OFFæ™‚ã«èª¤ã£ãŸç«¶åˆã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹

```tsx
// ç¾åœ¨: quakeModeã«é–¢ã‚ã‚‰ãšglobalHotkeyã‚’æ¸¡ã™
...validateViewerShortcuts(s.viewerShortcuts, s.globalHotkey),
```

```tsx
// ä¿®æ­£: quakeModeç„¡åŠ¹æ™‚ã¯ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã‚’æ¸¡ã•ãªã„
...validateViewerShortcuts(s.viewerShortcuts, s.quakeMode ? s.globalHotkey : ""),
```

---

### ğŸŸ¡ I9 â€” [validateViewerShortcuts] globalHotkeyæ­£è¦åŒ–ã®çµ±åˆãƒ†ã‚¹ãƒˆä¸è¶³

**å½±éŸ¿:** å¤§æ–‡å­—å°æ–‡å­—ãƒ»é †åºé•ã„ã®ç«¶åˆã‚’æ¤œçŸ¥ã§ããªã„

```ts
// æ¬ è½ãƒ†ã‚¹ãƒˆ: "shift+ctrl+f12" ã¨ "ctrl+shift+f12" ãŒç«¶åˆã™ã‚‹ã“ã¨ã‚’ç¢ºèª
it("normalizes global hotkey before conflict check", () => {
    const errors = validateViewerShortcuts(
        { "diff": "Shift+Ctrl+F12" },
        "ctrl+shift+f12",
    );
    expect(errors).toHaveProperty("viewer_shortcut_diff");
});
```

---

### ğŸŸ¡ I10 â€” [viewerShortcutUtils.ts] `hasShortcutModifier` ã«åˆ°é”ä¸èƒ½ã‚³ãƒ¼ãƒ‰ï¼ˆdead codeï¼‰ãŒã‚ã‚‹

**å½±éŸ¿:** æ„å›³ãŒä¸æ˜ç¢ºãªã‚³ãƒ¼ãƒ‰ãŒæ®‹å­˜

```ts
// tokens.length === 1 ã‚’ä¸Šã®ifã§å‡¦ç†æ¸ˆã¿ã®ãŸã‚ã€ã“ã®è¡Œã¯åˆ°é”ä¸èƒ½
if (tokens.length < 2) { return false; }

// tokens.length >= 2 ãªã‚‰ modifierTokens.length ã¯å¿…ãš > 0
return modifierTokens.length > 0; // å¸¸ã« return true ã¨ç­‰ä¾¡
```

**ä¿®æ­£æ¡ˆï¼ˆå˜ç´”åŒ–ï¼‰:**
```ts
export function hasShortcutModifier(shortcut: string): boolean {
    const normalized = normalizeShortcut(shortcut);
    if (normalized === "") return false;
    const tokens = normalized.split("+");
    if (tokens.length === 1) {
        return isFunctionKeyToken(tokens[0] ?? "");
    }
    return true; // tokens.length >= 2 = ä¿®é£¾å­ + ã‚­ãƒ¼ã®æ§‹æˆ
}
```

---

### ğŸŸ¡ I11 â€” [errorLogStore.ts] ã‚³ãƒ¡ãƒ³ãƒˆãŒå®Ÿéš›ã®å‹•ä½œã¨ä¸ä¸€è‡´

**å½±éŸ¿:** ä¿å®ˆè€…ãŒã‚³ãƒ¼ãƒ‰ã®å‹•ä½œã‚’èª¤è§£ã™ã‚‹

```ts
// errorLogStore.ts: ã‚³ãƒ¡ãƒ³ãƒˆãŒä¿®æ­£ã•ã‚Œã¦ã„ãªã„
// Backend restart resets seq to 1. If the latest seq regresses, clear read marker.
//                                                                  ^^^^^ èª¤ã‚Š: clearã§ã¯ãªãalign
if (maxNewSeq > 0 && maxNewSeq < lastReadSeq) {
    lastReadSeq = maxNewSeq;  // â† clearã§ã¯ãªãmaxNewSeqã«æƒãˆã¦ã„ã‚‹
}
```

`inputHistoryStore.ts` ã§ã¯ã€Œalign the markerã€ã¨æ­£ã—ãä¿®æ­£æ¸ˆã¿ã€‚`errorLogStore.ts` ã®ä¿®æ­£ãŒæ¼ã‚Œã¦ã„ã‚‹ã€‚

---

### ğŸŸ¡ I12 â€” [SessionView.tsx] `String(err)` ãŒ `ErrorBoundary` ã® `toErrorMessage` ã¨é‡è¤‡å®Ÿè£…

**å½±éŸ¿:** "Error: æ¥ç¶šå¤±æ•—" ã®ã‚ˆã†ã«ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒéœ²å‡º

```tsx
// SessionView.tsx ~L91
setQuickStartError(String(err));  // "Error: message" ãŒè¡¨ç¤ºã•ã‚Œã‚‹

// ErrorBoundary.tsx ã«ã¯ toErrorMessage ãŒã™ã§ã«å­˜åœ¨
function toErrorMessage(error: unknown): string {
    return error instanceof Error ? error.message : String(error ?? "Unknown error");
}
```

`toErrorMessage` ã‚’å…±é€šåŒ–ï¼ˆ`src/utils/` ç­‰ï¼‰ã—ã¦ä¸¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å†åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã€‚

---

### ğŸŸ¡ I13 â€” [base.css] `.session-quick-start-btn` ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒæœªå®šç¾©

**å½±éŸ¿:** ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚©ãƒ¼ã‚«ã‚¹ä½ç½®ã‚’è¦–è¦šçš„ã«ç¢ºèªã§ããªã„ï¼ˆWCAG 2.1 AAé•åï¼‰

```css
/* è¿½åŠ ãŒå¿…è¦ */
.session-quick-start-btn:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
}
```

---

### ğŸŸ¡ I14 â€” [app.go] `launchDir` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®read-onlyä¿è¨¼ãŒã‚³ãƒ¡ãƒ³ãƒˆã§æœªæ˜ç¤º

**å½±éŸ¿:** å°†æ¥ã®é–‹ç™ºè€…ãŒ concurrent write ã‚’è¿½åŠ ã™ã‚‹ãƒªã‚¹ã‚¯

ä»–ã®ä¿è­·ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆ`cfg` â†’ `cfgMu`, `activeSess` â†’ `activeSessMu`ï¼‰ã¨ç•°ãªã‚Šã€`launchDir` ã«ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒƒã‚¯ã‚¹ãŒãªã„ã€‚  
`startup()` ã§1å›ã ã‘æ›¸ãè¾¼ã¾ã‚Œãã®å¾Œèª­ã¿å–ã‚Šå°‚ç”¨ã¨ã„ã†è¨­è¨ˆä¿è¨¼ãŒã‚³ãƒ¼ãƒ‰ã‹ã‚‰èª­ã¿å–ã‚Œãªã„ã€‚

```go
// æ¨å¥¨ã‚³ãƒ¡ãƒ³ãƒˆä¿®æ­£
launchDir string // working directory at startup; set once in startup(), read-only thereafter
```

---

### ğŸŸ¡ I15 â€” [ActivityStrip.tsx] `ActivityButton` ã« `React.memo` ãŒãªãä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒç™ºç”Ÿ

**å½±éŸ¿:** ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆæ¯ã«å…¨ãƒœã‚¿ãƒ³ãŒå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

```tsx
// ActivityStrip ã¯ activeViewId ã‚’è³¼èª­ã—ã¦ã„ã‚‹ãŸã‚ã€ãƒšã‚¤ãƒ³åˆ‡ã‚Šæ›¿ãˆæ¯ã«å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
// ActivityButton ã« memo ãŒãªã„ãŸã‚ã€å¤‰åŒ–ã®ãªã„ãƒœã‚¿ãƒ³ã‚‚å…¨ã¦å†æç”»ã•ã‚Œã‚‹
const ActivityButton = React.memo(function ActivityButton(...) { ... }); // æ¨å¥¨
```

---

## Suggestionsï¼ˆæ”¹å–„ææ¡ˆï¼‰

### ğŸŸ¢ S1 â€” [app_session_log.go] UTF-8åˆ‡ã‚Šè©°ã‚ã®ã‚·ãƒ³ã‚°ãƒ«ãƒ‘ã‚¹æœ€é©åŒ–

```go
// ç¾åœ¨: 2ãƒ‘ã‚¹ï¼ˆRuneCountInString + []rune ã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
if utf8.RuneCountInString(msg) > frontendLogMaxMsgLen {
    msg = string([]rune(msg)[:frontendLogMaxMsgLen])
}

// æ¨å¥¨: 1ãƒ‘ã‚¹ã€ã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¦
runes := 0
for i := range msg {
    if runes == frontendLogMaxMsgLen {
        msg = msg[:i]
        break
    }
    runes++
}
```

`LogFrontendEvent` ã¯UIæ“ä½œæ¯ã«å‘¼ã°ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ä¾¡å€¤ãŒã‚ã‚‹ã€‚

---

### ğŸŸ¢ S2 â€” [app_input_history.go] `lb.buf = lb.buf[:0]` ã®ãƒ¡ãƒ¢ãƒªä¿æŒã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜è¨˜

```go
// æ„å›³ã‚’æ˜ç¤ºã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ ã‚’æ¨å¥¨
// Reset len to 0 to reuse the backing array; cap is intentionally retained for performance.
lb.buf = lb.buf[:0]
```

---

### ğŸŸ¢ S3 â€” [app_session_api.go] TOCTOUãƒ•ã‚©ãƒ¼ãƒ«ã‚¹ãƒ«ãƒ¼æ™‚ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³åã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹å‹•ä½œã‚’ã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜

```go
// NOTE: This check is intentionally best-effort. If the session disappears
// between findSessionByRootPath and the snapshot loop (TOCTOU window), we
// safely fall through to CreateSession, which may append a numeric suffix
// (-2, -3, ...) if a same-named session already exists.
```

---

### ğŸŸ¢ S4 â€” [TestValidateDefaultSessionDir] Windowså›ºæœ‰ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®è¿½åŠ 

```go
// è¿½åŠ æ¨å¥¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
{name: "UNC path accepted", dir: `\\server\share\project`, want: `\\server\share\project`},
{name: "drive root accepted", dir: `C:\`, want: `C:\`},
{name: "Windows drive-relative path rejected", dir: `C:relative`, want: ""},
```

---

### ğŸŸ¢ S5 â€” [TestSaveRoundTripDefaultSessionDir] ç©ºå€¤ã®omitemptyç¢ºèªãƒ†ã‚¹ãƒˆè¿½åŠ 

```go
// DefaultSessionDir="" ãŒ YAML ã«å‡ºåŠ›ã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª
raw, _ := os.ReadFile(path)
if strings.Contains(string(raw), "default_session_dir") {
    t.Error("empty DefaultSessionDir should be omitted from yaml (omitempty)")
}
```

---

### ğŸŸ¢ S6 â€” [settingsValidation.ts] `ABSOLUTE_SESSION_DIR_PATTERN` ã¨ `ABSOLUTE_OR_DRIVE_PATH_PATTERN` ã®å·®ç•°ã‚’ã‚³ãƒ¡ãƒ³ãƒˆæ˜è¨˜

```ts
// Accepts: "C:\foo", "\\server\share", "/unix/path"
// Rejects: "C:relative" (Windows drive-relative, not absolute)
const ABSOLUTE_SESSION_DIR_PATTERN = /^(?:[A-Za-z]:[\\/]|[\\/]{2}|[\\/])/;

// Used for worktree copy path safety check (broader: rejects "C:foo" and "C:" but also plain "C:")
const ABSOLUTE_OR_DRIVE_PATH_PATTERN = /^(?:[A-Za-z]:|[\\/]{2}|[\\/])/;
```

---

### ğŸŸ¢ S7 â€” [GeneralSettings.tsx] Clearãƒœã‚¿ãƒ³ã« `aria-label` è¿½åŠ 

```tsx
<button ... title="ã‚¯ãƒªã‚¢" aria-label="ã‚¯ãƒªã‚¢">
    &times;
</button>
```

---

### ğŸŸ¢ S8 â€” [InputHistoryView.tsx] `useLayoutEffect` ä½¿ç”¨ç†ç”±ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ˜è¨˜

```tsx
// useLayoutEffect: ãƒšã‚¤ãƒ³ãƒˆå‰ã«åŒæœŸå®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒ“ãƒ¥ãƒ¼ã‚’é–‹ã„ãŸç¬é–“ã«
// ãƒãƒƒã‚¸ãŒä¸€ç¬ç‚¹ç¯ã™ã‚‹ã€Œã¡ã‚‰ã¤ãã€ã‚’é˜²ãã€‚useEffect ã§ã¯æç”»å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ä¸é©ã€‚
useLayoutEffect(() => {
    markAllRead();
}, [latestEntrySeq, markAllRead]);
```

---

### ğŸŸ¢ S9 â€” [SettingsModal.tsx] ã‚¨ãƒ©ãƒ¼ã‚«ãƒ†ã‚´ãƒªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å„ªå…ˆåº¦ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ–‡æ›¸åŒ–

```tsx
// Navigation priority order (descending):
// agent/override â†’ claude_env â†’ pane_env â†’ wt_copy â†’ general (session dir) â†’ keybinds
```

---

### ğŸŸ¢ S10 â€” [base.css] `.session-quick-start-btn` ã®ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³æŒ‡å®šã‚’çµ±ä¸€

```css
/* ç¾åœ¨: background-colorï¼ˆä»–ãƒœã‚¿ãƒ³ã¯backgroundã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ï¼‰ */
transition: background-color 0.15s;
/* ä¿®æ­£: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¨™æº–ã«åˆã‚ã›ã‚‹ */
transition: background 0.15s;
```

---

## Positive Observationsï¼ˆè‰¯ã„ç‚¹ï¼‰

### Goå´

- **`cleanupOldSessionLogs` ã‚½ãƒ¼ãƒˆãƒã‚°ä¿®æ­£**: `return leftOK` â†’ `return !leftOK` ã®å¤‰æ›´ã«ã‚ˆã‚Šã€malformedãƒ•ã‚¡ã‚¤ãƒ«ãŒcanonicalãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šå…ˆã«å‰Šé™¤ã•ã‚Œã‚‹ã¨ã„ã†æ­£ç¢ºãªå‹•ä½œãŒå®Ÿç¾ã—ãŸã€‚`TestCleanupOldSessionLogs_DeletesMalformedBeforeCanonical` ã¨å®Œå…¨ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚
- **`strings.Builder` â†’ `[]rune` ã¸ã®å¤‰æ›´**: ãƒãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¹å‡¦ç†ãŒ O(N) ã‹ã‚‰ O(1) ã«æ”¹å–„ã€`runes int` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚‚å‰Šé™¤ã—ã¦structãŒã‚·ãƒ³ãƒ—ãƒ«ã«ãªã£ãŸã€‚
- **3å±¤ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚¬ãƒ¼ãƒ‰**: `recordInput`ã§ã®æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ + `flushLineBuffer`ã®ã‚¿ã‚¤ãƒãƒ¼æŠ‘åˆ¶ + `gen=0`ã‚»ãƒ³ãƒãƒãƒ«ã«ã‚ˆã‚‹æ˜ç¤ºçš„ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ç¶­æŒã®çµ„ã¿åˆã‚ã›ãŒå …å›ºã€‚
- **`skipEscString` ã«ã‚ˆã‚‹DCS/SOS/PM/APCã®DRYåŒ–**: `allowBEL`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§2ç¨®ã®çµ‚ç«¯æ–¹å¼ã‚’çµ±ä¸€çš„ã«å‡¦ç†ã€‚
- **`testutil.Ptr` ã¸ã®çµ±ä¸€**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§`boolPtrTest`ãƒ­ãƒ¼ã‚«ãƒ«é–¢æ•°ã‚’å»ƒæ­¢ã—ã€ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãŒä¸€ç®‡æ‰€ã«é›†ç´„ã•ã‚ŒãŸã€‚
- **ãƒ†ã‚¹ãƒˆã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹é™¤å»**: `C:\Users\tester\...` â†’ `t.TempDir()` åŒ–ã«ã‚ˆã‚Šã€ãƒ†ã‚¹ãƒˆã®ç‹¬ç«‹æ€§ãƒ»ç§»æ¤æ€§ãŒå‘ä¸Šã€‚
- **`utf8.RuneCountInString` æœ€é©åŒ–**: çŸ­ã„æ–‡å­—åˆ—ï¼ˆå¤§å¤šæ•°ã®ã‚±ãƒ¼ã‚¹ï¼‰ã§ã®ã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¼ãƒ­ã‚’å®Ÿç¾ã€‚

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´

- **`useSyncExternalStore` ã«ã‚ˆã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é§†å‹•ãƒãƒƒã‚¸**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«ã®å®šæ•°ï¼ˆ`EMPTY_SUBSCRIBE/ZERO_BADGE`ï¼‰ã«ã‚ˆã‚‹å®‰å®šã—ãŸå‚ç…§ã€å·®åˆ†ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ä»˜ã`subscribeBadgeCount`ã«ã‚ˆã‚Šã€ä¸è¦ãªå†è³¼èª­ãƒ»å†è¨ˆç®—ã‚’é˜²ãå®Ÿè£…ã€‚
- **`setActiveSession` ã®å‘¼ã³å‡ºã—é †åºä¿®æ­£ï¼ˆQuickSearchãƒ»Sidebarå…±é€šï¼‰**: APIæˆåŠŸå¾Œã«ã®ã¿Storeã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã§æ¥½è¦³çš„æ›´æ–°ã®ä¸æ•´åˆã‚’æ ¹æœ¬è§£æ±ºã€‚
- **`viewerRegistry` DEVãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒãƒƒã‚¸ãƒšã‚¢ã®ç‰‡æ–¹ã®ã¿å®Ÿè£…ã‚’é–‹ç™ºæ™‚ã«ä¸¡æ–¹å‘ã§æ—©æœŸæ¤œå‡ºã€‚
- **`DEL(0x7f)` ã® `^?` å¤‰æ›**: UNIXç«¯æœ«æ…£ç¿’ã®`stty erase = ^?`ã«æ²¿ã£ãŸæ­£ç¢ºãªå®Ÿè£…ã€‚
- **`ErrorBoundary` ã® `getDerivedStateFromError` â†’ `Partial<>` å‹å¤‰æ›´**: `retryCount` ã‚’ä¿æŒã—ãŸã¾ã¾error stateã®ã¿ä¸Šæ›¸ãã§ãã‚‹ã“ã¨ã‚’å‹ãƒ¬ãƒ™ãƒ«ã§è¡¨ç¾ã€‚
- **`ABSOLUTE_SESSION_DIR_PATTERN` ã«ã‚ˆã‚‹ `C:relative` ã®æ­£ç¢ºãªæ‹’å¦**: `C:` ã®ã¿ã§ã¯é€šéã•ã›ãšã€ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ã‚’å¿…é ˆã¨ã™ã‚‹æ­£ç¢ºãªæ­£è¦è¡¨ç¾ã€‚
- **CSS ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ä¸€è²«ã—ãŸä½¿ç”¨**: è¿½åŠ ã‚¯ãƒ©ã‚¹å…¨ä½“ã§`--accent`, `--danger`, `--fg-dim`ç­‰ã®è¨­è¨ˆãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã—ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ ã¨æ•´åˆã€‚

---

## ä½œæ¥­ã‚¿ã‚¹ã‚¯ä¸€è¦§ã¨ä¸¦åˆ—ä½œæ¥­å¯å¦è¡¨

ä»¥ä¸‹ã®ä¿®æ­£ã‚¿ã‚¹ã‚¯ã‚’æ•´ç†ã™ã‚‹ã€‚**â—: ç‹¬ç«‹ã—ã¦ä¸¦åˆ—ä½œæ¥­å¯èƒ½ / â–³: ä»–ã‚¿ã‚¹ã‚¯ã®å®Œäº†å¾Œã«ä½œæ¥­é–‹å§‹ / âœ•: å˜ç‹¬ã§å®Ÿæ–½å¿…é ˆ**

| # | å„ªå…ˆåº¦ | ãƒ•ã‚¡ã‚¤ãƒ« | ã‚¿ã‚¹ã‚¯å†…å®¹ | ä¸¦åˆ— | å‚™è€ƒ |
|---|---|---|---|---|---|
| T01 | ğŸ”´ Critical | `myT-x/app_session_api.go` | C1: `requestSnapshot(true)` ã‚’ conflict ãƒ‘ã‚¹ã«è¿½åŠ  | â— | 1è¡Œè¿½åŠ  |
| T02 | ğŸ”´ Critical | `myT-x/app_session_api_test.go` | C2: `QuickStartSession` ã®ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆè¿½åŠ  | â–³ | T01å®Œäº†å¾Œã«æ›¸ã |
| T03 | ğŸ”´ Critical | `myT-x/frontend/src/components/QuickSearch.tsx` | C3: ã‚¨ãƒ©ãƒ¼æ™‚ã« `addNotification` ã‚’å‘¼ã¶ | â— | Sidebar ã¨åŒã˜å®Ÿè£… |
| T04 | ğŸ”´ Critical | `myT-x/frontend/src/components/QuickSearch.tsx` | C4: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° state è¿½åŠ ã¾ãŸã¯Optimisticæ›´æ–°ã«å¤‰æ›´ | â–³ | T03ã¨åŒãƒ•ã‚¡ã‚¤ãƒ«ãªã®ã§T03å¾Œ |
| T05 | ğŸ”´ Critical | `myT-x/frontend/src/components/ErrorBoundary.tsx` | C5: MAX_RETRIESåˆ°é”å¾Œã®ä»£æ›¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤º | â— | â€” |
| T06 | ğŸŸ¡ Important | `myT-x/app_input_history.go` | I1: `timerGen++` ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚ã®sentinelå›é¿ | â— | 2ã€œ3è¡Œè¿½åŠ  |
| T07 | ğŸŸ¡ Important | `myT-x/app_session_api.go` | I2: Windows ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ«ãƒ¼ãƒˆã®ã‚»ãƒƒã‚·ãƒ§ãƒ³åã‚¬ãƒ¼ãƒ‰ä¿®æ­£ | â— | T01ã¨åŒãƒ•ã‚¡ã‚¤ãƒ«ã ãŒç‹¬ç«‹ |
| T08 | ğŸŸ¡ Important | `myT-x/internal/config/config.go` | I3: `filepath.Clean` ã«ã‚ˆã‚‹æ­£è¦åŒ–è¿½åŠ  | â— | â€” |
| T09 | ğŸŸ¡ Important | `myT-x/internal/config/config_test.go` | I4: `filepath.ToSlash` ã‚’é™¤å»ã—ã¦æ•´åˆæ€§çµ±ä¸€ | â— | â€” |
| T10 | ğŸŸ¡ Important | `myT-x/app_input_history_test.go` | I5: BEL non-terminator ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ  | â— | â€” |
| T11 | ğŸŸ¡ Important | `myT-x/app_session_api.go` | I6: äºŒé‡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå–å¾—ã‚’1å›ã«çµ±åˆ | â–³ | T01, T07å®Œäº†å¾Œã«æ•´ç† |
| T12 | ğŸŸ¡ Important | `myT-x/frontend/src/components/settings/settingsValidation.ts` | I7: globalHotkeyç«¶åˆå¾Œã« `continue` è¿½åŠ  | â— | â€” |
| T13 | ğŸŸ¡ Important | `myT-x/frontend/src/components/SettingsModal.tsx` | I8: `quakeMode` çŠ¶æ…‹ã§globalHotkeyç«¶åˆãƒã‚§ãƒƒã‚¯ã‚’åˆ¶å¾¡ | â— | â€” |
| T14 | ğŸŸ¡ Important | `myT-x/frontend/tests/settingsValidation.test.ts` | I9: normalizeShortcut + globalHotkeyç«¶åˆãƒ†ã‚¹ãƒˆè¿½åŠ  | â— | â€” |
| T15 | ğŸŸ¡ Important | `myT-x/frontend/src/components/viewer/viewerShortcutUtils.ts` | I10: `hasShortcutModifier` dead code ã®å˜ç´”åŒ– | â— | â€” |
| T16 | ğŸŸ¡ Important | `myT-x/frontend/src/stores/errorLogStore.ts` | I11: ã‚³ãƒ¡ãƒ³ãƒˆã‚’ `inputHistoryStore` ã¨çµ±ä¸€ | â— | 1è¡Œã‚³ãƒ¡ãƒ³ãƒˆå¤‰æ›´ |
| T17 | ğŸŸ¡ Important | `myT-x/frontend/src/components/SessionView.tsx` | I12: `String(err)` ã‚’å…±é€š `toErrorMessage` ã§ç½®ãæ›ãˆ | â— | utilsåŒ–ã‚’ä¼´ã† |
| T18 | ğŸŸ¡ Important | `myT-x/frontend/src/styles/base.css` | I13: `.session-quick-start-btn:focus-visible` è¿½åŠ  | â— | â€” |
| T19 | ğŸŸ¡ Important | `myT-x/app.go` | I14: `launchDir` ã« read-only ã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ | â— | 1è¡Œ |
| T20 | ğŸŸ¡ Important | `myT-x/frontend/src/components/viewer/ActivityStrip.tsx` | I15: `ActivityButton` ã‚’ `React.memo` ã§ãƒ©ãƒƒãƒ— | â— | â€” |
| T21 | ğŸŸ¢ Suggestion | `myT-x/app_session_log.go` | S1: UTF-8åˆ‡ã‚Šè©°ã‚ã®ã‚·ãƒ³ã‚°ãƒ«ãƒ‘ã‚¹æœ€é©åŒ– | â— | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ |
| T22 | ğŸŸ¢ Suggestion | `myT-x/app_input_history.go` | S2: `buf[:0]` ã«ãƒ¡ãƒ¢ãƒªä¿æŒã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  | â— | ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ |
| T23 | ğŸŸ¢ Suggestion | `myT-x/app_session_api.go` | S3: TOCTOUãƒ•ã‚©ãƒ¼ãƒ«ã‚¹ãƒ«ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆè£œå¼· | â— | ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ |
| T24 | ğŸŸ¢ Suggestion | `myT-x/internal/config/config_test.go` | S4: UNCãƒ»ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ«ãƒ¼ãƒˆç­‰ã®Windowsãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ  | â— | â€” |
| T25 | ğŸŸ¢ Suggestion | `myT-x/internal/config/config_test.go` | S5: omitEmptyç¢ºèªãƒ†ã‚¹ãƒˆè¿½åŠ  | â— | â€” |
| T26 | ğŸŸ¢ Suggestion | `myT-x/frontend/src/components/settings/settingsValidation.ts` | S6: 2ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å·®ç•°ã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ | â— | ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ |
| T27 | ğŸŸ¢ Suggestion | `myT-x/frontend/src/components/settings/GeneralSettings.tsx` | S7: Clearãƒœã‚¿ãƒ³ã« `aria-label` è¿½åŠ  | â— | â€” |
| T28 | ğŸŸ¢ Suggestion | `myT-x/frontend/src/components/viewer/views/input-history/InputHistoryView.tsx` | S8: `useLayoutEffect` ä½¿ç”¨ç†ç”±ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  | â— | ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ |
| T29 | ğŸŸ¢ Suggestion | `myT-x/frontend/src/components/SettingsModal.tsx` | S9: ã‚¨ãƒ©ãƒ¼ã‚«ãƒ†ã‚´ãƒªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å„ªå…ˆåº¦ã‚³ãƒ¡ãƒ³ãƒˆ | â— | ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ |
| T30 | ğŸŸ¢ Suggestion | `myT-x/frontend/src/styles/base.css` | S10: `transition: background-color` â†’ `background` ã«çµ±ä¸€ | â–³ | T18ã¨åŒãƒ•ã‚¡ã‚¤ãƒ«ãªã®ã§T18å¾Œ |

---

## ä¸¦åˆ—ä½œæ¥­ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆæ¨å¥¨ä½œæ¥­é †ï¼‰

### ãƒ•ã‚§ãƒ¼ã‚º1: Criticalä¿®æ­£ï¼ˆT01ã€œT05ï¼‰â€” å…¨ã¦ç‹¬ç«‹ã€ä¸¦åˆ—ä½œæ¥­å¯èƒ½

| ã‚°ãƒ«ãƒ¼ãƒ— | ã‚¿ã‚¹ã‚¯ | æ‹…å½“è€…A | æ‹…å½“è€…B |
|---|---|---|---|
| 1-a | T01 (`requestSnapshot`è¿½åŠ ) | â—‹ | â€” |
| 1-b | T03 (QuickSearché€šçŸ¥) | â€” | â—‹ |
| 1-c | T05 (ErrorBoundaryä»£æ›¿ã‚¢ã‚¯ã‚·ãƒ§ãƒ³) | â—‹ | â€” |
| 1-d | T01å®Œäº†å¾Œ: T02 (QuickStartãƒ†ã‚¹ãƒˆ) | â€” | â—‹ |
| 1-e | T03å®Œäº†å¾Œ: T04 (ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¿½åŠ ) | â—‹ | â€” |

### ãƒ•ã‚§ãƒ¼ã‚º2: Importantä¿®æ­£ï¼ˆT06ã€œT20ï¼‰â€” T01,T07å®Œäº†å¾Œã«T11é–‹å§‹

| ã‚°ãƒ«ãƒ¼ãƒ— | ã‚¿ã‚¹ã‚¯ | å†…å®¹ | ä¸¦åˆ—å¯å¦ |
|---|---|---|---|
| 2-a | T06, T08, T09, T10 | Goãƒã‚°ä¿®æ­£ãƒ»ãƒ†ã‚¹ãƒˆ | â— å…¨ã¦ä¸¦åˆ—å¯ |
| 2-b | T12, T13, T14, T15, T16 | TS/Reactä¿®æ­£ | â— å…¨ã¦ä¸¦åˆ—å¯ |
| 2-c | T17, T18, T19, T20 | UI/CSSãƒ»ã‚³ãƒ¡ãƒ³ãƒˆ | â— å…¨ã¦ä¸¦åˆ—å¯ |
| 2-d | T11 | äºŒé‡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ•´åˆ | â–³ T01ãƒ»T07å®Œäº†å¾Œ |

### ãƒ•ã‚§ãƒ¼ã‚º3: Suggestionï¼ˆT21ã€œT30ï¼‰â€” å…¨ã¦ç‹¬ç«‹ã€ä»»æ„ã«ä¸¦åˆ—ä½œæ¥­å¯èƒ½

T18å®Œäº†å¾Œã«T30ã‚’å®Ÿæ–½ã™ã‚‹ç‚¹ã®ã¿æ³¨æ„ã€‚ãã‚Œä»¥å¤–ã¯å…¨ã¦ç‹¬ç«‹ã—ã¦ä¸¦åˆ—ä½œæ¥­å¯èƒ½ã€‚

---

## çµ±è¨ˆã‚µãƒãƒªãƒ¼

| åˆ†é¡ | ä»¶æ•° |
|---|---|
| ğŸ”´ Critical Issues | 5ä»¶ |
| ğŸŸ¡ Important Issues | 15ä»¶ |
| ğŸŸ¢ Suggestions | 10ä»¶ |
| âœ… Positive Observations | 14ä»¶ |
| **åˆè¨ˆæŒ‡æ‘˜ãƒ»ææ¡ˆ** | **30ä»¶** |

---

*ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½æ—¥: 2026-02-24 / å¯¾è±¡ã‚³ãƒŸãƒƒãƒˆ: HEADå‰ã®æœªã‚³ãƒŸãƒƒãƒˆå¤‰æ›´*
